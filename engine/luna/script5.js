function getLanguage(e){let n=navigator.language.toLowerCase();switch(n){case"zh-hk":case"zh-tw":return e.ChineseTraditional;case"zh-sg":case"zh-cn":return e.ChineseSimplified}switch(n=n.split("-")[0],n){case"af":return e.Afrikaans;case"ar":return e.Arabic;case"eu":return e.Basque;case"be":return e.Belarusian;case"bg":return e.Bulgarian;case"ca":return e.Catalan;case"zh":return e.Chinese;case"cs":return e.Czech;case"da":return e.Danish;case"nl":return e.Dutch;case"en":return e.English;case"et":return e.Estonian;case"fo":return e.Faroese;case"fi":return e.Finnish;case"fr":return e.French;case"de":return e.German;case"el":return e.Greek;case"he":return e.Hebrew;case"is":return e.Icelandic;case"id":return e.Indonesian;case"it":return e.Italian;case"ja":return e.Japanese;case"ko":return e.Korean;case"lv":return e.Latvian;case"lt":return e.Lithuanian;case"no":return e.Norwegian;case"pl":return e.Polish;case"pt":return e.Portuguese;case"ro":return e.Romanian;case"ru":return e.Russian;case"sh":return e.SerboCroatian;case"sk":return e.Slovak;case"sl":return e.Slovenian;case"es":return e.Spanish;case"sv":return e.Swedish;case"th":return e.Thai;case"tr":return e.Turkish;case"uk":return e.Ukrainian;case"vi":return e.Vietnamese;case"zn":return e.ChineseSimplified;case"hu":return e.Hungarian;default:return e.Unknown}}Bridge.assembly("LunaUnity",(e,n)=>{const t=/\+/g;Bridge.define("LunaUnity.Objects.Request",{ctor:function(){this.$initialize(),this.immediateRegistry=null,this.referenceQueue=[],this.pendingQueue=[],this.root=null,LunaUnity.Objects.Request.typeCache=LunaUnity.Objects.Request.typeCache||{}},r:function(e,n,t,i,o){const r={type:null==e?null:"boolean"==typeof e?e:Deserializers.types[e],id:n,targetType:t,targetObject:i,targetProperty:o};this.immediateRegistry?this.resolveInstruction(this.immediateRegistry,r):this.referenceQueue.push(r)},resolveReferences:function(e){for(let n=0;n<this.referenceQueue.length;n++)this.resolveInstruction(e,this.referenceQueue[n]);this.referenceQueue=this.pendingQueue,this.pendingQueue=[]},resolveInstruction:function(e,n){if(null===n.type||null===n.id)return void this.applyObject(n,null);const t=e.TryGet(n.id);if(!t)return void this.pendingQueue.push(n);const i=!0===n.type?null:this._getTypeByName(n.type);let o=t;!i||o.$kind||o.isPrefabProxy||(o=UnityEngine.Object.FromHandle(i,t)),this.applyObject(n,o)},applyObject:function(e,n){0===e.targetType?e.targetObject[e.targetProperty]=n:1===e.targetType?e.targetObject.add(n):e.targetObject.push(n)},d:function(e,n,t){return null==n?null:Deserializers[e](this,n,t)},deserializeTo:function(e,n,t){return Deserializers[t||n.$$fullname](this,e,n)},c:function(e){const n=this._getTypeByName(e);if(!n||!n.$$fullname)return{};if(n.ctor&&0===n.ctor.length)return new n.ctor;{const e=Object.create(n.prototype);return e.$initialize&&e.$initialize(),e}},_getTypeByName:function(e){const n=LunaUnity.Objects.Request.typeCache;if(!n.hasOwnProperty(e)){let i=Bridge.ns(e.replace(t,"."));i.$$fullname||(console.warn("Unknown class found: "+e),i=null),n[e]=i}return n[e]}}),Bridge.define("LunaUnity.Objects.ImmediateRequest",{inherits:[LunaUnity.Objects.Request],ctor:function(e){LunaUnity.Objects.Request.ctor.call(this),this.registry=e},r:function(e,n,t,i,o){if(null===e||null===n)return;const r={type:"boolean"==typeof e?e:Deserializers.types[e],id:n,targetType:t,targetObject:i,targetProperty:o};this.resolveInstruction(this.registry,r)}})}),Bridge._getTypeByName=LunaUnity.Objects.Request.prototype._getTypeByName,Bridge.assembly("LunaUnity",(e,n)=>{Bridge.define("LunaUnity.Objects.Handlers.Base",{ctors:{ctor:function(e){this.$initialize(),this.application=e,this.network=e.network,this.objectSpace=e.objectSpace,this.app=e.app,this.graphicsDevice=this.app.graphicsDevice,this.registry=this.objectSpace.getRegistry()}},methods:{loadAsync:function(){throw new Error("Not implemented")}}})}),Bridge.assembly("LunaUnity",(e,n)=>{const t=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Scene.GameObject"],i=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Components.Transform"],o=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Components.Animator"],r=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Components.Animation"],a=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Components.Canvas"],s=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Components.CanvasGroup"],c=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Components.RectTransform"],l=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Components.Camera"],d=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Components.VideoPlayer"],u=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Components.AudioSource"],y=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Components.Light"],p=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Components.MeshFilter"],g=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Components.MeshRenderer"],h=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Components.SkinnedMeshRenderer"],m=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Components.SpriteRenderer"],f=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Components.Rigidbody"],C=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Components.BoxCollider"],b=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Components.SphereCollider"],_=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Components.MeshCollider"],T=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Components.CapsuleCollider"],U=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Components.Rigidbody2D"],E=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Components.BoxCollider2D"],A=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Components.CircleCollider2D"],D=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Components.CapsuleCollider2D"],R=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Components.EdgeCollider2D"],O=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Components.PolygonCollider2D"],L=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Components.SpringJoint2D"],w=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Components.DistanceJoint2D"],S=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Components.FixedJoint2D"],P=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Components.HingeJoint2D"],B=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Components.WheelJoint2D"],F=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Components.FrictionJoint2D"],M=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Components.RelativeJoint2D"],I=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Components.SliderJoint2D"],x=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Components.TargetJoint2D"],k=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Components.LineRenderer"],v=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Components.TrailRenderer"],z=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Components.PlatformEffector2D"];Bridge.define("LunaUnity.Objects.Handlers.GameObject",{inherits:[LunaUnity.Objects.Handlers.Base],ctor:function(e){this.$initialize(),LunaUnity.Objects.Handlers.Base.ctor.call(this,e)},fork:function(){const e=new LunaUnity.Objects.Handlers.GameObject(this.application);return e.registry=e.registry.Clone().AllowUpdate(),e},loadAsync:function(e,n,t,i){if(!this.app.systems.monoBehaviour.creatingPrefabs||i){const t=this._loadObject(e,e.root,n,this.registry);return t.isPrefab=!0,t.objectJson=n,{result:t}}const o={isPrefabProxy:!0,prefab:n};return this.registry.Put(n.id,o),{result:o}},_loadObject:function(e,n,i,o){if(o.Has(i.id)&&!o.updatesAllowed)return o.Get(i.id);const r=i.data,a=new pc.Entity(r[t.name],this.app,this.app.systems.monoBehaviour.creatingPrefabs);a.enabled=!!r[t.enabled],a.cullingLayer=r[t.layer],a.static=!!r[t.isStatic],a.tag=r[t.tag],a.isPrefab&&(a.objectJson=i);const s=i.children;for(let n=0;n<s.length;n++)this._loadObject(e,a,s[n],this.registry);const c=i.components,l=Deserializers.typeNameToIdMap["UnityEngine.CanvasRenderer"];for(let e=0;e<c.length;e++)c[e].type===l&&e>1&&([c[1],c[e]]=[c[e],c[1]]);for(let n=0;n<c.length;n++)this._loadComponent(e,a,c[n],this.registry);return null!=n&&n.addChild(a),o.Put(i.id,a)},unloadAsync:function(e){for(let n=0;n<e.components.length;n++)this.registry.Release(e.components[n].id);for(let n=0;n<e.children.length;n++)this.unloadAsync(e.children[n])},_loadComponent:function(e,n,t,i){let o=null;switch(Deserializers.types[t.type]){case"UnityEngine.Transform":o=this._loadTransformComponent(e,n,t,i);break;case"UnityEngine.Animator":o=this._loadAnimatorComponent(e,n,t,i);break;case"UnityEngine.Animation":o=this._loadAnimationComponent(e,n,t,i);break;case"UnityEngine.Canvas":o=this._loadCanvasComponent(e,n,t,i);break;case"UnityEngine.CanvasGroup":o=this._loadCanvasGroupComponent(e,n,t,i);break;case"UnityEngine.EventSystems.UIBehaviour":o=this._loadUIBehaviourComponent(e,n,t,i);break;case"UnityEngine.TextMesh":o=this._loadTextMesh(e,n,t,i);break;case"UnityEngine.RectTransform":o=this._loadRectTransformComponent(e,n,t,i);break;case"UnityEngine.Camera":o=this._loadCameraComponent(e,n,t,i);break;case"UnityEngine.Video.VideoPlayer":o=this._loadVideoPlayerComponent(e,n,t,i);break;case"UnityEngine.AudioSource":o=this._loadAudioSourceComponent(e,n,t,i);break;case"UnityEngine.Light":o=this._loadLightComponent(e,n,t,i);break;case"UnityEngine.MeshFilter":o=this._loadMeshFilterComponent(e,n,t,i);break;case"UnityEngine.SkinnedMeshRenderer":o=this._loadSkinnedMeshRendererComponent(e,n,t,i);break;case"UnityEngine.MeshRenderer":o=this._loadMeshRendererComponent(e,n,t,i);break;case"UnityEngine.SpriteRenderer":o=this._loadSpriteRendererComponent(e,n,t,i);break;case"UnityEngine.MonoBehaviour":o=this._loadMonoBehaviourComponent(e,n,t,i);break;case"UnityEngine.Rigidbody":o=this._loadRigidbodyComponent(e,n,t,i);break;case"UnityEngine.BoxCollider":o=this._loadBoxColliderComponent(e,n,t,i);break;case"UnityEngine.SphereCollider":o=this._loadSphereColliderComponent(e,n,t,i);break;case"UnityEngine.MeshCollider":o=this._loadMeshColliderComponent(e,n,t,i);break;case"UnityEngine.CapsuleCollider":o=this._loadCapsuleColliderComponent(e,n,t,i);break;case"UnityEngine.WheelCollider":o=this._loadWheelColliderComponent(e,n,t,i);break;case"UnityEngine.CharacterController":o=this._loadCharacterControllerComponent(e,n,t,i);break;case"UnityEngine.Rigidbody2D":o=this._loadRigidbody2DComponent(e,n,t,i);break;case"UnityEngine.BoxCollider2D":o=this._loadBoxCollider2DComponent(e,n,t,i);break;case"UnityEngine.CircleCollider2D":o=this._loadCircleCollider2DComponent(e,n,t,i);break;case"UnityEngine.CapsuleCollider2D":o=this._loadCapsuleCollider2DComponent(e,n,t,i);break;case"UnityEngine.EdgeCollider2D":o=this._loadEdgeCollider2DComponent(e,n,t,i);break;case"UnityEngine.PolygonCollider2D":o=this._loadPolygonCollider2DComponent(e,n,t,i);break;case"UnityEngine.SpringJoint2D":o=this._loadSpringJoint2DComponent(e,n,t,i);break;case"UnityEngine.DistanceJoint2D":o=this._loadDistanceJoint2DComponent(e,n,t,i);break;case"UnityEngine.FixedJoint2D":o=this._loadFixedJoint2DComponent(e,n,t,i);break;case"UnityEngine.HingeJoint2D":o=this._loadHingeJoint2DComponent(e,n,t,i);break;case"UnityEngine.WheelJoint2D":o=this._loadWheelJoint2DComponent(e,n,t,i);break;case"UnityEngine.FrictionJoint2D":o=this._loadFrictionJoint2DComponent(e,n,t,i);break;case"UnityEngine.RelativeJoint2D":o=this._loadRelativeJoint2DComponent(e,n,t,i);break;case"UnityEngine.SliderJoint2D":o=this._loadSliderJoint2DComponent(e,n,t,i);break;case"UnityEngine.TargetJoint2D":o=this._loadTargetJoint2DComponent(e,n,t,i);break;case"UnityEngine.PlatformEffector2D":o=this._loadPlatformEffector2DComponent(e,n,t,i);break;case"UnityEngine.ParticleSystem":o=this._loadParticleSystemComponent(e,n,t,i);break;case"UnityEngine.ParticleSystemRenderer":o=this._loadParticleSystemRendererComponent(e,n,t,i);break;case"UnityEngine.LineRenderer":o=this._loadLineRendererComponent(e,n,t,i);break;case"UnityEngine.CanvasRenderer":o=this._loadCanvasRendererComponent(e,n,t,i);break;case"UnityEngine.TrailRenderer":o=this._loadTrailRendererComponent(e,n,t,i);break;case"UnityEngine.ReflectionProbe":o=this._loadReflectionProbeComponent(e,n,t,i);break;case"UnityEngine.SpringJoint":case"UnityEngine.FixedJoint":case"UnityEngine.HingeJoint":case"UnityEngine.CharacterJoint":case"UnityEngine.ConfigurableJoint":o=this._loadJointComponent(e,n,t,i)}return o&&i.Put(t.id,o),o},_loadTransformComponent:function(e,n,t,o){const r=t.data;return n.setLocalPosition(r[i.position+0],r[i.position+1],r[i.position+2]),n.setLocalRotation(r[i.rotation+0],r[i.rotation+1],r[i.rotation+2],r[i.rotation+3]),n.setLocalScale(r[i.scale+0],r[i.scale+1],r[i.scale+2]),n["__UnityEngine.Transform"]=new UnityEngine.Transform(n),n},_loadAnimatorComponent:function(e,n,t,i){const r=t.data,a=new pc.AnimatorComponent;n.addUnityComponentFromDeserialization("animator",a),a._entity=n;const s=new UnityEngine.Animator(a);a._enabled=!!r[o.enabled],s.animatorController=i.TryGet(r[o.animatorController+1]),s.updateMode=r[o.updateMode],a.code=s;const c=r[o.humanBones],l=a.code.humanBones;for(let n=0;n<c.length;n+=2)e.r(c[n+0],c[n+1],2,l);return a},_loadAnimationComponent:function(e,n,t,i){const o=t.data,a=new(System.Collections.Generic.List$1(UnityEngine.AnimationClip).ctor),s=o[r.clips];for(let e=0;e<s.length;e+=2){const n=i.Get(s[e+1]);a.add(n)}const c=new pc.AnimationComponent;c._enabled=!!o[r.enabled],c._entity=n,n.addUnityComponentFromDeserialization("animation",c);const l=c["__UnityEngine.Animation"];return l.playAutomatically=o[r.playAutomatically],l.clip=i.TryGet(o[r.clip+1]),l.clips=a,c.code=l,c},_loadCanvasComponent:function(e,n,t,i){const o=pc.MonoBehaviourComponent.create({type:Deserializers.types[t.type],enabled:t.data[a.enabled],entity:n});return o.code.ConfigureForEntity(n),n.screen.$id=t.id,n.addUnityComponentFromDeserialization("monoBehaviour",o),n.screen.monoComponent=o,o.code.enabled=t.data[a.enabled],o.code.internalExecutionOrder=0,e.deserializeTo(t.data,o.code,"Luna.Unity.DTO.UnityEngine.Components.Canvas"),o},_loadCanvasGroupComponent:function(e,n,t,i){const o=pc.MonoBehaviourComponent.create({type:Deserializers.types[t.type],enabled:t.data[s.enabled],entity:n});return o.code.code=o.code,e.deserializeTo(t.data,o.code,"Luna.Unity.DTO.UnityEngine.Components.CanvasGroup"),n.addUnityComponentFromDeserialization("monoBehaviour",o),o},_loadUIBehaviourComponent:function(e,n,t,i){const o=Deserializers.types[t.class],r=pc.MonoBehaviourComponent.create({type:o,enabled:t.enabled,entity:n});return r?(r.code.ConfigureForEntity(n),e.deserializeTo(t.data,r.code),n.addUnityComponentFromDeserialization("monoBehaviour",r),r):null},_loadTextMesh:function(e,n,t,i){const o=pc.MonoBehaviourComponent.create({type:Deserializers.types[t.type],enabled:!0,entity:n});return o?(o.code.ConfigureForEntity(n),e.deserializeTo(t.data,o.code,"Luna.Unity.DTO.UnityEngine.Components.TextMesh"),n.addUnityComponentFromDeserialization("monoBehaviour",o),o):null},_loadRectTransformComponent:function(e,n,t,i){const o=t.data;n.addComponent("element",{type:pc.ELEMENTTYPE_GROUP,pivot:new pc.Vec2(o[c.pivot+0],o[c.pivot+1]),anchor:new pc.Vec4(o[c.anchorMin+0],o[c.anchorMin+1],o[c.anchorMax+0],o[c.anchorMax+1]),sizeDelta:new pc.Vec2(o[c.sizeDelta+0],o[c.sizeDelta+1]),anchoredPosition:new pc.Vec2(o[c.anchoredPosition3D+0],o[c.anchoredPosition3D+1])}),n.element._width=n.element.sizeDelta.x,n.element._height=n.element.sizeDelta.y;const r=n.getLocalPosition();return n.setLocalPosition(r.x,r.y,o[c.anchoredPosition3D+2]),n.setLocalRotation(o[c.rotation+0],o[c.rotation+1],o[c.rotation+2],o[c.rotation+3]),n.setLocalScale(o[c.scale+0],o[c.scale+1],o[c.scale+2]),n["__UnityEngine.Transform"]=new UnityEngine.RectTransform(n),n["__UnityEngine.RectTransform"]=new UnityEngine.RectTransform(n),n},_loadCameraComponent:function(e,n,t,i){const o=t.data,r=o[l.rect];if(n.addComponent("camera",{clearColor:new pc.Color(o[l.backgroundColor+0],o[l.backgroundColor+1],o[l.backgroundColor+2],o[l.backgroundColor+3]),aspectRatio:this.graphicsDevice.width/this.graphicsDevice.height,fov:o[l.fieldOfView],nearClip:o[l.nearClipPlane],farClip:o[l.farClipPlane],clearColorBuffer:o[l.clearFlags]<=UnityEngine.CameraClearFlags.Color,clearDepthBuffer:o[l.clearFlags]<=UnityEngine.CameraClearFlags.Depth,clearStencilBuffer:o[l.clearFlags]<=UnityEngine.CameraClearFlags.Color,clearSkybox:o[l.clearFlags]===UnityEngine.CameraClearFlags.Skybox,projection:o[l.orthographic]?pc.PROJECTION_ORTHOGRAPHIC:pc.PROJECTION_PERSPECTIVE,orthoHeight:o[l.orthographicSize],priority:o[l.depth],cullingMask:o[l.cullingMask],rect:new pc.Vec4(r[0],r[1],r[2],r[3]),frustumCulling:!0}),!n.$prefab&&o[l.targetTexture+1]){const e=UnityEngine.Object.FromHandle(UnityEngine.RenderTexture,this.registry.Get(o[l.targetTexture+1]));if(e){UnityEngine.Object.FromHandle(UnityEngine.Camera,n.camera).targetTexture=e,n.camera.aspectRatio=1*e.handle.width/e.handle.height}}return n.camera},_loadVideoPlayerComponent:function(e,n,t,i){const o=t.data,r=new pc.VideoPlayerComponent({enabled:!!o[d.enabled],entity:n}),a=new UnityEngine.Video.VideoPlayer(r);return a.ConfigureForEntity(n),r.code=a,e.deserializeTo(o,a,"Luna.Unity.DTO.UnityEngine.Components.VideoPlayer"),n.addUnityComponentFromDeserialization("videoPlayer",r),r},_loadAudioSourceComponent:function(e,n,t,i){const o=t.data,r=new pc.AudioSourceUnityComponent({id:t.id,loop:o[u.loop],sound:i.TryGet(o[u.clip+1]),playOnAwake:o[u.playOnAwake]});return n.addUnityComponentFromDeserialization("audiosourceunity",r),r.enabled=!!o[u.enabled],r},_loadLightComponent:function(e,n,t,i){const o=t.data;return n.addComponent("light",{type:["spot","directional","point",null][o[y.type]],color:new pc.Color(o[y.color+0],o[y.color+1],o[y.color+2],o[y.color+3]),intensity:o[y.intensity],innerConeAngle:0,outerConeAngle:o[y.spotAngle],range:o[y.range],cullingMask:o[y.cullingMask],castShadows:o[y.shadows]!==UnityEngine.LightShadows.None,shadowDistance:50,shadowResolution:2048,shadowBias:o[y.shadowBias],shadowType:pc.SHADOW_VSM32,falloffMode:pc.LIGHTFALLOFF_INVERSESQUARED,affectDynamic:o[y.lightmapBakeType]!==UnityEngine.LightmapBakeType.Baked,affectLightmapped:o[y.lightmapBakeType]<=UnityEngine.LightmapBakeType.Baked,enabled:!!o[y.enabled],renderMode:o[y.renderMode],cookie:i.TryGet(o[y.cookie+1]),cookieScale:new pc.Vec2(o[y.cookieSize],o[y.cookieSize])}),n.light},_loadMeshFilterComponent:function(e,n,t,i){const o=t.data,r=new pc.MeshFilterComponent;return n.addUnityComponentFromDeserialization("meshFilter",r),r.id=t.id,r.mesh=i.TryGet(o[p.sharedMesh+1]),r.mesh||console.error(`GameObject ${n.name} is missing mesh. Check force excluded assets if it got excluded.`),r},_loadMeshRendererComponent:function(e,n,t,i){const o=t.data,r=this._loadRendererComponent(g,new pc.MeshRendererComponent,e,n,t,i),a=r.code;return a.lightProbeUsage=o[g.lightProbeUsage],a.reflectionProbeUsage=o[g.reflectionProbeUsage],r},_loadSkinnedMeshRendererComponent:function(e,n,t,i){const o=t.data,r=i.TryGet(o[h.sharedMesh+1]);if(null==r)return console.log(`Missing mesh on skinned mesh. GameObject : ${n.name}`),null;const a=this._loadRendererComponent(h,new pc.SkinnedMeshRendererComponent,e,n,t,i),s=a.model;s.mesh=r;const c=a.code;c.lightProbeUsage=o[h.lightProbeUsage],c.reflectionProbeUsage=o[h.reflectionProbeUsage];const l=o[h.bones];if(0!==l.length){const n=new Array(l.length/2),t=new Array(0);for(let i=0;i<l.length;i+=2)e.r(!0,l[i+1],2,t),n.push(l[i+1]);a.model.bones=t,a.model.skin=new pc.Skin(this.graphicsDevice,r.bindposes,n),a.__renderer="skinned-mesh";const i=o[h.localBounds];a.model.skin.localBounds=new pc.BoundingBox(new pc.Vec3(i[0],i[1],i[2]),new pc.Vec3(i[3],i[4],i[5])),a.model.skin.updateWhenOffscreen=!!o[h.updateWhenOffscreen],e.r(!0,o[h.rootBone+1],0,a.model.skin,"rootBone")}const d=o[h.blendShapesWeights];if(0!==d.length){const e=new pc.MorphInstance(r.morph);e._setBaseMesh(r);for(let n=0;n<d.length;n++)e.setWeight(n,d[n][0]);s.morphInstance=e}return a},_loadSpriteRendererComponent:function(e,n,t,i){const o=t.data,r=this._loadRendererComponent(m,new pc.SpriteRendererComponent,e,n,t,i),a=r.code,s=i.TryGet(o[m.sprite+1]);return a.sortingLayerIndex=UnityEngine.SortingLayer.GetLayerValueFromID(o[m.sortingLayerID]),a.sortingOrder=o[m.sortingOrder],a.color=new pc.Color(o[m.color+0],o[m.color+1],o[m.color+2],o[m.color+3]),a.flipX=o[m.flipX],a.flipY=o[m.flipY],a.drawMode=o[m.drawMode],a.size=new pc.Vec2(o[m.size],o[m.size+1]),a.tileMode=o[m.tileMode],a.adaptiveModeThreshold=o[m.adaptiveModeThreshold],a.maskInteraction=o[m.maskInteraction],a.spriteSortPoint=o[m.spriteSortPoint],s?a.sprite=UnityEngine.Object.FromHandle(UnityEngine.Sprite,s):console.error(`GameObject ${n.name} is missing sprite. Check force excluded assets if it got excluded.`),r.__renderer="sprite",r},_loadRigidbodyComponent:function(e,n,t,i){const o=t.data,r=new pc.RigidbodyComponent({enabled:!0,maxAngularVelocity:o[f.maxAngularVelocity],mass:o[f.mass],drag:o[f.drag],angularDrag:o[f.angularDrag],useGravity:!!o[f.useGravity],isKinematic:!!o[f.isKinematic],constraints:o[f.constraints],collisionDetectionMode:o[f.collisionDetectionMode],interpolation:o[f.interpolation]});return n.addUnityComponentFromDeserialization("rigidbody",r),r},_loadBoxColliderComponent:function(e,n,t,i){const o=t.data,r=new pc.BoxColliderComponent({enabled:o[C.enabled],size:new pc.Vec3(o[C.size+0],o[C.size+1],o[C.size+2]),material:i.TryGet(o[C.material+1]),center:new pc.Vec3(o[C.center+0],o[C.center+1],o[C.center+2]),isTrigger:!!o[C.isTrigger]});return n.addUnityComponentFromDeserialization("collider",r),r},_loadSphereColliderComponent:function(e,n,t,i){const o=t.data,r=new pc.SphereColliderComponent({enabled:o[b.enabled],radius:o[b.radius],material:i.TryGet(o[b.material+1]),center:new pc.Vec3(o[b.center+0],o[b.center+1],o[b.center+2]),isTrigger:!!o[b.isTrigger]});return n.addUnityComponentFromDeserialization("collider",r),r},_loadMeshColliderComponent:function(e,n,t,i){const o=t.data,r=new pc.MeshColliderComponent({enabled:o[_.enabled],mesh:i.TryGet(o[_.sharedMesh+1]),material:i.TryGet(o[_.material+1]),isTrigger:!!o[_.isTrigger],convex:!!o[_.convex]});return n.addUnityComponentFromDeserialization("collider",r),r},_loadCapsuleColliderComponent:function(e,n,t,i){const o=t.data,r=new pc.CapsuleColliderComponent({enabled:o[T.enabled],radius:o[T.radius],material:i.TryGet(o[T.material+1]),center:new pc.Vec3(o[T.center+0],o[T.center+1],o[T.center+2]),height:o[T.height],direction:o[T.direction],isTrigger:!!o[T.isTrigger]});return n.addUnityComponentFromDeserialization("collider",r),r},_loadWheelColliderComponent:function(e,n,t,i){const o=new pc.WheelColliderComponent,r=UnityEngine.Object.FromHandle(Bridge._getTypeByName(Deserializers.types[t.type]),o);return e.deserializeTo(t.data,r,"Luna.Unity.DTO.UnityEngine.Components.WheelCollider"),n.addUnityComponentFromDeserialization("collider",o),o},_loadCharacterControllerComponent:function(e,n,t,i){const o=new pc.CharacterControllerComponent,r=UnityEngine.Object.FromHandle(Bridge._getTypeByName(Deserializers.types[t.type]),o);return e.deserializeTo(t.data,r,"Luna.Unity.DTO.UnityEngine.Components.CharacterController"),n.addUnityComponentFromDeserialization("collider",o),o},_loadRigidbody2DComponent:function(e,n,t,i){const o=t.data,r=new pc.Rigidbody2DComponent({entity:n,enabled:!0,simulated:o[U.simulated],useAutoMass:o[U.useAutoMass],type:o[U.bodyType],mass:o[U.mass],drag:o[U.drag],angularDrag:o[U.angularDrag],gravityScale:o[U.gravityScale],collisionDetectionMode:o[U.collisionDetectionMode],constraints:o[U.constraints],material:i.TryGet(U.material+1)});return n.addUnityComponentFromDeserialization("rigidbody2D",r),r},_loadBoxCollider2DComponent:function(e,n,t,i){const o=t.data,r=new pc.BoxCollider2DComponent({enabled:o[E.enabled],isTrigger:o[E.isTrigger],usedByEffector:o[E.usedByEffector],density:o[E.density],size:new pc.Vec2(o[E.size+0],o[E.size+1]),center:new pc.Vec2(o[E.offset+0],o[E.offset+1]),radius:o[E.edgeRadius],material:i.TryGet(o[E.material+1])});return n.addUnityComponentFromDeserialization("collider2D",r),r},_loadCircleCollider2DComponent:function(e,n,t,i){const o=t.data,r=new pc.CircleCollider2DComponent({enabled:o[A.enabled],isTrigger:o[A.isTrigger],usedByEffector:o[A.usedByEffector],density:o[A.density],radius:o[A.radius],center:new pc.Vec2(o[A.offset+0],o[A.offset+1]),material:i.TryGet(o[A.material+1])});return n.addUnityComponentFromDeserialization("collider2D",r),r},_loadCapsuleCollider2DComponent:function(e,n,t,i){const o=t.data,r=new pc.CapsuleCollider2DComponent({enabled:o[D.enabled],isTrigger:o[D.isTrigger],usedByEffector:o[D.usedByEffector],density:o[D.density],center:new pc.Vec2(o[D.offset+0],o[D.offset+1]),material:i.TryGet(o[D.material+1]),direction:o[D.direction],size:new pc.Vec2(o[D.size+0],o[D.size+1])});return n.addUnityComponentFromDeserialization("collider2D",r),r},_loadEdgeCollider2DComponent:function(e,n,t,i){const o=t.data,r=new pc.EdgeCollider2DComponent({enabled:o[R.enabled],isTrigger:o[R.isTrigger],usedByEffector:o[R.usedByEffector],density:o[R.density],points:o[R.points],offset:new pc.Vec2(o[R.offset+0],o[R.offset+1]),radius:o[R.edgeRadius],material:i.TryGet(o[R.material+1])});return n.addUnityComponentFromDeserialization("collider2D",r),r},_loadPolygonCollider2DComponent:function(e,n,t,i){const o=t.data,r=new pc.PolygonCollider2DComponent({enabled:o[O.enabled],isTrigger:o[O.isTrigger],usedByEffector:o[O.usedByEffector],density:o[O.density],points:o[O.points],offset:new pc.Vec2(o[O.offset+0],o[O.offset+1]),material:i.TryGet(o[O.material+1])});return n.addUnityComponentFromDeserialization("collider2D",r),r},_loadSpringJoint2DComponent:function(e,n,t,i){const o=t.data;return this._loadJoint2DComponent(e,n,t,L,new pc.SpringJoint2DComponent({enabled:o[L.enabled],enableCollision:o[L.enableCollision],breakForce:o[L.breakForce],breakTorque:o[L.breakTorque],frequency:o[L.frequency],dampingRatio:o[L.dampingRatio],distance:o[L.distance],autoConfigureConnectedAnchor:o[L.autoConfigureConnectedAnchor],anchor:new pc.Vec2(o[L.anchor+0],o[L.anchor+1]),connectedAnchor:new pc.Vec2(o[L.connectedAnchor+0],o[L.connectedAnchor+1])}))},_loadDistanceJoint2DComponent:function(e,n,t,i){const o=t.data;return this._loadJoint2DComponent(e,n,t,w,new pc.DistanceJoint2DComponent({enabled:o[w.enabled],enableCollision:o[w.enableCollision],breakForce:o[w.breakForce],breakTorque:o[w.breakTorque],maxDistanceOnly:o[w.maxDistanceOnly],distance:o[w.distance],autoConfigureDistance:o[w.autoConfigureDistance],autoConfigureConnectedAnchor:o[w.autoConfigureConnectedAnchor],anchor:new pc.Vec2(o[w.anchor+0],o[w.anchor+1]),connectedAnchor:new pc.Vec2(o[w.connectedAnchor+0],o[w.connectedAnchor+1])}))},_loadFixedJoint2DComponent:function(e,n,t,i){const o=t.data;return this._loadJoint2DComponent(e,n,t,S,new pc.FixedJoint2DComponent({enabled:o[S.enabled],enableCollision:o[S.enableCollision],breakForce:o[S.breakForce],breakTorque:o[S.breakTorque],frequency:o[S.frequency],dampingRatio:o[S.dampingRatio],autoConfigureConnectedAnchor:o[S.autoConfigureConnectedAnchor],anchor:new pc.Vec2(o[S.anchor+0],o[S.anchor+1]),connectedAnchor:new pc.Vec2(o[S.connectedAnchor+0],o[S.connectedAnchor+1])}))},_loadHingeJoint2DComponent:function(e,n,t,i){const o=t.data,r=new UnityEngine.JointAngleLimits2D;e.deserializeTo(o[P.limits],r);const a=new UnityEngine.JointMotor2D;return e.deserializeTo(o[P.motor],a),this._loadJoint2DComponent(e,n,t,P,new pc.HingeJoint2DComponent({enabled:o[P.enabled],enableCollision:o[P.enableCollision],breakForce:o[P.breakForce],breakTorque:o[P.breakTorque],autoConfigureConnectedAnchor:o[P.autoConfigureConnectedAnchor],anchor:new pc.Vec2(o[P.anchor+0],o[P.anchor+1]),connectedAnchor:new pc.Vec2(o[P.connectedAnchor+0],o[P.connectedAnchor+1]),useLimits:o[P.useLimits],limits:r,useMotor:o[P.useMotor],motor:a}))},_loadWheelJoint2DComponent:function(e,n,t,i){const o=t.data,r=new UnityEngine.JointSuspension2D;e.deserializeTo(o[B.suspension],r);const a=new UnityEngine.JointMotor2D;return e.deserializeTo(o[B.motor],a),this._loadJoint2DComponent(e,n,t,B,new pc.WheelJoint2DComponent({enabled:o[B.enabled],enableCollision:o[B.enableCollision],breakForce:o[B.breakForce],breakTorque:o[B.breakTorque],autoConfigureConnectedAnchor:o[B.autoConfigureConnectedAnchor],anchor:new pc.Vec2(o[B.anchor+0],o[B.anchor+1]),connectedAnchor:new pc.Vec2(o[B.connectedAnchor+0],o[B.connectedAnchor+1]),suspension:r,useMotor:o[B.useMotor],motor:a}))},_loadFrictionJoint2DComponent:function(e,n,t,i){const o=t.data;return this._loadJoint2DComponent(e,n,t,F,new pc.FrictionJoint2DComponent({enabled:o[F.enabled],enableCollision:o[F.enableCollision],breakForce:o[F.breakForce],breakTorque:o[F.breakTorque],autoConfigureConnectedAnchor:o[F.autoConfigureConnectedAnchor],anchor:new pc.Vec2(o[F.anchor+0],o[F.anchor+1]),connectedAnchor:new pc.Vec2(o[F.connectedAnchor+0],o[F.connectedAnchor+1]),maxForce:o[F.maxForce],maxTorque:o[F.maxTorque]}))},_loadRelativeJoint2DComponent:function(e,n,t,i){const o=t.data;return this._loadJoint2DComponent(e,n,t,M,new pc.RelativeJoint2DComponent({enabled:o[M.enabled],enableCollision:o[M.enableCollision],breakForce:o[M.breakForce],breakTorque:o[M.breakTorque],autoConfigureOffset:o[M.autoConfigureOffset],linearOffset:new pc.Vec2(o[M.linearOffset+0],o[M.linearOffset+1]),angularOffset:o[M.angularOffset],maxForce:o[M.maxForce],maxTorque:o[M.maxTorque],correctionScale:o[M.correctionScale]}))},_loadSliderJoint2DComponent:function(e,n,t,i){const o=t.data,r=new UnityEngine.JointTranslationLimits2D;e.deserializeTo(o[I.limits],r);const a=new UnityEngine.JointMotor2D;return e.deserializeTo(o[I.motor],a),this._loadJoint2DComponent(e,n,t,I,new pc.SliderJoint2DComponent({enabled:o[I.enabled],enableCollision:o[I.enableCollision],breakForce:o[I.breakForce],breakTorque:o[I.breakTorque],autoConfigureConnectedAnchor:o[I.autoConfigureConnectedAnchor],anchor:new pc.Vec2(o[I.anchor+0],o[I.anchor+1]),connectedAnchor:new pc.Vec2(o[I.connectedAnchor+0],o[I.connectedAnchor+1]),autoConfigureAngle:o[I.autoConfigureAngle],angle:o[I.angle],useLimits:o[I.useLimits],limits:r,useMotor:o[I.useMotor],motor:a}))},_loadTargetJoint2DComponent:function(e,n,t,i){const o=t.data;return this._loadJoint2DComponent(e,n,t,x,new pc.TargetJoint2DComponent({enabled:o[x.enabled],enableCollision:o[x.enableCollision],breakForce:o[x.breakForce],breakTorque:o[x.breakTorque],autoConfigureTarget:o[x.autoConfigureTarget],target:new pc.Vec2(o[x.target+0],o[x.target+1]),anchor:new pc.Vec2(o[x.anchor+0],o[x.anchor+1]),maxForce:o[x.maxForce],dampingRatio:o[x.dampingRatio],frequency:o[x.frequency]}))},_loadPlatformEffector2DComponent:function(e,n,t,i){const o=t.data,r=new pc.PlatformEffector2DComponent({enabled:o[z.enabled]});return n.addUnityComponentFromDeserialization("effector2D",r),r},_loadJoint2DComponent:function(e,n,t,i,o){const r=t.data,a=Deserializers.types[t.type],s=UnityEngine.Object.FromHandle(Bridge._getTypeByName(a),o);return e.r(r[i.connectedBody+0],r[i.connectedBody+1],0,s,"connectedBody"),n.addUnityComponentFromDeserialization("joint2D",o),o},_loadParticleSystemComponent:function(e,n,t,i){const o=new pc.ParticleSystem,r=new pc.ParticleSystemComponent({particleSystem:o});return e.deserializeTo(t.data,o,"Luna.Unity.DTO.UnityEngine.Components.ParticleSystem"),n.addUnityComponentFromDeserialization("particlesystem",r),r},_loadParticleSystemRendererComponent:function(e,n,t,i){const o=new pc.ParticleSystemRenderer;e.deserializeTo(t.data,o,"Luna.Unity.DTO.UnityEngine.Components.ParticleSystemRenderer"),o.sortingLayerIndex=UnityEngine.SortingLayer.GetLayerValueFromID(o.sortingLayerID),o.sortingOrder=o.sortingOrder;const r=new pc.ParticleSystemRendererComponent({particleSystemRenderer:o});return n.addUnityComponentFromDeserialization("particleSystemRenderer",r),r.enabled=o.enabled,r},_loadJointComponent:function(e,n,t,i){const o=t.data,r=new pc.JointComponent({type:Deserializers.types[t.type]}),a=UnityEngine.Object.FromHandle(Bridge._getTypeByName(Deserializers.types[t.type]),r);return e.deserializeTo(o,a,Deserializers.types[t.type].replace("UnityEngine.","Luna.Unity.DTO.UnityEngine.Components.")),n.addUnityComponentFromDeserialization("joint",r),r},_loadMonoBehaviourComponent:function(e,n,t,i){const o=Deserializers.types[t.class],r=pc.MonoBehaviourComponent.create({type:o,enabled:t.enabled,entity:n});return r?(e.deserializeTo(t.data,r.code),n.addUnityComponentFromDeserialization("monoBehaviour",r),r):null},_loadRendererComponent:function(e,n,t,i,o,r){const a=o.data,s=n;i.addUnityComponentFromDeserialization("renderer",s);const c=a[e.sharedMaterials],l=[];for(let e=0;e<c.length;e+=2){let n=r.TryGet(c[e+1]);n||(n=UnityEngine.Graphics.InternalErrorShaderMaterial.handle),l.push(n)}return s.model.materials=l,s.model.sortingLayerIndex=UnityEngine.SortingLayer.GetLayerValueFromID(a[e.sortingLayerID]),s.model.sortingOrder=a[e.sortingOrder],s.model.cullingLayer=i.cullingLayer,s.enabled=!!a[e.enabled],s.castShadows=a[e.shadowCastingMode]>UnityEngine.Rendering.ShadowCastingMode.Off,s.receiveShadows=!!a[e.receiveShadows],s.id=o.id,s.model._lightmapSceneIndex=a[e.lightmapSceneIndex],s.model._lightmapIndex=a[e.lightmapIndex],s.model.lightmapScaleOffset=new pc.Vec4(a[e.lightmapScaleOffset+0],a[e.lightmapScaleOffset+1],a[e.lightmapScaleOffset+2],a[e.lightmapScaleOffset+3]),s},_loadLineRendererComponent:function(e,n,t,i){const o=this._loadRendererComponent(k,new pc.LineRendererComponent,e,n,t,i),r=o.code;return e.deserializeTo(t.data,r,"Luna.Unity.DTO.UnityEngine.Components.LineRenderer"),o},_loadCanvasRendererComponent:function(e,n,t,i){const o=new pc.CanvasRendererComponent;return e.deserializeTo(t.data,o.code,"Luna.Unity.DTO.UnityEngine.Components.CanvasRenderer"),n.addUnityComponentFromDeserialization("canvasRenderer",o),o},_loadTrailRendererComponent:function(e,n,t,i){const o=this._loadRendererComponent(v,new pc.TrailRendererComponent,e,n,t,i),r=o.code;return e.deserializeTo(t.data,r,"Luna.Unity.DTO.UnityEngine.Components.TrailRenderer"),o},_loadReflectionProbeComponent:function(e,n,t,i){const o=t.data,r=new pc.ReflectionProbeComponent,a=UnityEngine.Object.FromHandle(UnityEngine.ReflectionProbe,r);return e.deserializeTo(o,a,"Luna.Unity.DTO.UnityEngine.Components.ReflectionProbe"),n.addUnityComponentFromDeserialization("reflectionprobe",r),r}})}),Bridge.assembly("LunaUnity",(e,n)=>{Bridge.define("LunaUnity.Objects.Handlers.AudioMixer",{inherits:[LunaUnity.Objects.Handlers.Base],ctor:function(e){this.$initialize(),LunaUnity.Objects.Handlers.Base.ctor.call(this,e)},loadAsync:function(e,n,t){const i=e.d("Luna.Unity.DTO.UnityEngine.Audio.AudioMixer",n.data),o=new UnityEditor.Audio.AudioMixerController(i);this.registry.Put(n.id,o);for(let e=0;e<o.groups.length;e++)this.registry.Put(o.groups[e].id,o.groups[e]);return{result:o}},unloadAsync:function(e){this.registry.Release(e.id)}})}),Bridge.assembly("LunaUnity",(e,n)=>{Bridge.define("LunaUnity.Objects.Handlers.AudioMixerSnapshot",{inherits:[LunaUnity.Objects.Handlers.Base],ctor:function(e){this.$initialize(),LunaUnity.Objects.Handlers.Base.ctor.call(this,e)},loadAsync:function(e,n,t){const i=e.d("Luna.Unity.DTO.UnityEngine.Audio.AudioMixerSnapshot",n.data),o=new UnityEngine.Audio.AudioMixerSnapshot(i);return this.registry.Put(n.id,o),{result:o}},unloadAsync:function(e){this.registry.Release(e.id)}})}),Bridge.assembly("LunaUnity",(e,n)=>{const t=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Assets.ProjectSettings"],i=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Assets.ProjectSettings+ScriptsExecutionOrder"],o=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Assets.ProjectSettings+SortingLayer"],r=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Assets.ProjectSettings+CullingLayer"],a=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Assets.ProjectSettings+TimeSettings"],s=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Assets.ProjectSettings+PhysicsSettings"],c=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Assets.ProjectSettings+PhysicsSettings+CollisionMask"],l=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Assets.ProjectSettings+Physics2DSettings"];Bridge.define("LunaUnity.Objects.Handlers.ProjectSettings",{inherits:[LunaUnity.Objects.Handlers.Base],ctor:function(e){this.$initialize(),LunaUnity.Objects.Handlers.Base.ctor.call(this,e)},loadAsync:function(e,n,d){const u=n.data,y=u[t.scriptsExecutionOrder],p=[];for(let e=0;e<y.length;e++){const n=y[e];p[n[i.name]]=n[i.value]}this.app.systems.monoBehaviour.scriptsExecutionOrder=p;const g=u[t.sortingLayers];pc.Application.getApplication().renderer.removeShadows=!!u[t.removeShadows],this.autoInstantiatePrefabs=!!u[t.autoInstantiatePrefabs];for(let e=0;e<g.length;e++){const n=new UnityEngine.SortingLayer,t=g[e];n.id=t[o.id],n.name=t[o.name],n.value=t[o.value],UnityEngine.SortingLayer.layers.push(n)}const h=u[t.cullingLayers];for(let e=0;e<h.length;e++){const n=new UnityEngine.LayerMask.CullingLayer,t=h[e];n.id=t[r.id],n.name=t[r.name],UnityEngine.LayerMask.layers.push(n)}const m=u[t.timeSettings];this.app.systems.unitymanager.fixedTimeStep=m[a.fixedDeltaTime],this.app.systems.unitymanager.maximumAllowedTimeStep=m[a.maximumDeltaTime],this.app.systems.unitymanager.timeScale=m[a.timeScale],this.app.systems.unitymanager.maximumParticleTimestep=m[a.maximumParticleTimestep];const f=u[t.physicsSettings];this.app.systems.physics.gravity=new pc.Vec3(f[s.gravity+0],f[s.gravity+1],f[s.gravity+2]);const C=f[s.collisionMatrix];for(let e=0;e<C.length;e++){const n=C[e];this.app.systems.physics.setIgnoreCollisionBetweenLayers(n[c.layerId],n[c.otherLayerId],n[c.enabled])}this.app.systems.physics.defaultSolverIterations=f[s.defaultSolverIterations],this.app.systems.physics.autoSyncTransforms=!!f[s.autoSyncTransforms],this.app.systems.physics.autoSimulation=!!f[s.autoSimulation];const b=this.app.systems.physics2D,_=u[t.physics2DSettings];b.gravity=new pc.Vec2(_[l.gravity+0],_[l.gravity+1]),b.autoSyncTransforms=_[l.autoSyncTransforms],b.positionIterations=_[l.positionIterations],b.velocityIterations=_[l.velocityIterations],e.r(!0,_[l.material+1],0,b,"defaultMaterial");const T=_[l.collisionMatrix];for(let e=0;e<T.length;e++){const n=T[e];b.setIgnoreCollisionBetweenLayers(n[c.layerId],n[c.otherLayerId],n[c.enabled])}return UnityEngine.Graphics.graphicsDevice.enableAutoInstancing=!!u[t.enableAutoInstancing],UnityEngine.LightmapSettings.lightmapEncodingQuality=u[t.lightmapEncodingQuality],UnityEngine.LightmapSettings.bakedColorSpace=u[t.desiredColorSpace],{}},unloadAsync:function(e){this.registry.Release(e.id)}})}),Bridge.assembly("LunaUnity",(e,n)=>{const t=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Assets.Material"];Bridge.define("LunaUnity.Objects.Handlers.Material",{inherits:[LunaUnity.Objects.Handlers.Base],ctor:function(e){this.$initialize(),LunaUnity.Objects.Handlers.Base.ctor.call(this,e),this.request=new LunaUnity.Objects.ImmediateRequest(null)},loadAsync:function(e,n,i){this.request.registry=this.registry;const o=this.request.d("Luna.Unity.DTO.UnityEngine.Assets.Material",n.data);return o.shader=this.registry.TryGet(n.data[t.shader+1]),o.setup(),"Default UI Material"===o.name&&(UnityEngine.Canvas.DefaultCanvasMaterial=UnityEngine.Object.FromHandle(UnityEngine.Material,o)),"Sprites-Default"===o.name&&(UnityEngine.Material.SpritesDefault=UnityEngine.Object.FromHandle(UnityEngine.Material,o)),"Font Material"===o.name&&(UnityEngine.Material.FontDefault=UnityEngine.Object.FromHandle(UnityEngine.Material,o)),this.registry.Put(n.id,o),System.Threading.Tasks.Task.fromResult(o)},unloadAsync:function(e){this.registry.Release(e.id)}})}),Bridge.assembly("LunaUnity",(e,n)=>{Bridge.define("LunaUnity.Objects.Handlers.PhysicMaterial",{inherits:[LunaUnity.Objects.Handlers.Base],ctor:function(e){this.$initialize(),LunaUnity.Objects.Handlers.Base.ctor.call(this,e)},loadAsync:function(e,n){const t=e.d("Luna.Unity.DTO.UnityEngine.Assets.PhysicMaterial",n.data),i=new Goblin.PhysicMaterial(t);return this.registry.Put(n.id,i),{result:i}},unloadAsync:function(e){this.registry.Release(e.id)}})}),Bridge.assembly("LunaUnity",(e,n)=>{Bridge.define("LunaUnity.Objects.Handlers.PhysicsMaterial2D",{inherits:[LunaUnity.Objects.Handlers.Base],ctor:function(e){this.$initialize(),LunaUnity.Objects.Handlers.Base.ctor.call(this,e)},loadAsync:function(e,n){const t=e.d("Luna.Unity.DTO.UnityEngine.Assets.PhysicsMaterial2D",n.data);return this.registry.Put(n.id,t),{result:t}},unloadAsync:function(e){this.registry.Release(e.id)}})}),Bridge.assembly("LunaUnity",(e,n)=>{const t=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Assets.Mesh"],i=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Assets.Mesh+SubMesh"],o=new Blob;Bridge.define("LunaUnity.Objects.Handlers.Mesh",{inherits:[LunaUnity.Objects.Handlers.Base],ctor:function(e){this.$initialize(),LunaUnity.Objects.Handlers.Base.ctor.call(this,e)},loadAsync:function(e,n,r){const a=n.data,s=new pc.Mesh(!0),c=r.find(e=>e.manifest.id===n.assetBundleId).blob||o;s.name=a[t.name];const l=a[t.vertices];let d=c.slice(l[0],l[0]+l[1]);const u=a[t.halfPrecision]?pc.Conversion.fromFloat16ToFloat32(new Uint16Array(d)):new Float32Array(d),y=s.defaultVertexBuffer(a[t.streams],a[t.vertexCount],u.buffer);a[t.vertices]=null,s.vertexBuffer=y,s.subMeshes=[];const p=a[t.subMeshes],g=a[t.aabb];for(let e=0;e<p.length;e++){const t=p[e][i.triangles],o=new Uint16Array(c.slice(t[0],t[0]+t[1])),r=new pc.Mesh;r.aabb=new pc.BoundingBox(new pc.Vec3(g[0],g[1],g[2]),new pc.Vec3(g[3],g[4],g[5])),r.$id=n.id;const a=s.defaultIndexBuffer(o.length,o);r.vertexBuffer=y,r.indexBuffer[0]=a,r.primitive[0].type=pc.gfx.PRIMITIVE_TRIANGLES,r.primitive[0].base=0,r.primitive[0].count=o.length,r.primitive[0].indexed=!0,s.subMeshes.push(r)}s.indexBuffer=s.subMeshes[0].indexBuffer,s.primitive[0].type=pc.gfx.PRIMITIVE_TRIANGLES,s.primitive[0].base=0,s.primitive[0].count=p[0].length,s.primitive[0].indexed=!0,s.aabb=new pc.BoundingBox(new pc.Vec3(g[0],g[1],g[2]),new pc.Vec3(g[3],g[4],g[5]));const h=a[t.bindposes];for(let e=0;e<h.length;e+=16)s.bindposes.push((new pc.Mat4).setData(h[e+0],h[e+1],h[e+2],h[e+3],h[e+4],h[e+5],h[e+6],h[e+7],h[e+8],h[e+9],h[e+10],h[e+11],h[e+12],h[e+13],h[e+14],h[e+15]));const m=a[t.blendShapes];if(0!==m.length){s.morph=new pc.Morph([]);for(let e=0;e<m.length;e++){const n=m[e],i=n[1],o={};o.name=n[0],o.frames=[];for(let e=0;e<i.length;e++){const i={};i.weight=n[1][e][0],d=c.slice(n[1][e][1][0],n[1][e][1][0]+n[1][e][1][1]),i.deltaPositions=a[t.halfPrecision]?pc.Conversion.fromFloat16ToFloat32(new Uint16Array(d)):n[1][e][1],d=c.slice(n[1][e][2][0],n[1][e][2][0]+n[1][e][2][1]),i.deltaNormals=a[t.halfPrecision]?pc.Conversion.fromFloat16ToFloat32(new Uint16Array(d)):n[1][e][2],d=c.slice(n[1][e][3][0],n[1][e][3][0]+n[1][e][3][1]),i.deltaTangents=a[t.halfPrecision]?pc.Conversion.fromFloat16ToFloat32(new Uint16Array(d)):n[1][e][3];const r=new pc.MorphTargetFrame(i);o.frames[e]=r}const r=new pc.MorphTarget(o);s.morph.addTarget(r),s.morph._setBaseMesh(s)}}return this.registry.Put(n.id,s),{result:s}},unloadAsync:function(e){const n=this.registry.Release(e.id);n&&n.destroy()}})}),Bridge.assembly("LunaUnity",(e,n)=>{const t=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Scene.Scene"],i=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Assets.RenderSettings"],o=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Assets.RenderSettings+LightProbes"];Bridge.define("LunaUnity.Objects.Handlers.Scene",{inherits:[LunaUnity.Objects.Handlers.Base],ctor:function(e){this.$initialize(),LunaUnity.Objects.Handlers.Base.ctor.call(this,e)},loadAsync:function(e,n,o){const r=n.data,a=(new LunaUnity.Objects.Scene).initializeAsTemplate({renderSettings:e.d("Luna.Unity.DTO.UnityEngine.Assets.RenderSettings",n.render_settings.data),rootJsons:n.objects,name:r[t.name],index:r[t.index],lightmaps:r[t.lightmaps]}),s=o.find(e=>e.manifest.id===n.assetBundleId).blob,c=n.render_settings.data[i.lightProbes];return this.parseLightProbeData(s,c,a.renderSettings.lightProbes),UnityEngine.SceneManagement.SceneManager.scenes.push(a),this.registry.Put("scenes/"+n.name,a),{result:a}},parseLightProbeData:function(e,n,t){let i=[],r=0,a=this.getTypedArrayFromBlobAndMarker(Float32Array,e,n[o.bakedProbes]);for(r=0;r<a.length;r+=27)i.push(pc.SphericalHarmonicsL2.fromArray(a.subarray(r,r+27)));for(t.bakedProbes=i,i=[],a=this.getTypedArrayFromBlobAndMarker(Float32Array,e,n[o.positions]),r=0;r<a.length;r+=3)i.push(new pc.Vec3(a[r+0],a[r+1],a[r+2]));for(t.positions=i,i=[],a=this.getTypedArrayFromBlobAndMarker(Float32Array,e,n[o.hullRays]),r=0;r<a.length;r+=3)i.push(new pc.Vec3(a[r+0],a[r+1],a[r+2]));for(t.hullRays=i,i=[],a=this.getTypedArrayFromBlobAndMarker(Float32Array,e,n[o.matrices]),r=0;r<a.length;r+=16)i.push(pc.Mat4.fromArray(a.subarray(r,r+16)));t.matrices=i,t.tetrahedra=this.getTypedArrayFromBlobAndMarker(Int16Array,e,n[o.tetrahedra]),t.neighbours=this.getTypedArrayFromBlobAndMarker(Int16Array,e,n[o.neighbours])},getTypedArrayFromBlobAndMarker:function(e,n,t){return new e(n?n.slice(t[0],t[0]+t[1]):0)},unloadAsync:function(e){this.registry.Release(e.id)}})}),Bridge.assembly("LunaUnity",(e,n)=>{const t=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Assets.Shader"];Bridge.define("LunaUnity.Objects.Handlers.Shader",{inherits:[LunaUnity.Objects.Handlers.Base],ctor:function(e){this.$initialize(),LunaUnity.Objects.Handlers.Base.ctor.call(this,e)},loadAsync:function(e,n,t){const i=new pc.UnityShader(this.graphicsDevice);return e.d("Luna.Unity.DTO.UnityEngine.Assets.Shader",n.data,i),i.setup(),this.registry.Put(n.id,i),UnityEngine.Shader.shaderIndex[i.name]=i,System.Threading.Tasks.Task.fromResult(i)},_loadRenderState:function(e,n){const t=e.d("Luna.Unity.DTO.UnityEngine.Assets.Shader+Pass",n),i=[];return this._collectBoundParameters(t,i),t.boundParameters=i,t},_collectBoundParameters:function(e,n){for(const t in e){if(!e.hasOwnProperty(t))continue;const i=e[t];i&&i.$$fullname&&("Luna.Unity.DTO.UnityEngine.Assets.Shader.Pass+Value"===i.$$fullname&&i.name?n.push(i):this._collectBoundParameters(i,n))}},_getDefaultTextureNamed:function(e){const n=UnityEngine.Texture2D[e+"Texture"];return n?n.handle:null},_loadShaderForStandardMaterialAsync:function(e,n){return this.registry.Put(n.id,{name:n.data[t.name],renderState:this._loadRenderState(e,n.data[t.passes][0])}),System.Threading.Tasks.Task.fromResult(!0)},_loadCustomShaderAsync:function(e,n){const i=[];let o=pc.MultipassShader;const r=n.data,a=r[t.passes];let s=null;for(let c=0;c<a.length;c++){const a=r[t.vertexPrograms][c],l=r[t.fragmentPrograms][c];a&&l?s=new o(this.graphicsDevice,{attributes:{vertex_position:pc.SEMANTIC_POSITION,vertex_normal:pc.SEMANTIC_NORMAL,vertex_tangent:pc.SEMANTIC_TANGENT,vertex_texCoord0:pc.SEMANTIC_TEXCOORD0,vertex_texCoord1:pc.SEMANTIC_TEXCOORD1,vertex_color:pc.SEMANTIC_COLOR,instancing_translation:pc.SEMANTIC_TEXCOORD7,instancing_rotation:pc.SEMANTIC_BLENDWEIGHT,instancing_scale:pc.SEMANTIC_BLENDINDICES,instancing_color:pc.SEMANTIC_ATTR0,instancing_st:pc.SEMANTIC_ATTR1,_glesVertex:pc.SEMANTIC_POSITION,_glesNormal:pc.SEMANTIC_NORMAL,_glesTangent:pc.SEMANTIC_TANGENT,_glesMultiTexCoord0:pc.SEMANTIC_TEXCOORD0,_glesMultiTexCoord1:pc.SEMANTIC_TEXCOORD1,_glesMultiTexCoord2:pc.SEMANTIC_TEXCOORD2,_glesMultiTexCoord3:pc.SEMANTIC_TEXCOORD3,_glesColor:pc.SEMANTIC_COLOR,in_POSITION0:pc.SEMANTIC_POSITION,in_NORMAL0:pc.SEMANTIC_NORMAL,in_TANGENT0:pc.SEMANTIC_TANGENT,in_TEXCOORD0:pc.SEMANTIC_TEXCOORD0,in_TEXCOORD1:pc.SEMANTIC_TEXCOORD1,in_TEXCOORD2:pc.SEMANTIC_TEXCOORD2,in_TEXCOORD3:pc.SEMANTIC_TEXCOORD3,in_COLOR0:pc.SEMANTIC_COLOR,_patched_POSITION:pc.SEMANTIC_POSITION,_patched_COLOR:pc.SEMANTIC_COLOR,_patched_NORMAL:pc.SEMANTIC_NORMAL,_patched_TANGENT:pc.SEMANTIC_TANGENT,_patched_TEXCOORD0:pc.SEMANTIC_TEXCOORD0,vertex_boneWeights:pc.SEMANTIC_BLENDWEIGHT,vertex_boneIndices:pc.SEMANTIC_BLENDINDICES},vshader:a,fshader:l}):(s=pc._createMissingShader(n.data[t.name],n.id),s.name=n.data[t.name]),s._supportsKeywords=!0,s.renderState=this._loadRenderState(e,r[t.passes][c]),i.push(s),o=pc.Shader}return s=i[0],s.shaders=i,s.defaultParameters={},this.registry.Put(n.id,s),UnityEngine.Shader.shaderIndex[n.name]=s,System.Threading.Tasks.Task.fromResult(s)},unloadAsync:function(e){this.registry.Release(e.id)}})}),Bridge.assembly("LunaUnity",(e,n)=>{const t=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Assets.VideoClip"];Bridge.define("LunaUnity.Objects.Handlers.Video",{inherits:[LunaUnity.Objects.Handlers.Base],ctor:function(e){this.$initialize(),this.playgroundAssetOverrides=window.playgroundAssetOverrides||{},LunaUnity.Objects.Handlers.Base.ctor.call(this,e)},loadAsync:function(e,n,i){const o=new System.Threading.Tasks.TaskCompletionSource,r=n.data,a={name:r[t.name],width:r[t.width],height:r[t.height],frameRate:r[t.frameRate],frameCount:r[t.frameCount]},s=new pc.VideoTexture(this.app.graphicsDevice,a);return this.registry.Put(n.id,s),this.network.GetVideoAsync(this._getVideoUrl(n)).continueWith(Bridge.fn.bind(this,e=>{if(e.status===System.Threading.Tasks.TaskStatus.ranToCompletion){const n=e.result;s.setSource(n),o.setResult(s)}else o.setCanceled()})),o.task},_getVideoUrl:function(e){return"external"===this.network.resourceConfig.video&&e.id in this.playgroundAssetOverrides?this.playgroundAssetOverrides[e.id]:"assets/bundles/"+e.assetBundleId+"/"+e.id+(e.ext||".mp4")},unloadAsync:function(e){const n=this.registry.Release(e.id);n&&n.destroy()}})}),Bridge.assembly("LunaUnity",(e,n)=>{const t=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Assets.AudioClip"];Bridge.define("LunaUnity.Objects.Handlers.Sound",{inherits:[LunaUnity.Objects.Handlers.Base],ctor:function(e){this.$initialize(),this.playgroundAssetOverrides=window.playgroundAssetOverrides||{},LunaUnity.Objects.Handlers.Base.ctor.call(this,e)},loadAsync:function(e,n,i){const o=new System.Threading.Tasks.TaskCompletionSource,r=new pc.Sound;r.name=n.data[t.name];const a=this._getSoundUrl(n),s=function(e){r.buffer=e,o.setResult(r)},c=function(e){e=e||"Error loading audio url: "+a,console.error(e),o.setCancelled()},l=this.app._audioManager;return this.registry.Put(n.id,r),this.network.GetSoundAsync(this._getSoundUrl(n)).continueWith(e=>{e.status===System.Threading.Tasks.TaskStatus.ranToCompletion?l.context.decodeAudioData(e.result,s,c):c(e.error)}),o.task},_getSoundUrl:function(e){return"external"===this.network.resourceConfig.sound&&e.id in this.playgroundAssetOverrides?this.playgroundAssetOverrides[e.id]:"assets/bundles/"+e.assetBundleId+"/"+e.id+(e.ext||".mp3")},unloadAsync:function(e){const n=this.registry.Release(e.id);n&&(n.buffer=null)}})}),Bridge.assembly("LunaUnity",(e,n)=>{const t=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Textures.Sprite"];Bridge.define("LunaUnity.Objects.Handlers.Sprite",{inherits:[LunaUnity.Objects.Handlers.Base],ctor:function(e){this.$initialize(),LunaUnity.Objects.Handlers.Base.ctor.call(this,e)},loadAsync:function(e,n,i){const o=n.data,r=this.registry.Get(o[t.texture+1]),a=new pc.Sprite({}),s=o[t.textureWidth]/r.width;return a.attributes.transparency=new pc.Vec4((o[t.packedRect+0]-o[t.textureRect+0])*r.width,(o[t.packedRect+1]-o[t.textureRect+1])*r.height,(o[t.textureRect+2]-o[t.packedRect+2])*r.width,(o[t.textureRect+3]-o[t.packedRect+3])*r.height),a.attributes.textureRect=new pc.Vec4(o[t.packedRect+0]*r.width,o[t.packedRect+1]*r.height,o[t.packedRect+2]*r.width,o[t.packedRect+3]*r.height),a.attributes.graphicsDevice=this.graphicsDevice,a.attributes.texture=r,a.attributes.border=new pc.Vec4(Math.max(0,o[t.border+0]*r.width-a.attributes.transparency.x),Math.max(0,o[t.border+1]*r.height-a.attributes.transparency.y),Math.max(0,o[t.border+2]*r.width-a.attributes.transparency.z),Math.max(0,o[t.border+3]*r.height-a.attributes.transparency.w)),a.attributes.bounds=o[t.bounds],a.attributes.pixelsPerUnit=o[t.pixelsPerUnit]/s,a.attributes.aabb=o[t.aabb],a.attributes.vertices=o[t.vertices],a.attributes.triangles=o[t.triangles],a.attributes.nativeSize=new pc.Vec2(o[t.nativeSize],o[t.nativeSize+1]),a.attributes.pivot=new pc.Vec2(o[t.pivot+0],o[t.pivot+1]),a.attributes.textureRectOffset=new pc.Vec2(o[t.textureRectOffset+0],o[t.textureRectOffset+1]),this.registry.Put(n.id,a),{result:a}},unloadAsync:function(e){const n=this.registry.Release(e.id);n&&n.mesh&&n.mesh.destroy()}})}),Bridge.assembly("LunaUnity",(e,n)=>{const t=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Textures.Texture2D"],i=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Textures.RenderTexture"],o=[pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_A8,pc.PIXELFORMAT_R4_G4_B4_A4,pc.PIXELFORMAT_R8_G8_B8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R5_G6_B5,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_RGBA32F,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_PVRTC_2BPP_RGBA_1,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8,pc.PIXELFORMAT_R8_G8_B8_A8];Bridge.define("LunaUnity.Objects.Handlers.Texture",{inherits:[LunaUnity.Objects.Handlers.Base],ctor:function(e){this.$initialize(),this.playgroundAssetOverrides=window.playgroundAssetOverrides||{},LunaUnity.Objects.Handlers.Base.ctor.call(this,e)},loadAsync:function(e,n,t){if(0===n.type)return this._loadTexture2dAsync(n);if(1===n.type)return this._loadTexture3dAsync(n);if(2===n.type)return System.Threading.Tasks.Task.fromResult(!0);if(3===n.type)return this._loadRenderTextureAsync(n);throw new Error("Unknown texture type: "+n.type)},_loadRenderTextureAsync:function(e){const n=new UnityEngine.RenderTexture.Create(e.data[i.width],e.data[i.height],16,0);return this.registry.Put(e.id,n.handle),System.Threading.Tasks.Task.fromResult(n.handle)},_loadTexture3dAsync:function(e){throw new Error("NotImplemented")},_getDummyTexture:function(){if(this._dummyTexture)return this._dummyTexture;this._dummyTexture=new pc.Texture(this.app.graphicsDevice,{width:16,height:16,format:pc.PIXELFORMAT_R8_G8_B8_A8});const e=this._dummyTexture.lock();for(let n=0;n<e.length;n+=3)e[n+0]=255,e[n+1]=0,e[n+2]=255,e[n+4]=127;return this._dummyTexture.unlock(),this._dummyTexture},_loadTexture2dAsync:function(e){const n=new System.Threading.Tasks.TaskCompletionSource,i=e.data,r=i[t.filterMode],a=i[t.mipmapCount]>1;let s=a?pc.FILTER_NEAREST_MIPMAP_NEAREST:pc.FILTER_NEAREST,c=pc.FILTER_NEAREST;r===UnityEngine.FilterMode.Bilinear?(s=a?pc.FILTER_LINEAR_MIPMAP_NEAREST:pc.FILTER_LINEAR,c=pc.FILTER_LINEAR):r===UnityEngine.FilterMode.Trilinear&&(s=a?pc.FILTER_LINEAR_MIPMAP_LINEAR:pc.FILTER_LINEAR,c=pc.FILTER_LINEAR);const l=i[t.wrapMode]===UnityEngine.TextureWrapMode.Repeat?pc.ADDRESS_REPEAT:pc.ADDRESS_CLAMP_TO_EDGE,d={name:i[t.name]||"",width:i[t.width],height:i[t.height],addressU:l,addressV:l,mipmaps:a,minFilter:s,magFilter:c,autoMipmap:a,rgbm:!!i[t.hdr],anisotropy:Math.min(this.graphicsDevice.maxAnisotropy,i[t.anisoLevel]),format:o[i[t.format]]};if(e.dummy){const n=this._getDummyTexture();return this.registry.Put(e.id,n),System.Threading.Tasks.Task.fromResult(n)}const u=new pc.Texture(this.app.graphicsDevice,d);return this.registry.Put(e.id,u),this.network.GetImageAsync(this._getTextureUrl(e)).continueWith(Bridge.fn.bind(this,e=>{if(e.status===System.Threading.Tasks.TaskStatus.ranToCompletion){const t=e.result;u.setSource(t),t.remove(),u.mipmaps=d.mipmaps,u.minFilter=d.minFilter,u.magFilter=d.magFilter,u.anisotropy=d.anisotropy,n.setResult(u)}else n.setCanceled()})),n.task},_getTextureUrl:function(e){return"external"===this.network.resourceConfig.image&&e.id in this.playgroundAssetOverrides?this.playgroundAssetOverrides[e.id]:"assets/bundles/"+e.assetBundleId+"/"+e.id+(e.ext||".png")},unloadAsync:function(e){const n=this.registry.Release(e.id);n&&n.destroy()}})}),Bridge.assembly("LunaUnity",(e,n)=>{const t=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Textures.Cubemap"];Bridge.define("LunaUnity.Objects.Handlers.Cubemap",{inherits:[LunaUnity.Objects.Handlers.Base],ctor:function(e){this.$initialize(),LunaUnity.Objects.Handlers.Base.ctor.call(this,e)},loadAsync:function(e,n,t){return 2===n.type?this._loadCubemapAsync(n):System.Threading.Tasks.Task.fromResult(null)},_loadCubemapAsync:function(e){const n=e.data,i=n[t.size],o=n[t.filterMode],r=n[t.mipmapCount]>0;let a=r?pc.FILTER_NEAREST_MIPMAP_NEAREST:pc.FILTER_NEAREST,s=pc.FILTER_NEAREST;o===UnityEngine.FilterMode.Bilinear?(a=r?pc.FILTER_LINEAR_MIPMAP_NEAREST:pc.FILTER_LINEAR,s=pc.FILTER_LINEAR):o===UnityEngine.FilterMode.Trilinear&&(a=r?pc.FILTER_LINEAR_MIPMAP_LINEAR:pc.FILTER_LINEAR,s=pc.FILTER_LINEAR);const c=n[t.wrapMode]===UnityEngine.TextureWrapMode.Repeat?pc.ADDRESS_REPEAT:pc.ADDRESS_CLAMP_TO_EDGE,l=new pc.Texture(this.graphicsDevice,{width:i,height:i,minFilter:a,magFilter:s,addressU:c,addressV:c,anisotropy:Math.min(this.graphicsDevice.maxAnisotropy,n[t.anisoLevel]),cubemap:!0,mipmaps:r,rgbm:!!n[t.hdr],flipY:!0,atlas:this.registry.Get(n[t.atlasId]),rects:n[t.rects]});return l.upload(),this.registry.Put(e.id,l),System.Threading.Tasks.Task.fromResult(l)},unloadAsync:function(e){const n=this.registry.Release(e.id);n&&n.destroy()}})}),Bridge.assembly("LunaUnity",(e,n)=>{Bridge.define("LunaUnity.Objects.Handlers.Resources",{inherits:[LunaUnity.Objects.Handlers.Base],ctor:function(e){this.$initialize(),LunaUnity.Objects.Handlers.Base.ctor.call(this,e)},loadAsync:function(e,n,t){e.deserializeTo(n.data,UnityEngine.Resources,"Luna.Unity.DTO.UnityEngine.Assets.Resources");const i=LunaUnity.Objects.Bundle.handlers.project_settings;return LunaUnity.Objects.Bundle.handlers.prefab_component.load(i.autoInstantiatePrefabs),{}},unloadAsync:function(e){this.registry.Release(e.id)}})}),Bridge.assembly("LunaUnity",(e,n)=>{const t=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Assets.TextAsset"];Bridge.define("LunaUnity.Objects.Handlers.TextAsset",{inherits:[LunaUnity.Objects.Handlers.Base],ctor:function(e){this.$initialize(),LunaUnity.Objects.Handlers.Base.ctor.call(this,e)},loadAsync:function(e,n,i){const o=new UnityEngine.TextAsset;return o.data=n.data[t.data],o.name=n.data[t.name],o.bytes64=n.data[t.bytes64],this.registry.Put(n.id,o),{result:o}},unloadAsync:function(e){this.registry.Release(e.id)}})}),Bridge.assembly("LunaUnity",(e,n)=>{Bridge.define("LunaUnity.Objects.Handlers.ScriptableObject",{inherits:[LunaUnity.Objects.Handlers.Base],ctor:function(e){this.$initialize(),LunaUnity.Objects.Handlers.Base.ctor.call(this,e)},loadAsync:function(e,n,t){try{const t=Deserializers.types[n.class],i=e.d(t,n.data);return i.name=n.name,i?(this.registry.Put(n.id,i),{result:i}):(console.warn("Failed to instantiate ScriptableObject of type "+t),System.Threading.Tasks.Task.fromResult(!0))}catch(e){return console.warn("Cannot put scriptable object with id "+n.id+": "+e),null}},unloadAsync:function(e){this.registry.Release(e.id)}})}),Bridge.assembly("LunaUnity",(e,n)=>{const t=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Animation.Data.AnimationClip"],i=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Animation.Data.AnimationCurve"],o=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Animation.Data.AnimationEvent"];Bridge.define("LunaUnity.Objects.Handlers.AnimationClip",{inherits:[LunaUnity.Objects.Handlers.Base],ctor:function(e){this.$initialize(),LunaUnity.Objects.Handlers.Base.ctor.call(this,e)},loadAsync:function(e,n,r){const a=n.data,s=new UnityEngine.AnimationClip,c=r.find(e=>e.manifest.id===n.assetBundleId).blob;s.name=a[t.name],s.length=a[t.length],s.wrapMode=a[t.wrapMode],s.isLooping=a[t.isLooping];const l=a[t.curves];s.curves=new Array(l.length);for(let n=0;n<l.length;n++){const o=l[n],r=o[i.keys],d=c.slice(r[0],r[0]+r[1]),u=a[t.halfPrecision]?pc.Conversion.fromFloat16ToFloat32(new Uint16Array(d)):new Float32Array(d)||[],y=o[i.objectReferenceKeys]||[],p=new Array(Math.floor(u.length/7)+y.length);for(let e=0;e<u.length;e+=7)p[e/7]=new pc.Keyframe(u[e],u[e+1],u[e+2],u[e+3],u[e+4],u[e+5],u[e+6]);for(let n=0;n<y.length;n++){const t=y[n];p[n+u.length/7]=e.deserializeTo(t,new pc.Keyframe,"Luna.Unity.DTO.UnityEngine.Animation.Data.AnimationCurve+ObjectReferenceKey")}const g={path:o[i.path],componentType:o[i.componentType],property:o[i.property],keyframes:p};s.curves[n]=new pc.AnimationCurve(g),y.length>0&&(s.curves[n].objectCurve=!0)}const d=a[t.events];s.events=new Array(d.length);for(let e=0;e<d.length;e++){const n=d[e],t=new UnityEngine.AnimationEvent;t.functionName=n[o.functionName],t.floatParameter=n[o.floatParameter],t.intParameter=n[o.intParameter],t.stringParameter=n[o.stringParameter],t.time=n[o.time],t.objectReferenceParameter=null,s.events[e]=t}return this.registry.Put(n.id,s),{result:s}},unloadAsync:function(e){this.registry.Release(e.id)}})}),Bridge.assembly("LunaUnity",(e,n)=>{const t=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Animations.BlendTree"],i=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Animations.ChildMotion"];Bridge.define("LunaUnity.Objects.Handlers.BlendTree",{inherits:[LunaUnity.Objects.Handlers.Base],ctor:function(e){this.$initialize(),LunaUnity.Objects.Handlers.Base.ctor.call(this,e)},loadAsync:function(e,n,o){const r=n.data,a=new UnityEditor.Animations.BlendTree;a.name=r[t.name],a.blendParameter=r[t.blendParameter],a.blendParameterY=r[t.blendParameterY],a.blendType=r[t.blendType],a.children=r[t.children],a.useAutomaticThresholds=r[t.useAutomaticThresholds],a.minThreshold=r[t.minThreshold],a.maxThreshold=r[t.maxThreshold];const s=r[t.children];a.children=new Array(s.length);for(let n=0;n<s.length;++n){const t=new UnityEditor.Animations.ChildMotion,o=s[n];e.r(!0,o[i.motion+1],0,t,"motion"),t.position=new pc.Vec2,t.position.x=o[i.position+0],t.position.y=o[i.position+1],t.threshold=o[i.threshold],t.timeScale=o[i.timeScale],t.cycleOffset=o[i.cycleOffset],t.directBlendParameter=o[i.directBlendParameter],t.mirror=o[i.mirror],a.children[n]=t}return this.registry.Put(n.id,a),{result:a}},unloadAsync:function(e){this.registry.Release(e.id)}})}),Bridge.assembly("LunaUnity",(e,n)=>{Bridge.define("LunaUnity.Objects.Handlers.AnimatorController",{inherits:[LunaUnity.Objects.Handlers.Base],ctor:function(e){this.$initialize(),LunaUnity.Objects.Handlers.Base.ctor.call(this,e)},loadAsync:function(e,n,t){const i=e.d("Luna.Unity.DTO.UnityEngine.Animation.Mecanim.AnimatorController",n.data),o=new UnityEditor.Animations.AnimatorController.$ctor1(i,this.registry);return this.registry.Put(n.id,o),{result:o}},unloadAsync:function(e){this.registry.Release(e.id)}})}),Bridge.assembly("LunaUnity",(e,n)=>{const t=Deserializers.fields["Luna.Unity.DTO.UnityEngine.Assets.Font"];Bridge.define("LunaUnity.Objects.Handlers.Font",{inherits:[LunaUnity.Objects.Handlers.Base],ctor:function(e){this.$initialize(),LunaUnity.Objects.Handlers.Base.ctor.call(this,e)},loadAsync:function(e,n,i){const o=n.data,r={name:o[t.name],ascent:o[t.ascent],lineHeight:o[t.lineHeight],fontSize:o[t.fontSize],characterInfo:o[t.characterInfo],texture:this.registry.TryGet(n.data[t.texture+1])},a=new pc.Font(n.font,r);return this.registry.Put(n.id,a),pc.Font.fonts=pc.Font.fonts||{},pc.Font.fonts[n.data[t.name]]=a,pc.Font.fonts[n.data[t.name].replace("-Regular","")]=a,UnityEngine.Font.FontDefault&&"Arial"!==n.data[t.name]||(UnityEngine.Font.FontDefault=new UnityEngine.Font(a)),{result:a}},unloadAsync:function(e){this.registry.Release(e.id)}})}),Bridge.assembly("LunaUnity",(e,n)=>{Bridge.define("LunaUnity.Objects.Handlers.PrefabComponent",{inherits:[LunaUnity.Objects.Handlers.Base],ctor:function(e){this.$initialize(),LunaUnity.Objects.Handlers.Base.ctor.call(this,e)},load:function(e){if(e)return;const n=UnityEngine.Resources.componentToPrefabIds;for(let e=0;e<n.length;e+=2){const t=n[e].toString(),i=n[e+1].toString();this.registry.Put(t,{isPrefabProxy:!0,componentId:t,prefabId:i})}}})}),function(){const e=function(e,n){return this.vector=e,this.offset=n,this};Object.defineProperty(e.prototype,"x",{set:function(e){this.vector.iset(0+this.offset,e)},get:function(){return this.vector.iget(0+this.offset)}}),Object.defineProperty(e.prototype,"y",{set:function(e){this.vector.iset(1+this.offset,e)},get:function(){return this.vector.iget(1+this.offset)}}),Object.defineProperty(UnityEngine.Object.prototype,"m_Enabled",{set:function(e){this.handle.enabled=e>0},get:function(){return this.handle.enabled},configurable:!0}),Object.defineProperty(UnityEngine.UI.RawImage.prototype,"m_Enabled",{set:function(e){this.handle.entity.element._image.enabled=e>0},get:function(){return this.handle.entity.element._image.enabled}}),Object.defineProperty(UnityEngine.UI.Image.prototype,"m_Enabled",{set:function(e){this.handle.entity.element._image.enabled=e>0},get:function(){return this.handle.entity.element._image.enabled}}),Object.defineProperty(UnityEngine.UI.Text.prototype,"m_Enabled",{set:function(e){this.handle.entity.element._text.enabled=e>0},get:function(){return this.handle.entity.element._text.enabled}}),Object.defineProperty(UnityEngine.GameObject.prototype,"m_IsActive",{set:function(e){this.SetActive(e>0)},get:function(){return this.handle._enabled}}),Object.defineProperty(UnityEngine.Transform.prototype,"m_LocalPosition",{get:function(){return this.handle.hijackLocalPosition()}}),Object.defineProperty(UnityEngine.Transform.prototype,"m_LocalScale",{get:function(){return this.handle.hijackLocalScale()}}),Object.defineProperty(UnityEngine.Transform.prototype,"localEulerAnglesRaw",{get:function(){return this.handle.hijackLocalEulerAngles()}}),Object.defineProperty(UnityEngine.Transform.prototype,"m_LocalRotation",{get:function(){return this.handle.hijackLocalRotation()}}),Object.defineProperty(UnityEngine.Light.prototype,"m_Intensity",{set:function(e){this.handle.intensity=e},get:function(){return this.handle.intensity}}),Object.defineProperty(UnityEngine.Light.prototype,"m_Color",{get:function(){return this.handle.light.dirtyColor=!0,this.handle.light._color}}),Object.defineProperty(UnityEngine.RectTransform.prototype,"m_AnchoredPosition",{get:function(){return this.handle.element._dirtyAnimatedAnchoredPosition||this.handle.element._anchoredPositionAnimated.copy(this.handle.element._anchoredPosition),this.handle.element._dirtyAnimatedAnchoredPosition=!0,this.handle.element._anchoredPositionAnimated}}),Object.defineProperty(UnityEngine.RectTransform.prototype,"m_LocalPosition",{get:function(){return this.handle.element._dirtyAnimatedLocalPosition||this.handle.element._localPositionAnimated.copy(this.handle.localPosition),this.handle.element._dirtyAnimatedLocalPosition=!0,this.handle.element._localPositionAnimated}}),Object.defineProperty(UnityEngine.RectTransform.prototype,"m_AnchorMin",{get:function(){return this.handle.element.dirtifyRect(),this._anchorMin=this._anchorMin||new e(this.handle.element._anchors,0),this._anchorMin}}),Object.defineProperty(UnityEngine.RectTransform.prototype,"m_AnchorMax",{get:function(){return this.handle.element.dirtifyRect(),this._anchorMax=this._anchorMax||new e(this.handle.element._anchors,2),this._anchorMax}}),Object.defineProperty(UnityEngine.RectTransform.prototype,"m_SizeDelta",{get:function(){return this.handle.element.dirtifyRect(),this.handle.element._sizeDelta}}),Object.defineProperty(UnityEngine.RectTransform.prototype,"m_Pivot",{get:function(){return this.handle.element.dirtifyRect(),this.handle.element._pivot}})}(),window.System$Collections$Generic$ICollection$1$Function$contains="contains",window.System$Collections$Generic$ICollection$1$Function$getItem="getItem",window.System$Collections$Generic$ICollection$1$Function$setItem="setItem",window.System$Collections$Generic$ICollection$1$Function$removeItem="removeItem",window.System$Collections$Generic$IDictionary$2$Function$Function$add="add",window.System$Collections$Generic$IDictionary$2$Function$Function$containsKey="containsKey",window.System$Collections$Generic$IDictionary$2$Function$Function$getItem="getItem",window.System$Collections$Generic$IDictionary$2$Function$Function$setItem="setItem",window.System$Collections$Generic$IDictionary$2$Function$Function$removeItem="removeItem",window.pcHierarchyViewer={fn:function(e){return pc.Application.getApplication().root.findByName(e)},f:function(e){return pc.Application.getApplication().root.findByGuid(e)},tryGet:function(e){try{return e()}catch(e){return"exception"}},update:function(e,n){const t=document.createElement("div");t.setAttribute("name",e.name),t.setAttribute("id",e._guid),t.setAttribute("lp",this.tryGet(()=>e.getLocalPosition().data)),t.setAttribute("lr",this.tryGet(()=>e.getLocalEulerAngles().data)),t.setAttribute("lrq",this.tryGet(()=>e.getLocalRotation())),t.setAttribute("op",this.tryGet(()=>e.getWorldTransform().transformPoint(new pc.Vec3).data)),t.setAttribute("ls",this.tryGet(()=>e.getLocalScale().data)),t.setAttribute("er",this.tryGet(()=>e.element.rect)),t.setAttribute("a",this.tryGet(()=>e.element.anchor.data)),t.setAttribute("ap",this.tryGet(()=>e.element.anchoredPosition.data)),t.setAttribute("sd",this.tryGet(()=>e.element.sizeDelta.data)),t.setAttribute("enabled",this.tryGet(()=>e.enabled)),e.constructor===pc.Entity?e.element?(t.setAttribute("type","element"),t.setAttribute("w",e.element.width),t.setAttribute("h",e.element.height),e.element._image&&e.element._image.texture&&t.setAttribute("texture-id",e.element._image.texture.$id)):t.setAttribute("type","entity"):t.setAttribute("type","graph-node");for(let n=0;n<e._children.length;n++){const i=e._children[n];this.update(i,t)}n.appendChild(t)},sync:function(){this.root||(this.root=document.createElement("div"),this.root.id="root",this.root.style.display="none",document.body.appendChild(this.root)),this.update(pc.Application.getApplication().root,this.root)}},Bridge.ns=function(e,n){const t=e.split(".");let i=0;if(n||(n=Bridge.global),n===Bridge.global&&(window.$typeCache=window.$typeCache||{},window.$typeCache[e]))return window.$typeCache[e];for(i=0;i<t.length;i++)void 0===n[t[i]]&&(n[t[i]]={}),n=n[t[i]];return n===Bridge.global&&(window.$typeCache[e]=n),n},System.Threading.Tasks.Task.prototype.setSynchronous=function(e){this._synchrounous=e},System.Threading.Tasks.Task.prototype.continueWith=function(e,n){const t=new System.Threading.Tasks.TaskCompletionSource,i=this,o=n?function(){t.setResult(e(i))}:function(){try{t.setResult(e(i))}catch(e){t.setException(System.Exception.create(e))}};return this.isCompleted()?this._synchrounous?o():setTimeout(o,0):this.callbacks.push(o),t.task},window.utf8ArrayToStr=function(){const e=new Array(128),n=String.fromCodePoint||String.fromCharCode,t=[];return"undefined"!=typeof TextEncoder?function(e){return e?new TextDecoder("utf-8").decode(e):""}:function(i){let o,r;const a=i.length;t.length=0;for(let s=0;s<a;)r=i[s++],r<=127?o=r:r<=223?o=(31&r)<<6|63&i[s++]:r<=239?o=(15&r)<<12|(63&i[s++])<<6|63&i[s++]:String.fromCodePoint?o=(7&r)<<18|(63&i[s++])<<12|(63&i[s++])<<6|63&i[s++]:(o=63,s+=3),t.push(e[o]||(e[o]=n(o)));return t.join("")}}(),function(){const e=new Uint32Array(2048),n=new Uint32Array(64),t=new Uint32Array(64),i={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",alegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};e[0]=0;for(let n=1;n<1024;++n){let t=n<<13,i=0;for(;0==(8388608&t);)i-=8388608,t<<=1;t&=-8388609,i+=947912704,e[n]=t|i}for(let n=1024;n<2048;++n)e[n]=939524096+(n-1024<<13);t[0]=0;for(let e=1;e<31;++e)t[e]=e<<23;t[31]=1199570944,t[32]=2147483648;for(let e=33;e<63;++e)t[e]=2147483648+(e-32<<23);t[63]=3347054592,n[0]=0;for(let e=1;e<64;++e)n[e]=32===e?0:1024;const o=function(){};o.fromFloat16ToFloat32=function(i){const o=new Float32Array(i.length),r=new Uint32Array(o.buffer);for(let o=0;o<i.length;o++){const a=i[o],s=a>>10;r[o]=e[n[s]+(1023&a)]+t[s]}return o},o.tryParseHtmlString=function(e,n){if("#"===e[0])return n.fromString(e),!0;let t=e.toLowerCase();return!(!/^[a-z]+$/.test(t)||(t=i[t],!t))&&(n.fromString(t),!0)},pc.Conversion=o}(),Luna.Unity.NativeShare.IsShareAvailable=!!navigator.share,Luna.Unity.NativeShare.Share=function(e,n,t){const i={title:e,text:n,url:t};navigator.share(i)},pc.extend(pc,function(){const e=function(){this.boxProjection=!1,this.cubemap=new pc.Texture(UnityEngine.Graphics.graphicsDevice,{cubemap:!0,rgbm:!1}),this.position=new pc.Vec4,this.min=new pc.Vec4,this.max=new pc.Vec4,this.box={min:new pc.Vec4,max:new pc.Vec4,position:new pc.Vec4}};return pc.extend(e.prototype,{getBox:function(e){return this.box.min.copy(this.min),this.box.max.copy(this.max),this.box.position.copy(this.position),this.boxProjection,this.box}}),{ReflectionProbeData:e}}()),Object.assign(pc,function(){const e=Object.create(null),n=["#FFFFFF","#F0A3FF","#0075DC","#993F00","#4C005C","#191919","#005C31","#2BCE48","#FFCC99","#808080","#94FFB5","#8F7C00","#9DCC00","#C20088","#003380","#FFA405","#FFA8BB","#426600","#FF0010","#5EF1F2","#00998F","#E0FF66","#740AFF","#990000","#FFFF80","#FFFF00","#FF5005"];let t=0,i={},o={},r={};function a(e){return n[e%n.length]}function s(e){return void 0===e.z?new pc.Vec3(e.x,e.y,e.z):e}function c(e,n){const t=pc.Application.getApplication().getMainCamera().worldToScreen(e);return new pc.Vec2(t.x,n.canvas.height/window.devicePixelRatio-t.y)}function l(e){const n=document.getElementById("application-canvas");return e.setAttribute("width",n.getAttribute("width")),e.setAttribute("height",n.getAttribute("height")),e}function d(){const e=document.getElementById("debug-canvas");return e?l(e).getContext("2d"):function(){const e=document.createElement("canvas");e.id="debug-canvas",e.style.position="absolute",e.style.top="0",document.body.appendChild(e);const n=()=>{l(e),y(),window.requestAnimationFrame(n)};return window.requestAnimationFrame(n),l(e)}().getContext("2d")}function u(e,n){const[t,i,o]=e,r=c(s(t),n),a=c(s(i),n);n.beginPath(),n.moveTo(r.x,r.y),n.lineTo(a.x,a.y),n.strokeStyle=o,n.stroke()}function y(){const e=d();Object.values(i).forEach(n=>u(n,e)),Object.values(o).forEach(n=>(function(e,n){const[t,i]=e,o=s(t.min),r=s(t.max);u([o,new pc.Vec3(r.x,o.y,o.z),i],n),u([new pc.Vec3(o.x,r.y,o.z),new pc.Vec3(r.x,r.y,o.z),i],n),u([o,new pc.Vec3(o.x,r.y,o.z),i],n),u([new pc.Vec3(r.x,o.y,o.z),new pc.Vec3(r.x,r.y,o.z),i],n),u([o,new pc.Vec3(o.x,o.y,r.z),i],n),u([new pc.Vec3(o.x,r.y,o.z),new pc.Vec3(o.x,r.y,r.z),i],n),u([new pc.Vec3(o.x,o.y,r.z),new pc.Vec3(o.x,r.y,r.z),i],n),u([r,new pc.Vec3(o.x,r.y,r.z),i],n),u([r,new pc.Vec3(r.x,o.y,r.z),i],n),u([r,new pc.Vec3(r.x,r.y,o.z),i],n),u([new pc.Vec3(r.x,o.y,r.z),new pc.Vec3(r.x,o.y,o.z),i],n),u([new pc.Vec3(r.x,o.y,r.z),new pc.Vec3(o.x,o.y,r.z),i],n)})(n,e)),Object.values(r).forEach(n=>(function(e,n,t=!1){const[i,o]=e,r=i._component._body;if(!r)return;const l=r.shape.getChildWithShape(i.uid);if(!l)return void console.warn("Orphan shape");const d=pc.Application.getApplication().getMainCamera()["__UnityEngine.Camera"].transform.forward,y=new Goblin.Vector3;y.set(d.x,d.y,d.z),y.normalize();for(let e=0;e<i.faces.length;e++){const d=i.faces[e],p=[];let g=d.edge;const h=new Goblin.Vector3;if(h.copy(d.normal),l.transform.rotateVector3(h),r.transform.rotateVector3(h),h.normalize(),!(h.dot(y)>.5)){do{const e=new Goblin.Vector3;e.copy(g.getTail().position),l.transform.transformVector3(e),r.transform.transformVector3(e),p.push(e),g=g.next}while(g!==d.edge);if(t){n.beginPath();const t=c(s(p[0]),n);n.moveTo(t.x,t.y);for(let e=1;e<p.length;e++){const t=c(s(p[e]),n);n.lineTo(t.x,t.y)}n.closePath(),n.fillStyle=o||a(e),n.fill()}else for(let t=0;t<p.length;t++){u([p[t],t===p.length-1?p[0]:p[t+1],o||a(e)],n)}}}})(n,e,!0))}return e.addLine=function(e,n="green",o="green"){const r=[Array.isArray(e)?e[0]:e,Array.isArray(e)?e[1]:n,"string"==typeof n?n:o],a=t++;return i[a]=r,y(),a},e.removeLine=function(e){delete i[e]},e.addAABB=function(e,n="green"){const i=void 0===e.min?{min:e[0],max:e[1]}:e,r=t++;return o[r]=[i,n],y(),r},e.removeAABB=function(e){delete o[e]},e.addGoblinConvexHull=function(e,n=null){const i=t++;return r[i]=[e,n],y(),i},e.removeGoblinConvexHull=function(e){delete r[e]},e.clear=function(){i={},o={},r={}},{debugDraw:e}}()),Luna.Unity.Playable.GetPreferredLanguage=function(){return navigator.language},Luna.Unity.Playable.GetPreferredLanguages=function(){return navigator.languages},UnityEngine.Application.systemLanguage=getLanguage(UnityEngine.SystemLanguage),UnityEngine.Mathf.Max=Math.max,UnityEngine.Mathf.Min=Math.min,pc.ScreenComponent.prototype.unityClass=UnityEngine.Canvas,pc.CanvasRendererComponent.prototype.unityClass=UnityEngine.CanvasRenderer,pc.CameraComponent.prototype.unityClass=UnityEngine.Camera,pc.LightComponent.prototype.unityClass=UnityEngine.Light,pc.AnimationComponent.prototype.unityClass=UnityEngine.Animation,pc.AnimatorComponent.prototype.unityClass=UnityEngine.Animator,pc.VideoPlayerComponent.prototype.unityClass=UnityEngine.Video.VideoPlayer,pc.ReflectionProbeComponent.prototype.unityClass=UnityEngine.ReflectionProbe,pc.ParticleSystemComponent.prototype.unityClass=UnityEngine.ParticleSystem,pc.ParticleSystemRendererComponent.prototype.unityClass=UnityEngine.ParticleSystemRenderer,pc.AudioSourceUnityComponent.prototype.unityClass=UnityEngine.AudioSource,pc.MeshFilterComponent.prototype.unityClass=UnityEngine.MeshFilter,pc.Rigidbody2DComponent.prototype.unityClass=UnityEngine.Rigidbody2D,pc.SpringJoint2DComponent.prototype.unityClass=UnityEngine.SpringJoint2D,pc.DistanceJoint2DComponent.prototype.unityClass=UnityEngine.DistanceJoint2D,pc.FixedJoint2DComponent.prototype.unityClass=UnityEngine.FixedJoint2D,pc.HingeJoint2DComponent.prototype.unityClass=UnityEngine.HingeJoint2D,pc.WheelJoint2DComponent.prototype.unityClass=UnityEngine.WheelJoint2D,pc.FrictionJoint2DComponent.prototype.unityClass=UnityEngine.FrictionJoint2D,pc.RelativeJoint2DComponent.prototype.unityClass=UnityEngine.RelativeJoint2D,pc.SliderJoint2DComponent.prototype.unityClass=UnityEngine.SliderJoint2D,pc.TargetJoint2DComponent.prototype.unityClass=UnityEngine.TargetJoint2D,pc.BoxCollider2DComponent.prototype.unityClass=UnityEngine.BoxCollider2D,pc.CircleCollider2DComponent.prototype.unityClass=UnityEngine.CircleCollider2D,pc.CapsuleCollider2DComponent.prototype.unityClass=UnityEngine.CapsuleCollider2D,pc.EdgeCollider2DComponent.prototype.unityClass=UnityEngine.EdgeCollider2D,pc.PolygonCollider2DComponent.prototype.unityClass=UnityEngine.PolygonCollider2D,pc.PlatformEffector2DComponent.prototype.unityClass=UnityEngine.PolygonCollider2D,pc.RigidbodyComponent.prototype.unityClass=UnityEngine.Rigidbody,pc.BoxColliderComponent.prototype.unityClass=UnityEngine.BoxCollider,pc.SphereColliderComponent.prototype.unityClass=UnityEngine.SphereCollider,pc.MeshColliderComponent.prototype.unityClass=UnityEngine.MeshCollider,pc.CapsuleColliderComponent.prototype.unityClass=UnityEngine.CapsuleCollider,pc.WheelColliderComponent.prototype.unityClass=UnityEngine.WheelCollider,pc.CharacterControllerComponent.prototype.unityClass=UnityEngine.CharacterController;