!function(t){const e=pc.noise={};function i(t,e,i){this.x=t,this.y=e,this.z=i}i.prototype.dot2=function(t,e){return this.x*t+this.y*e},i.prototype.dot3=function(t,e,i){return this.x*t+this.y*e+this.z*i};const n=[new i(1,1,0),new i(-1,1,0),new i(1,-1,0),new i(-1,-1,0),new i(1,0,1),new i(-1,0,1),new i(1,0,-1),new i(-1,0,-1),new i(0,1,1),new i(0,-1,1),new i(0,1,-1),new i(0,-1,-1)],s=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],r=new Array(512),o=new Array(512);e.seed=function(t){t>0&&t<1&&(t*=65536),(t=Math.floor(t))<256&&(t|=t<<8);for(let e=0;e<256;e++){let i;i=1&e?s[e]^255&t:s[e]^t>>8&255,r[e]=r[e+256]=i,o[e]=o[e+256]=n[i%12]}},e.seed(0);const a=.5*(Math.sqrt(3)-1),u=(3-Math.sqrt(3))/6;function c(t){return t*t*t*(t*(6*t-15)+10)}function h(t,e,i){return(1-i)*t+i*e}e.simplex2=function(t,e){let i,n,s;const c=(t+e)*a;let h=Math.floor(t+c),l=Math.floor(e+c);const p=(h+l)*u,d=t-h+p,f=e-l+p;let y,m;d>f?(y=1,m=0):(y=0,m=1);const _=d-y+u,g=f-m+u,A=d-1+2*u,E=f-1+2*u;h&=255,l&=255;const b=o[h+r[l]],S=o[h+y+r[l+m]],M=o[h+1+r[l+1]];let C=.5-d*d-f*f;C<0?i=0:(C*=C,i=C*C*b.dot2(d,f));let x=.5-_*_-g*g;x<0?n=0:(x*=x,n=x*x*S.dot2(_,g));let O=.5-A*A-E*E;return O<0?s=0:(O*=O,s=O*O*M.dot2(A,E)),70*(i+n+s)},e.perlin2=function(t,e){let i=Math.floor(t),n=Math.floor(e);t-=i,e-=n,i&=255,n&=255;const s=o[i+r[n]].dot2(t,e),a=o[i+r[n+1]].dot2(t,e-1),u=o[i+1+r[n]].dot2(t-1,e),l=o[i+1+r[n+1]].dot2(t-1,e-1),p=c(t);return h(h(s,u,p),h(a,l,p),c(e))}}(),pc.extend(pc,function(){const t=new Set,e=3,i={x:0,y:1,z:2,w:3},n=0,s=1,r=2,o=3,a={r:0,g:1,b:2,a:3},u=function(t,e){this.id=t.keyId,this.curve=t,this.value=null,this._value=null,this.target=e,this.idx=null,this.interoplateType=n};u.prototype={set:function(t){this.dirty=this.dirty||t!==this._value||this.curve.targetsLocalEulerAnglesRaw,this._value=t,this.value=t}};const c=function(){this.keys={},this.keyArray=[],this.eventsMemo={},this.events=[],this.aQuat=new pc.Quat,this.bQuat=new pc.Quat,this.resultQuat=new pc.Quat,this.copiedFrom={},this.id=pc.guid.create()};c.prototype={putKey:function(t){this.keys[t.id]=t,this.keyArray.push(t)},pushEvent:function(t){t.id=t.id||pc.guid.create(),this.eventsMemo[t.id]||(this.eventsMemo[t.id]=!0,this.events.push(t))},popEvents:function(){const t=this.events;return this.events=[],t},recycleEvents:function(){let t=-1;for(let e=0;e<this.events.length;e++)t=Math.max(t,this.events.time);return this.events=[],this.eventsMemo={},t},copyKeysFromSampler:function(t){for(let e=0;e<t.keyArray.length;e++){const i=t.keyArray[e];this.keys[i.id]||this.putKey(new u(i.curve,i.target))}this.copiedFrom[t.id]=!0,this.targetObjectsSet=!1},blendSamplers:function(t,e,i,a){this.copiedFrom[t.id]||this.copyKeysFromSampler(t),this.copiedFrom[i.id]||this.copyKeysFromSampler(i);const u=a/(e+a);if(!Number.isNaN(u))for(let e=0;e<this.keyArray.length;e++){const a=this.keyArray[e];if(t.keys[a.id])if(i.keys[a.id])switch(a.interoplateType===n&&(a.interoplateType=a.curve.figureInterpolateType(a.curve,a)),a.interoplateType){case s:{const n=this.keyArray[e+0],s=this.keyArray[e+1],r=this.keyArray[e+2],o=this.keyArray[e+3];null==this.aQuat?this.resultQuat=this.bQuat:null==this.bQuat?this.resultQuat=this.aQuat:(this.aQuat.x=t.keys[n.id].value,this.aQuat.y=t.keys[s.id].value,this.aQuat.z=t.keys[r.id].value,this.aQuat.w=t.keys[o.id].value,this.bQuat.x=i.keys[n.id].value,this.bQuat.y=i.keys[s.id].value,this.bQuat.z=i.keys[r.id].value,this.bQuat.w=i.keys[o.id].value,this.resultQuat=this.resultQuat.slerp(this.aQuat,this.bQuat,u)),n.set(this.resultQuat.x),s.set(this.resultQuat.y),r.set(this.resultQuat.z),o.set(this.resultQuat.w),e+=3}break;case o:a.set(t.keys[a.id].value);break;case r:{let e=(1-u)*t.keys[a.id].value+u*i.keys[a.id].value;Object.is(e,-0)&&(e=0),a.set(e)}break;case n:console.log("Undefined")}else a.set(t.keys[a.id].value);else a.set(i.keys[a.id].value)}},ensureTargetObjects:function(t){t.__defaults__=t.__defaults__||{};for(let e=0;e<this.keyArray.length;e++){const i=this.keyArray[e];if(i.target||(i.target=i.curve.findTargetObject(t.handle),i.interoplateType=i.curve.figureInterpolateType(i.curve,i)),i.target&&!t.__defaults__.hasOwnProperty(i.id)){const e=new u(i.curve,i.target);if(i.curve.targetObject){if(!i.target[i.curve.targetObject])continue;i.curve.isMaterialPropertyCurve?this.setMaterialProperty(e,i):this.setObjectProperty(e,i)}else e.value=i.target[i.curve.targetProperty];t.__defaults__[e.id]=e}}this.targetObjectsSet=!0},setMaterialProperty:function(t,e){const i=e.target[e.curve.targetObject],n=e.curve.targetProperty,s=i.handle.parameters[n].data;e.curve.isVectorProperty?t.value=s[e.curve.vectorPropertyIndex]:t.value=s},setObjectProperty:function(t,e){t.value=e.target[e.curve.targetObject][e.curve.targetProperty]},applyKey:function(t){if(!t.target)return;let e=t.target[t.curve.targetObject];if(!e)return void(t.target[t.curve.targetProperty]=t.value);const i=t.curve.targetProperty;t.curve.isMaterialPropertyCurve?(e=t.target[t.curve.targetObject].handle.parameters,t.curve.isVectorProperty?(e[i].data[t.curve.vectorPropertyIndex]=t.value,e[i].scopeId&&e[i].scopeId.versionObject.increment()):e[i].data=t.value):e[t.curve.targetProperty]=t.value},writeDefaults:function(t){if(t.__defaults__)for(const e in t.__defaults__){const i=t.__defaults__[e];this.applyKey(i);const n=i.target;n.OnDidApplyAnimationProperties&&n.OnDidApplyAnimationProperties(),n.entity&&n.entity.releaseHijackedProperties()}},apply:function(e){this.targetObjectsSet||this.ensureTargetObjects(e),t.clear();for(let e=0;e<this.keyArray.length;e++){const i=this.keyArray[e];i.dirty&&(i.dirty=!1,i.target&&i.curve.targetObject&&!i.target[i.curve.targetObject]||(i.target&&(i.target.OnDidApplyAnimationProperties||i.target.entity)&&t.add(i.target),this.applyKey(i)))}for(const e of t)e.OnDidApplyAnimationProperties&&e.OnDidApplyAnimationProperties(),e.entity&&e.entity.releaseHijackedProperties()}};const h=function(t,i,n,s,r,o,a){return this.time=t,this.value=i,this.inTangent=n,this.outTangent=s,this.leftConstant=o===e||7===r||71===r||103===r,this.rightConstant=a===e||97===r||101===r||103===r,this},l=function(t){this.id=pc.guid.create(),this.path=t.path,this.componentType=t.componentType,this.property=t.property,this.targetsLocalEulerAnglesRaw=!1,this.componentType&&0!==this.componentType.indexOf("UnityEngine.")&&(this.property=this.property.substring(0,1).toLowerCase()+this.property.substring(1));const e=this.property?this.property.split("."):[];if(this.property&&e.length>1?(this.targetObject=e[0],this.targetProperty=e[1],"localEulerAnglesRaw"===this.targetObject&&(this.targetsLocalEulerAnglesRaw=!0)):(this.targetProperty=this.property,this.targetObject=null),this.keyId=this.path+":"+this.componentType+"."+this.property,this.componentType){this.isMaterialPropertyCurve=this.componentType.indexOf("Renderer")>=0&&"material"===this.targetObject;const t=this.property.split(".");this.isVectorProperty=t.length>2,this.isVectorProperty?(this.vectorPropertyIndex=a[t[t.length-1]],void 0===this.vectorPropertyIndex&&(this.vectorPropertyIndex=i[t[t.length-1]])):this.vectorPropertyIndex=null}if(t.keyframes)this.keys=t.keyframes;else if(t.keys_flow){const e=t.keys_flow;this.keys=[];for(let t=0;t<e.length;t+=7)this.keys.push(new h(e[t],e[t+1],e[t+2],e[t+3],e[t+4],e[t+5],e[t+6]))}else{if(this.keys=[],t.keys)for(let e=0;e<t.keys.length;e++){const i=t.keys[e];this.keys.push(new h(i[0],i[1],i[2],i[3],i[4],i[5],i[6]))}if(t.objectReferenceKeys)for(let e=0;e<t.objectReferenceKeys.length;e++){const i=t.objectReferenceKeys[e];this.keys.push(new h(i[0],i[1],i[2],i[3],i[4],i[5],i[6]))}this.objectCurve=!!t.objectReferenceKeys}};l.createLinear=function(t,e,i,n){return new l({keys:[[t,e,0,0],[i,n,0,0]]})},l.createEaseInOut=function(t,e,i,n){return new l(t===i?{keys:[[t,e,0,0]]}:{keys:[[t,e,0,0],[i,n,0,0]]})},pc.extend(l.prototype,{setValue:function(t,e){0!==this.keys.length&&(t>=this.keys.length?this.keys[this.keys.length-1].value=e:this.keys[t].value=e)},getValue:function(t){return 0===this.keys.length?-1:t>=this.keys.length?this.keys[this.keys.length-1].value:this.keys[t].value},findTargetObject:function(t){const e=this.path.split("/");for(let i=0;i<e.length&&null!=t;i++)e[i].length>0&&(t=t.findByNameImmediate(e[i]));if(null==t)return null;if("UnityEngine.GameObject"===this.componentType)return UnityEngine.Object.FromHandle(UnityEngine.GameObject,t);const i=Bridge._getTypeByName(this.componentType);return UnityEngine.Object.FromHandle(UnityEngine.GameObject,t).GetComponent(i)},figureInterpolateType:function(t,e){const i=e.curve.targetObject;return e.target&&null!=e.target[i]&&e.target[i].constructor===pc.Quat||"m_LocalRotation"===i?s:t.objectCurve?o:r},findKeyIndexAt:function(t){if(t<=this.keys[0].time)return 0;if(t>=this.keys[this.keys.length-1].time)return this.keys.length-2;for(let e=0;e<this.keys.length-1;e++)if(this.keys[e+1].time-t>1e-5)return e;return-1},sample:function(t,e){let i=t.keys[this.keyId];i||(i=new u(this,void 0),t.putKey(i)),i.set(this.value(e,i))},value:function(t,e){if(0===this.keys.length)return 0;if(1===this.keys.length)return this.keys[0].value;if(this.keys[this.keys.length-1].time-t<=1e-5)return e&&(e.idx=0),this.keys[this.keys.length-1].value;let i=null,n=null;if(2===this.keys.length)i=this.keys[0],n=this.keys[1];else{e&&null!=e.idx&&(i=this.keys[e.idx],n=this.keys[e.idx+1],(i.time>t||n.time<t)&&(e.idx=null));let s=null;e?(null==e.idx&&(e.idx=this.findKeyIndexAt(t)),s=e.idx):s=this.findKeyIndexAt(t),i=this.keys[s],n=this.keys[s+1]}if(n.time-t<=1e-5)return e&&this.keys.length>e.idx&&e.idx++,n.value;if(null==i.outTangent||null==n.inTangent||t<i.time)return i.value;if(t>=n.time)return n.value;if(i.rightConstant||n.leftConstant||i.outTangent===1/0||n.inTangent===1/0)return i.value;const s=n.time-i.time,r=(t-i.time)/s;if(this.objectCurve)return r<n.value?i.value:n.value;const o=i.outTangent*s,a=n.inTangent*s,u=r*r,c=u*r,h=c-2*u+r,l=c-u,p=-2*c+3*u;return(2*c-3*u+1)*i.value+h*o+l*a+p*n.value},quantize:function(t){t=Math.max(t,2);const e=new Float32Array(t),i=1/(t-1);for(let n=0;n<t;n++){const t=this.value(i*n);e[n]=t}return e},clone:function(){const t=new pc.AnimationCurve({path:this.path,componentType:this.componentType,property:this.property,keyframes:[]});return t.keys=pc.extend(t.keys,this.keys),t},_keysAt:function(t){if(1===this.keys.length)return this.keys;if(t>=this.keys[this.keys.length-1].time)return[this.keys[this.keys.length-1]];if(t<=this.keys[0].time)return[this.keys[0]];for(let e=0;e<this.keys.length;e++)if(this.keys[e].time>t)return[this.keys[e-1],this.keys[e]];return null}});const p=function(t,e,i,n,s){return this.curve1=t,this.curve2=e,this.a=i,this.b=n,this.c=s,this};pc.extend(p.prototype,{value:function(t){return null==this.curve1&&null==this.curve2?this.c:null==this.curve2?this.curve1.value(t)*this.a+this.c:null==this.curve1?this.curve2.value(t)*this.b+this.c:this.curve1.value(t)*this.a+this.curve2.value(t)*this.b+this.c},clone:function(){return new pc.AnimationCurveBlend(this.curve1,this.curve2,this.a,this.b,this.c)},quantize:function(t){t=Math.max(t,2);const e=new Float32Array(t),i=1/(t-1);for(let n=0;n<t;n++){const t=this.value(i*n);e[n]=t}return e}});const d=function(t,e,i,n,s){return this.curve1=t,this.curve2=e,this.a=i,this.b=n,this.c=s,this};return pc.extend(d.prototype,{value:function(t){return null==this.curve1&&null==this.curve2?this.c:null==this.curve2?this.curve1.value(t)*this.a+this.c:null==this.curve1?this.curve2.value(t)*this.b+this.c:this.curve1.value(t)*this.a*this.curve2.value(t)*this.b+this.c},clone:function(){return new pc.AnimationCurveMultipliedBlend(this.curve1,this.curve2,this.a,this.b,this.c)},quantize:function(t){t=Math.max(t,2);const e=new Float32Array(t),i=1/(t-1);for(let n=0;n<t;n++){const t=this.value(i*n);e[n]=t}return e}}),{AnimationCurve:l,AnimationCurveBlend:p,AnimationCurveMultipliedBlend:d,Keyframe:h,CurveSampler:c}}()),pc.extend(pc,function(){const t=["ALWAYS","FORWARDBASE","FORWARDADD","SHADOWCASTER","GRABPASS","Vertex","VertexLM"],e=["Background","Opaque","Transparent"],i=["zTest","zWrite","culling","blending","alphaBlending","colorWriteMask","offsetUnits","offsetFactor","stencilRef","stencilReadMask","stencilWriteMask","stencilOp","stencilOpFront","stencilOpBack"],n={vertex_position:pc.SEMANTIC_POSITION,vertex_normal:pc.SEMANTIC_NORMAL,vertex_tangent:pc.SEMANTIC_TANGENT,vertex_texCoord0:pc.SEMANTIC_TEXCOORD0,vertex_texCoord1:pc.SEMANTIC_TEXCOORD1,vertex_color:pc.SEMANTIC_COLOR,vertex_boneWeights:pc.SEMANTIC_BLENDWEIGHT,vertex_boneIndices:pc.SEMANTIC_BLENDINDICES,instancing_translation:pc.SEMANTIC_TEXCOORD5,instancing_rotation:pc.SEMANTIC_TEXCOORD6,instancing_scale:pc.SEMANTIC_TEXCOORD7,instancing_color:pc.SEMANTIC_ATTR0,instancing_st:pc.SEMANTIC_ATTR1,_glesVertex:pc.SEMANTIC_POSITION,_glesNormal:pc.SEMANTIC_NORMAL,_glesTangent:pc.SEMANTIC_TANGENT,_glesMultiTexCoord0:pc.SEMANTIC_TEXCOORD0,_glesMultiTexCoord1:pc.SEMANTIC_TEXCOORD1,_glesMultiTexCoord2:pc.SEMANTIC_TEXCOORD2,_glesMultiTexCoord3:pc.SEMANTIC_TEXCOORD3,_glesColor:pc.SEMANTIC_COLOR,_glesTANGENT:pc.SEMANTIC_TANGENT,in_POSITION0:pc.SEMANTIC_POSITION,in_NORMAL0:pc.SEMANTIC_NORMAL,in_TANGENT0:pc.SEMANTIC_TANGENT,in_TEXCOORD0:pc.SEMANTIC_TEXCOORD0,in_TEXCOORD1:pc.SEMANTIC_TEXCOORD1,in_TEXCOORD2:pc.SEMANTIC_TEXCOORD2,in_TEXCOORD3:pc.SEMANTIC_TEXCOORD3,in_COLOR0:pc.SEMANTIC_COLOR,_patched_POSITION:pc.SEMANTIC_POSITION,_patched_COLOR:pc.SEMANTIC_COLOR,_patched_NORMAL:pc.SEMANTIC_NORMAL,_patched_TANGENT:pc.SEMANTIC_TANGENT,_patched_TEXCOORD0:pc.SEMANTIC_TEXCOORD0},s=new pc.KeywordSet,r=function(t,e,i,n,s){this.graphicsDevice=t,this.keywords=new pc.KeywordSet,this.shader=null,this._particlesShader=null,this._skinnedShader=null,this._sourceShader=s,this.setupKeywords(e),this.setupShader(i,n)};pc.extend(r.prototype,{getShader:function(t){let e;return e=t&pc.SHADERDEF_PARTICLES_INSTANCING?this.getParticlesShader():t&pc.SHADERDEF_SKIN?this.getSkinnedShader():this.shader,e},applyMissingShader:function(t){let e;e=t&pc.SHADERDEF_PARTICLES_INSTANCING?"_particlesShader":t&pc.SHADERDEF_SKIN?"_skinnedShader":"shader";const i=pc._createMissingShader(this._sourceShader.name,this._sourceShader.$id);return this[e]=i,i},getParticlesShader:function(){return null===this._particlesShader&&(this._particlesShader=new pc.Shader(this.graphicsDevice,{attributes:n,vshader:pc.ShaderPatches.patchParticlesVertexShader(this.shader.definition.vshader,n),fshader:this.shader.definition.fshader})),this._particlesShader},getSkinnedShader:function(){return null===this._skinnedShader&&(this._skinnedShader=new pc.Shader(this.graphicsDevice,{attributes:n,vshader:pc.ShaderPatches.patchSkinningVertexShader(this.shader.definition.vshader,n),fshader:this.shader.definition.fshader})),this._skinnedShader},setupKeywords:function(t){this.keywords.setEnabledKeywords(t)},setupShader:function(t,e){2===UnityEngine.LightmapSettings.lightmapEncodingQuality&&(e=pc.ShaderPatches.patchTexture2DLightmap(e)),this.shader=new pc.Shader(this.graphicsDevice,{attributes:n,vshader:t,fshader:e})}});const o=function(){this.lightMode=0,this.renderType=1,this.grabPassTextureName=null,this.graphicsDevice=null,this.shaders=[],this.boundParameters=[],this.sourceShader=null,this.passType=null,this.zTest=null,this.zWrite=null,this.culling=null,this.blending=null,this.alphaBlending=null,this.colorWriteMask=null,this.offsetUnits=null,this.offsetFactor=null,this.stencilRef=null,this.stencilReadMask=null,this.stencilWriteMask=null,this.stencilOp=null,this.stencilOpFrontstencilOpBack=null,this.tags=null,this.variants=null};pc.extend(o.prototype,{setupTags:function(){for(let t=0;t<this.tags.length;t++){const e=this.tags[t];"LIGHTMODE"===e.name&&("FORWARDBASE"===e.value&&(this.lightMode=1),"FORWARDADD"===e.value&&(this.lightMode=2),"SHADOWCASTER"===e.value&&(this.lightMode=3),"Vertex"===e.value&&(this.lightMode=5),"VertexLM"===e.value&&(this.lightMode=6)),"GRABPASS"===e.name&&(this.lightMode=4),"GRABPASS_TEXTURE_NAME"===e.name&&(this.grabPassTextureName=e.value),"RENDERTYPE"===e.name&&"Background"===e.value&&(this.renderType=0)}},getVariant:function(t){let e=null;for(let i=0;i<this.variants.length;i++){const n=this.variants[i];pc.KeywordSet.intersection(t,n.keywords,s),s.cardinality===n.keywords.cardinality&&(null===e||e.keywords.cardinality<s.cardinality)&&(e=n)}return e},setupVariants:function(){const t=new Array(this.variants.length);for(let e=0;e<this.variants.length;e++){const i=this.variants[e],n=ShaderProgramsLibrary[i.vertexProgram],s=ShaderProgramsLibrary[i.fragmentProgram];t[e]=new r(this.graphicsDevice,i.keywords,n,s,this.sourceShader)}this.variants=t},updateRenderState:function(t){for(let e=0;e<this.boundParameters.length;e++){const i=t.parameters[this.boundParameters[e].name];i&&i.data?this.boundParameters[e].val=i.data:this.boundParameters[e].val=0}},setupRenderSettings:function(){for(let t=0;t<i.length;t++)this._collectBoundParameters(this[i[t]],this.boundParameters)},_collectBoundParameters:function(t,e){if(t)if("Luna.Unity.DTO.UnityEngine.Assets.Shader.Pass+Value"===t.$$fullname&&t.name)e.push(t);else for(const i in t){if(!t.hasOwnProperty(i))continue;const n=t[i];n&&n.$$fullname&&this._collectBoundParameters(n,e)}},applyMissingVariant:function(t){const e=pc.Application.getApplication().graphicsDevice,i=pc._createMissingShader(this.sourceShader.name,this.sourceShader.$id),n=new r(e,t,i.definition.vshader,i.definition.fshader,this.sourceShader);return n.shader=i,this.variants.push(n),n}});const a=function(t){this.graphicsDevice=t,this.name=null,this.passes=[],this.defaultParameterValues=[],this.defaultParameters={},this.lightModes=[[],[],[],[],[],[],[]],this.supportedKeywords=new pc.KeywordSet};a.globalKeywords=new pc.KeywordSet,a.globalUniforms={};const u=function(){this.value=null,this.scopeId=null};return a.setGlobalUniform=function(t,e){this.globalUniforms[t]=this.globalUniforms[t]||new u,this.globalUniforms[t].value=e},a.enableKeyword=function(t){this.globalKeywords.enableKeyword(t)},a.disableKeyword=function(t){this.globalKeywords.disableKeyword(t)},a.getEnabledKeywords=function(){return this.globalKeywords.getEnabledKeywords()},pc.extend(a.prototype,{setup:function(){this.setupPasses(),this.setupDefaultParameters()},setupPasses:function(){for(let t=0;t<this.passes.length;t++){const e=this.passes[t];e.graphicsDevice=this.graphicsDevice,e.sourceShader=this,e.setupTags(),e.setupVariants(),e.setupRenderSettings(),this.lightModes[e.lightMode].push(e);for(let t=0;t<e.variants.length;t++){const i=e.variants[t];this.supportedKeywords.merge(i.keywords)}}},setupDefaultParameters:function(){this.defaultParameterNames={};for(let t=0;t<this.defaultParameterValues.length;t++){const e=this.defaultParameterValues[t];switch(this.defaultParameterNames[e.name]=!0,e.type){case Luna.Unity.DTO.UnityEngine.Assets.Shader.ShaderParameterType.Vector:case Luna.Unity.DTO.UnityEngine.Assets.Shader.ShaderParameterType.Color:this.defaultParameters[e.name]=e.value.data;break;case Luna.Unity.DTO.UnityEngine.Assets.Shader.ShaderParameterType.Scalar:this.defaultParameters[e.name]=e.value.x;break;case Luna.Unity.DTO.UnityEngine.Assets.Shader.ShaderParameterType.Texture:{const t=UnityEngine.Texture2D[e.textureValue+"Texture"];this.defaultParameters[e.name]=t?t.handle:null;break}}}},supportsKeyword:function(t){return this.supportedKeywords.isKeywordEnabled(t)}}),{UnityShader:a,UnityShaderPass:o,LIGHT_MODE_NAMES:t,SHADER_PASS_ALWAYS:0,SHADER_PASS_FORWARD_BASE:1,SHADER_PASS_FORWARD_ADD:2,SHADER_PASS_SHADOW_CASTER:3,SHADER_PASS_GRAB_PASS:4,SHADER_PASS_VERTEX:5,SHADER_PASS_VERTEX_LM:6,RENDER_TYPE_BACKGROUND:0,RENDER_TYPE_OPAQUE:1,RENDER_TYPE_TRANSPARENT:2,RENDER_TYPE_NAMES:e}}()),pc.extend(pc,function(){const t=function(){pc.Material.prototype.constructor.apply(this),this.keywords=new pc.KeywordSet,this.drawOrder=0,this.renderQueue=0,this.enableInstancing=!1};return pc.extend(t.prototype,{getPass:function(t,e){if((e=e||[]).length=0,!this._shader)return e;for(let i=0;i<this._shader.passes.length;i++){const n=this._shader.passes[i];n.lightMode===t&&e.push(n)}return e},setPass:function(t){if(!this._shader)return void console.log("Missing shader.");const e=this._shader.passes.length;if(t<0||t>e)return void console.log("Shader pass out of range setup attempt.");const i=this._shader.passes[t];UnityEngine.GL.SetPassMaterial=this["__UnityEngine.Material"],pc.Application.getApplication().renderer.setPass(this,i)},setParametersFromShaderDefaults:function(){if(!this.shader)return;const t=this.shader.defaultParameters;for(const e in t)this.setParameter(e,this.cloneParameterData(t[e])),t[e]instanceof pc.Texture&&this.setParameter(e+"_ST",this.cloneParameterData([1,1,0,0]))},setup:function(){for(let t=0;t<this.floatParameters.length;t++)this.setParameter(this.floatParameters[t].name,this.floatParameters[t].value);for(let t=0;t<this.colorParameters.length;t++)this.setParameter(this.colorParameters[t].name,this.colorParameters[t].value.data);for(let t=0;t<this.vectorParameters.length;t++)this.setParameter(this.vectorParameters[t].name,this.vectorParameters[t].value.data);for(let t=0;t<this.textureParameters.length;t++){const e=this.textureParameters[t].value;this.setParameter(this.textureParameters[t].name,e?e.handle:null)}const t=[];for(let e=0;e<this.materialFlags.length;e++){const i=this.materialFlags[e];i.enabled&&t.push(i.name)}this.shaderKeywords=t},deleteParameter:function(t){pc.Material.prototype.deleteParameter.call(this,t);const e=this._shader.defaultParameters[t];e&&this.setParameter(t,e)},setParameter:function(t,e){if(pc.Material.prototype.setParameter.call(this,t,e),null===e&&this._shader){const e=this._shader.defaultParameters[t];e&&this.setParameter(t,e)}else e instanceof pc.Texture&&!e.device.webgl2&&(e._pot||0!==e._addressU||0!==e._addressV||console.warn("Material's '"+this.name+"' texture '"+e.name+"' wrap mode is set to 'Repeat', but it's resolution NOT POWER OF TWO (NPOT)\nOnly textures with Power Of Two (POT) resolution can be used with WrapMode=Repeat"))},getParameter:function(t){return pc.Material.prototype.getParameter.call(this,t)},getMainTexture:function(){const t=this.getParameter("_MainTex");return t?t.data:null},setMainTexture:function(t){this.setParameter("_MainTex",t)},clone:function(){const t=new pc.UnityMaterial;return t.name=this.name,t._shader=this._shader,t.copyPropertiesFromMaterial(this),t},hasProperty:function(t){return this.parameters.hasOwnProperty(t)||this.shader.defaultParameterNames.hasOwnProperty(t)},copyPropertiesFromMaterial:function(t){this.renderQueue=t.renderQueue,this.enableInstancing=t.enableInstancing,this.keywords.copy(t.keywords),this.$id=t.$id;for(const e in t.parameters)this.setParameter(e,this.cloneParameterData(t.parameters[e].data))},cloneParameterData:function(t){return t instanceof Float32Array||t instanceof Array?new Float32Array(t):t}}),Object.defineProperty(t.prototype,"shaderKeywords",{get:function(){return this.keywords.getEnabledKeywords()},set:function(t){this.keywords.setEnabledKeywords(t)}}),Object.defineProperty(t.prototype,"passCount",{get:function(){return this._shader.passes.length}}),Object.defineProperty(t.prototype,"shader",{get:function(){return this._shader},set:function(t){this._shader&&this._shader._refCount--,this._shader=t,t&&t._refCount++}}),{UnityMaterial:t}}()),pc.extend(pc,function(){const t=function(){this.parameters={},this.parametersCount=0};return pc.extend(t.prototype,{copyFromMeshInstance:function(t){for(const e in t.parameters)this.setParameter(e,this.cloneParameterData(t.parameters[e].data))},applyToMeshInstance:function(t){t.parameters={};for(const e in this.parameters)t.setParameter(e,this.cloneParameterData(this.parameters[e].data))},getParameter:function(t){const e=this.parameters[t];return e?this.cloneAsPlainArray(e.data):null},setParameter:function(t,e){this.parameters.hasOwnProperty(t)||this.parametersCount++,pc.Material.prototype.setParameter.call(this,t,this.cloneParameterData(e))},clear:function(){this.parameters={},this.parametersCount=0},cloneParameterData:function(t){return t instanceof Float32Array||t instanceof Array?new Float32Array(t):t},cloneAsPlainArray:function(t){return t instanceof Float32Array?Array.prototype.slice.call(t):t}}),Object.defineProperty(t.prototype,"isEmpty",{get:function(){return 0===this.parametersCount}}),{UnityMaterialPropertyBlock:t}}()),Bridge.assembly("LunaUnity",(t,e)=>{const i={};Bridge.define("LunaUnity.Objects.Bundle",{statics:{configure:function(t,e){this.objectSpace=t.objectSpace,this.network=t.network,this.bundles=e,this.handlers={game_object:new LunaUnity.Objects.Handlers.GameObject(t),audio_mixer:new LunaUnity.Objects.Handlers.AudioMixer(t),audio_mixer_snapshot:new LunaUnity.Objects.Handlers.AudioMixerSnapshot(t),project_settings:new LunaUnity.Objects.Handlers.ProjectSettings(t),material:new LunaUnity.Objects.Handlers.Material(t),physic_material:new LunaUnity.Objects.Handlers.PhysicMaterial(t),physics_material_2d:new LunaUnity.Objects.Handlers.PhysicsMaterial2D(t),mesh:new LunaUnity.Objects.Handlers.Mesh(t),scene:new LunaUnity.Objects.Handlers.Scene(t),shader:new LunaUnity.Objects.Handlers.Shader(t),video:new LunaUnity.Objects.Handlers.Video(t),sound:new LunaUnity.Objects.Handlers.Sound(t),sprite:new LunaUnity.Objects.Handlers.Sprite(t),texture:new LunaUnity.Objects.Handlers.Texture(t),cubemap:new LunaUnity.Objects.Handlers.Cubemap(t),animation_clip:new LunaUnity.Objects.Handlers.AnimationClip(t),blend_tree:new LunaUnity.Objects.Handlers.BlendTree(t),animator_controller:new LunaUnity.Objects.Handlers.AnimatorController(t),font:new LunaUnity.Objects.Handlers.Font(t),resources:new LunaUnity.Objects.Handlers.Resources(t),scriptable_object:new LunaUnity.Objects.Handlers.ScriptableObject(t),text_asset:new LunaUnity.Objects.Handlers.TextAsset(t),prefab_component:new LunaUnity.Objects.Handlers.PrefabComponent(t)}},tickResource:function(){this._resources=this._resources||0,this._resources++},loadAsync:function(t){return this.new(t)._loadAsync()},loadByNameAsync:function(t){const e=Object.keys(this.bundles);for(let i=0;i<e.length;i++){if(this.bundles[e[i]].name===t)return this.loadAsync(e[i])}throw new System.FileNotFoundException},releaseByNameAsync:function(t){const e=Object.keys(this.bundles);for(let i=0;i<e.length;i++){const n=this.bundles[e[i]];if(n.name===t){const t=this._bundles[n.id];return t&&t._releaseBundleAndDependencies(),!0}}return!1},new:function(t){const e=this.bundles[t];return this._bundles=this._bundles||{},this._bundles[t]=this._bundles[t]||new LunaUnity.Objects.Bundle({manifest:e,objectSpace:this.objectSpace,network:this.network}),this._bundles[t]}},ctor:function(t){this.$initialize(),this.objectSpace=t.objectSpace,this.manifest=t.manifest,this.network=t.network,this.namesToId=i,this.refCount=0},_collectDependencies:function(t,e){let i=[];if(!t[e]){t[e]=!0,i.push(e);const n=LunaUnity.Objects.Bundle.bundles[e].dependencies;for(let e=0;e<n.length;e++)i=i.concat(this._collectDependencies(t,n[e]))}return i},_retain:function(){this.refCount++},_release:function(){if(this.refCount--,this.refCount>0)return;LunaUnity.Objects.Bundle._bundles[this.manifest.id]=null,console.log("Bundle "+this.manifest.name+" got refcount reduced to 0 and is about to free resources");const t=[{handler:"project_settings",json:"project-settings"},{handler:"texture",json:"textures"},{handler:"shader",json:"shaders"},{handler:"mesh",json:"meshes"},{handler:"video",json:"videos"},{handler:"sound",json:"sounds"},{handler:"animation_clip",json:"animation-clips"},{handler:"blend_tree",json:"blend-trees"},{handler:"text_asset",json:"text-assets"},{handler:"audio_mixer",json:"audio-mixers"},{handler:"physic_material",json:"physic-materials"},{handler:"physics_material_2d",json:"physics-materials-2d"},{handler:"audio_mixer_snapshot",json:"audio-mixer-snapshots"},{handler:"cubemap",json:"cubemaps"},{handler:"material",json:"materials"},{handler:"sprite",json:"sprites"},{handler:"font",json:"fonts"},{handler:"animator_controller",json:"animator-controllers"},{handler:"resources",json:"resources"},{handler:"scene",json:"scenes"},{handler:"scriptable_object",json:"scriptable-objects"},{handler:"game_object",json:"prefabs"}],e=this.json["scriptable-objects"];if(e)for(let t=0;t<e.length;t++){const i=this.objectSpace.registry.Get(e[t].id);i.CallOnDisable(),i.CallOnDestroy()}for(let e=0;e<t.length;e++){const i=LunaUnity.Objects.Bundle.handlers[t[e].handler],n=this.json[t[e].json];if(n)for(let t=0;t<n.length;t++)i.unloadAsync(n[t])}this.json=null},_retainBundleAndDependencies:function(){const t=this._collectDependencies({},this.manifest.id);for(let e=0;e<t.length;e++){LunaUnity.Objects.Bundle.new(t[e])._retain()}},_releaseBundleAndDependencies:function(){const t=this._collectDependencies({},this.manifest.id);for(let e=0;e<t.length;e++){LunaUnity.Objects.Bundle.new(t[e])._release()}},_loadAsync:function(){if(this._retainBundleAndDependencies(),this.loadCompletionSource)return this.loadCompletionSource.task;this.loadCompletionSource=new System.Threading.Tasks.TaskCompletionSource,this.loadCompletionSource.task.setSynchronous(!0);const t=this._collectDependencies({},this.manifest.id),e=[],i=[],n=new LunaUnity.Objects.Request;for(let n=0;n<t.length;n++){const s=LunaUnity.Objects.Bundle.new(t[n]);i.push(s),e.push(s._downloadBundleDataAsync(),s._downloadBlobDataAsync())}return System.Threading.Tasks.Task.whenAll(e).continueWith(Bridge.fn.bind(this,(function(t){console.info("%cBundle chain loaded successfully","background-color: black; color: white; padding: 1em;"),this._loadSimpleAssetsAsync(n,i).continueWith(Bridge.fn.bind(this,(function(t){console.info("%cSimple assets loaded successfully","background-color: black; color: white; padding: 1em;"),this._loadComplexAssetsAsync(n,i).continueWith(Bridge.fn.bind(this,(function(t){console.info("%cComplex assets loaded successfully","background-color: black; color: white; padding: 1em;"),n.resolveReferences(this.objectSpace.registry),this._loadPrefabsAsync(n,i).continueWith(Bridge.fn.bind(this,(function(t){console.info("%cPrefabs loaded successfully","background-color: black; color: white; padding: 1em;"),n.resolveReferences(this.objectSpace.registry),this._loadScenesAsync(n,i).continueWith(Bridge.fn.bind(this,(function(t){console.info("%cScenes loaded successfully","background-color: black; color: white; padding: 1em;"),n.resolveReferences(this.objectSpace.registry),this.loadCompletionSource.setResult(this)})))})))})))})))}))),this.loadCompletionSource.task},_downloadBlobDataAsync:function(){return this.downloadBlobCompletionSource?this.downloadBlobCompletionSource.task:(this.downloadBlobCompletionSource=new System.Threading.Tasks.TaskCompletionSource,this.network.GetBlobAsync("assets/bundles/"+this.manifest.id+"/data.blob").continueWith(Bridge.fn.bind(this,(function(t){this.blob=t.result,this.downloadBlobCompletionSource.setResult(this),LunaUnity.Objects.Bundle.tickResource()}))),this.downloadBlobCompletionSource.task)},_downloadBundleDataAsync:function(t){return this.downloadCompletionSource?this.downloadCompletionSource.task:(this.downloadCompletionSource=new System.Threading.Tasks.TaskCompletionSource,this.network.GetJsonAsync("assets/bundles/"+this.manifest.id+"/bundle.json").continueWith(Bridge.fn.bind(this,(function(t){this.json=t.result,this.downloadCompletionSource.setResult(this),LunaUnity.Objects.Bundle.tickResource()}))),this.downloadCompletionSource.task)},_loadSimpleAssetsAsync:function(t,e){return this._loadAssetsFromBundlesAsync(t,e,[{handler:"project_settings",json:"project-settings"},{handler:"texture",json:"textures"},{handler:"shader",json:"shaders"},{handler:"mesh",json:"meshes"},{handler:"video",json:"videos"},{handler:"sound",json:"sounds"},{handler:"animation_clip",json:"animation-clips"},{handler:"blend_tree",json:"blend-trees"},{handler:"text_asset",json:"text-assets"},{handler:"audio_mixer",json:"audio-mixers"},{handler:"physic_material",json:"physic-materials"},{handler:"physics_material_2d",json:"physics-materials-2d"},{handler:"audio_mixer_snapshot",json:"audio-mixer-snapshots"}])},_loadComplexAssetsAsync:function(t,e){return this._loadAssetsFromBundlesAsync(t,e,[{handler:"cubemap",json:"cubemaps"},{handler:"material",json:"materials"},{handler:"sprite",json:"sprites"},{handler:"font",json:"fonts"},{handler:"animator_controller",json:"animator-controllers"}])},_loadPrefabsAsync:function(t,e){let i=[],n=[];const s={};for(let t=0;t<e.length;t++){const r=e[t];s[r.manifest.id]=r,r._guardAssetType("prefabs",()=>{i=i.concat(r.json.prefabs||[])}),r._guardAssetType("scriptable-objects",()=>{n=n.concat(r.json["scriptable-objects"]||[])})}const r=LunaUnity.Objects.Bundle.handlers.game_object,o=LunaUnity.Objects.Bundle.handlers.scriptable_object,a=LunaUnity.Objects.Bundle.handlers.project_settings,u=LunaUnity.Application.Instance.app.systems.list;for(let t=0;t<u.length;t++){u[t].creatingPrefabs=!0}for(let n=0;n<i.length;n++)r.loadAsync(t,i[n],e,a.autoInstantiatePrefabs).result;for(let t=0;t<u.length;t++){u[t].creatingPrefabs=!1}const c=[];for(let e=0;e<n.length;e++){const i=o.loadAsync(t,n[e]).result;c.push(i)}for(let t=0;t<c.length;t++){const e=c[t];e.CallAwake&&e.CallAwake(),e.CallOnEnable&&e.CallOnEnable()}return System.Threading.Tasks.Task.fromResult(!0)},_loadScenesAsync:function(t,e){return this._loadAssetsFromBundlesAsync(t,e,[{handler:"resources",json:"resources"},{handler:"scene",json:"scenes"}],!0)},_loadAssetsFromBundlesAsync:function(t,e,i,n){const s=[],r={};for(let n=0;n<i.length;n++){const o=i[n].handler,a=i[n].json,u=LunaUnity.Objects.Bundle.handlers[o];let c=[];for(let t=0;t<e.length;t++){const i=e[t];r[i.manifest.id]=i,i._guardAssetType(a,()=>{c=c.concat(i.json[a]||[])})}for(let i=0;i<c.length;i++){let n=c[i];window.playgroundBundlesOverrides&&(n=window.playgroundBundlesOverrides[n.id]||n);const a=u.loadAsync(t,n,e);"texture"!==o&&"sound"!==o&&"video"!==o||(s.push(a),a.continueWith(()=>{LunaUnity.Objects.Bundle.tickResource()})),r[n.assetBundleId].namesToId[(n.name||"").toLowerCase()]=c[i].id||n.$id}}return System.Threading.Tasks.Task.whenAll(s)},_remove:function(){console.warn("Requested removal of asset bundle id = "+this.manifest.id+" - this is no-op for now")},_guardAssetType:function(t,e){this._guardAssetTypes=this._guardAssetTypes||{},this._guardAssetTypes[t]||e(),this._guardAssetTypes[t]=!0}})}),pc.extend(pc,function(){const t=new Uint8Array([0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1]),e=new pc.Vec3(1,1,-1),i=new pc.Vec3(1,-1,-1);let n=null,s=null;const r=function(t){this.app=t,this.indirectSpecular=new pc.Color(.4465786,.4964123,.5748172,1),this.meshInstances=[]};return pc.extend(r.prototype,{install:function(e){const i=new pc.GraphNode;i.cullingLayer=-1;const n=pc.createSphere(UnityEngine.Graphics.graphicsDevice,{radius:1,latitudeBands:64,longitudeBands:32}),s=new pc.MeshInstance(i,n,new pc.Material);s.cull=!1,s._noDepthDrawGl1=!0,s._shaderDefs=pc.SHADERDEF_RENDERTYPE_BACKGROUND,(new pc.Model).meshInstances=[s],i._sync(),this.meshInstance=s,this.meshInstances.push(s),this.matrix_projection=new pc.Mat4,this.matrix_view=new pc.Mat4,this.matrix_viewProjection=new pc.Mat4,this.sunPosition=new pc.Vec3,this.blackCube=new pc.Texture(UnityEngine.Graphics.graphicsDevice,{cubemap:!0,rgbm:!1,width:2,height:2}),this.blackCube._levels[0]=[t,t,t,t,t,t],this.environmentCubemap=this.blackCube,e.addRenderer(this)},getMeshInstancesForRender:function(){return this.meshInstances},setSkyboxEnabled:function(t){this.meshInstance.cull=!t},update:function(){const t=UnityEngine.RenderSettings._skybox;if(!t||!t.handle)return this.indirectSpecular.set(0,0,0,1),void(this.meshInstance.visible=!1);this.meshInstance.material=t.handle,this.meshInstance.visible=!0,this.app.systems.reflectionprobe.scheduleProbeUpdate(),this.app.scene.root&&this.app.scene.root.syncHierarchy()},updateSkyDrawCall:function(t,n){this.matrix_view.setTRS(pc.Vec3.ZERO,t._node.getRotation(),n?i:e).invert(),t._projection===pc.PROJECTION_PERSPECTIVE?this.matrix_projection.setPerspective(t._fov,t._aspect,.01,1,t._horizontalFov):this.matrix_projection.setPerspective(90,t._aspect,.01,1,t._horizontalFov),this.matrix_viewProjection.mul2(this.matrix_projection,this.matrix_view),this.meshInstance.setParameter(this.app.renderer.unityIds.viewProjId.name,this.matrix_viewProjection.data);let s=UnityEngine.RenderSettings.sun;if(s)s=s.handle;else{const t=this.app.systems.light.store,e=Object.keys(t);for(let i=0;i<e.length;i++){const n=t[e[i]];if(n.data.enabled&&n.entity.enabled&&"directional"===n.data.type){s=n.data.light;break}}}const r=s?s._node?s._node:s.entity:null;s&&r&&r.enabled?(this.meshInstance.setParameter("_LightColor0",s._color.data),this.sunPosition.set(0,0,-1),r.transformDirection(this.sunPosition,this.sunPosition),this.meshInstance.setParameter("_WorldSpaceLightPos0",[this.sunPosition.x,this.sunPosition.y,this.sunPosition.z,0])):(this.meshInstance.setParameter("_LightColor0",[0,0,0,0]),this.meshInstance.setParameter("_WorldSpaceLightPos0",[0,0,0,0]))},getSkyDrawCall:function(t){return this.meshInstance},bakeEnvironmentReflections:function(){const t=UnityEngine.RenderSettings._defaultReflectionResolution||128;switch(UnityEngine.RenderSettings.defaultReflectionMode){case UnityEngine.Rendering.DefaultReflectionMode.Skybox:this.environmentCubemap=this.bakeToCubemap(t,this._environmentCubemap);break;case UnityEngine.Rendering.DefaultReflectionMode.Custom:{const t=UnityEngine.RenderSettings.customReflection;this.environmentCubemap=(t?t.handle:null)||this.blackCube;break}}this.updateReflectionIntensity(),this.computeIndirectSpecular(),UnityEngine.RenderSettings._defaultReflectionMode===UnityEngine.Rendering.DefaultReflectionMode.Skybox&&(UnityEngine.LightmapSettings.reflectionProbes.environmentProbe.cubemap=this.environmentCubemap)},updateReflectionIntensity:function(){this.environmentCubemap.intensity=UnityEngine.RenderSettings._reflectionIntensity},computeIndirectSpecular:function(){if(!this.environmentCubemap||this.environmentCubemap===this.blackCube)return;this.indirectSpecular.set(0,0,0,1);const t=this.app.graphicsDevice,e=Math.log(this.environmentCubemap.width)/Math.log(2)|0,i=t.activeFramebuffer;if(!n){const e=new pc.Texture(t,{mipmaps:!1,width:1,height:1,format:pc.PIXELFORMAT_R8_G8_B8_A8});n=new pc.RenderTarget(t,e,{depth:!1})}s||(s=pc.shaderChunks.createShaderFromCode(t,pc.shaderChunks.convolveLastMipOfCubemapVS,pc.shaderChunks.convolveLastMipOfCubemapPS,"convolveLastMipOfCubemap")),t.scope.resolve("_Cubemap_").setValue(this.environmentCubemap),t.scope.resolve("_Level_").setValue(e),pc.drawQuadWithShader(t,n,s);const r=n._colorBuffer.toBuffer();this.indirectSpecular.set(r[0],r[1],r[2],255).scale(1/255),t.setFramebuffer(i)},bakeEnvironmentLighting:function(){UnityEngine.RenderSettings.ambientMode===UnityEngine.Rendering.AmbientMode.Skybox&&(this.update(),this.meshInstance.visible?(this.lightingCubemap=this.bakeToCubemap(8,null),this.lightingCubemap.sync(0)):this.lightingCubemap=null)},bakeToCubemap:function(t,e){const i=this.app.graphicsDevice,n=new pc.Entity,s=n.addComponent("camera",{projection:pc.PROJECTION_ORTHOGRAPHIC,aspectRatio:1,orthoHeight:1});if((e=e||new pc.Texture(i,{cubemap:!0,rgbm:!1}))._width=e._height=t,!this.meshInstance.visible)return e;const r=[[0,90,0],[0,-90,0],[-90,0,0],[90,0,0],[0,0,0],[0,180,0]];for(let t=0;t<6;t++)n.setLocalEulerAngles.apply(n,r[t]),n._sync(),this.updateSkyDrawCall(s.camera,!0),s.renderTarget=new pc.RenderTarget({colorBuffer:e,face:t,depth:!1}),this.app.renderer.setCamera(s.camera,s.renderTarget,!0),this.app.renderer.renderMeshInstance(new pc.KeywordSet,null,s.camera,this.meshInstance,[[],[],[]]);return i.gl.generateMipmap(e._glTarget),e.markUploaded(),e}}),{Skybox:r}}()),pc.extend(pc,function(){const t={x:0,y:0,width:1,height:1},e=new pc.KeywordSet,i=new pc.Mat4,n=new pc.GraphNode;n.name="CommandBufferDrawCall";let s=null;return{Graphics:{executeCommandBuffer:function(r){if(!r)return;const o=pc.Application.getApplication().renderer,a=o.device,u=r.renderTargetIdentifier.target["__UnityEngine.RenderTexture"].renderTarget;a.setRenderTarget(u),a.updateBegin(),a.setColorWrite(!0,!0,!0,!0),a.setDepthWrite(!0),o.setupViewport(t,u.width,u.height),r.view&&r.proj?i.mul2(r.proj,r.view):i.copy(UnityEngine.GL.matrix),o.viewProjId.setValue(i.data),o.unityIds.viewProjId.setValue(i.data);const c=r.clearCommand;c&&u&&o.clearTarget(u,c);for(let t=0;t<r.commands.length;t++){const i=r.commands[t],a=i.mesh,u=-1===i.submeshIndex?a.subMeshes:[a.subMeshes[i.submeshIndex]];for(let t=0;t<u.length;t++){const r=u[t];n.setWorldTransform(i.matrix),s?(s.node=n,s.mesh=r,s.materiall=i.material):s=new pc.MeshInstance(n,r,i.material);const a=i.materialPropertyBlock;a&&a.applyToMeshInstance(s),o.renderMeshInstance(e,null,null,s,null)}}}}}}()),pc.extend(pc,function(){const t=function(t,e,i,n,s,r){this.mesh=t,this.matrix=e,this.material=i,this.submeshIndex=n,this.shaderPass=s,this.materialPropertyBlock=r},e=function(){this.device=pc.Application.getApplication().graphicsDevice,this._name="",this.commands=[],this.renderTargetIdentifier=null,this.clearCommand=null,this.view=null,this.proj=null};return pc.extend(e.prototype,{clear:function(){this.commands.length=0,this.renderTargetIdentifier=null,this.clearCommand=null},clearRenderTarget:function(t,e,i){let n=0;t&&(n|=pc.CLEARFLAG_DEPTH),e&&(n|=pc.CLEARFLAG_COLOR),this.clearCommand={color:i.data,depth:1,flags:n}},setRenderTarget:function(t){this.renderTargetIdentifier=t},drawMesh:function(e,i,n,s,r,o){const a=new t(e||null,i||pc.Mat4.IDENTITY.clone(),n||null,s||-1,r||-1,o||null);this.commands.push(a)},setViewMatrix:function(t){this.view=t},setProjectionMatrix:function(t){this.proj=t}}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},set:function(t){this._name=t}}),{CommandBuffer:e}}()),pc.extend(pc,function(){const t=function(){this._name=""};return pc.extend(t.prototype,{copyFromMeshInstance:function(t){for(const e in t.parameters)this.setParameter(e,this.cloneParameterData(t.parameters[e].data))}}),Object.defineProperty(t.prototype,"target",{get:function(){return this._target},set:function(t){this._target=t}}),{RenderTargetIdentifier:t}}()),Bridge.assembly("LunaUnity",(t,e)=>{Bridge.define("LunaUnity.Objects.Scene",{ctor:function(){this.$initialize(),this.isLoaded=!1,this.index=-1,this.name=null,this.template=null,this.root=null,this.lightmapsOffset=-1},initializeAsTemplate:function(t){return this.rootJsons=t.rootJsons,this.renderSettings=t.renderSettings,this.name=t.name,this.index=t.index,this.lightmaps=t.lightmaps,this},_createRoot:function(){this.root=new pc.Entity,this.root.scene=this,this.root.name="SceneRoot: "+this.name,this.application.app.root.addChild(this.root)},initializeAsDontDestroyOnLoad:function(){this.name="DontDestroyOnLoad",this.application=window.$application,this.isLoaded=!0,this._createRoot()},isValid:function(){return!0},_load:function(t){return this.application=t,this.isLoaded=!0,this._createRoot(),UnityEngine.LightmapSettings.reflectionProbes||(UnityEngine.LightmapSettings.reflectionProbes=new UnityEngine.ReflectionProbes),this._installLightProbes(),this._installLightmaps(),1===UnityEngine.SceneManagement.SceneManager.sceneCount&&(window.$scene=this,this._applyRenderSettings(),this._updateEnvironmentLighting()),this.disableCallbacks(),this._loadObjects(),this.invokeCallbacks(this.root),this.root.syncHierarchy(),System.Threading.Tasks.Task.fromResult(!0)},loadAsync:function(){return this._load(window.$application)},unload:function(){this._unload()},_unload:function(){const t=this.root.children.slice();for(let e=0;e<t.length;e++)new pc.DestroyEntityTask(t[e],0).execute();this.root.destroy(),this.root=null,this.isLoaded=!1,this._uninstallLightProbes()},findChild:function(t,e){if(e.id===t)return e;{let i=null;for(let n=0;n<e.children.length&&(i=this.findChild(t,e.children[n]),!i);n++);return i}},_instantiate:function(t,e,i,n,s,r){const o=LunaUnity.Objects.Bundle.handlers.game_object.fork(),a=new LunaUnity.Objects.Request;let u;a.root=s||this.root;let c=!0;if(t.handle&&!t.handle.isPrefab){const i=t.gameObject.handle.$id;e.handle.$id===i?u=e.handle.objectJson:(e=e.handle.objectJson,u=this.findChild(i,e)),e=t.handle}else if(e.isPrefabProxy)u=e.prefab||o.registry.Get(e.prefabId).prefab;else if(u=(e=e.handle).objectJson,c=e.activeSelf,!u)throw new Error("Unable to instantiate a non-prefab object");this.disableCallbacks();const h=o.loadAsync(a,u).result;if(h.isPrefab=!1,h.name=(e.name||h.name)+"(Clone)",h.enabled=c,a.resolveReferences(o.registry),i&&n)h.muteTransformModificationCallback(),h.setRotation(n),h.setPosition(i),h.unmuteTransformModificationCallback();else if(r){h.muteTransformModificationCallback();const t=h.getLocalRotationAndScale();h.setRotation(h.getLocalRotation().clone()),h.setPosition(h.getLocalPosition().clone()),h.setWorldRotationAndScale(t),h.unmuteTransformModificationCallback()}this.invokeCallbacks(h);const l=o.registry.Get(e.isPrefabProxy?e.componentId||u.id:t.handle.$id);if(l.code)return l.code;if(e.isPrefabProxy)return UnityEngine.Object.FromHandle(t,l);if(Bridge.Reflection.isAssignableFrom(UnityEngine.Transform,Bridge.getType(t)))return UnityEngine.Object.FromHandle(UnityEngine.GameObject,l).gettransform();if("GameObject"===Bridge.Reflection.getTypeName(Bridge.getType(t)))return UnityEngine.Object.FromHandle(UnityEngine.GameObject,l);throw new Error("Don't know what should be instantiated")},_locatePrefabAsync:function(t,e){const i=LunaUnity.Objects.Bundle.loadByNameAsync(t),n=new System.Threading.Tasks.TaskCompletionSource;return i.continueWith(Bridge.fn.bind(this,t=>{const i=t.result.json.prefabs.find(t=>t.data[0]===e).id,s=LunaUnity.Objects.Bundle.handlers.game_object.objectSpace.registry,r=UnityEngine.Object.FromHandle(UnityEngine.GameObject,s.Get(i));n.setResult(r)})),n.task},_releaseBundleAsync:function(t){LunaUnity.Objects.Bundle.releaseByNameAsync(t)},_applyRenderSettings:function(){const t=this.application.app,e=this.application.objectSpace.getRegistry(),i=UnityEngine.RenderSettings,n=this.renderSettings;t.scene.ambientLight=(new pc.Color).copy(n.ambientLight),i._ambientMode=n.ambientMode,i._pixelLightCount=n.pixelLightCount,i._ambientLight=n.ambientLight.clone(),i._ambientSkyColor=n.ambientSkyColor.clone(),i._ambientEquatorColor=n.ambientEquatorColor.clone(),i._ambientGroundColor=n.ambientGroundColor.clone(),i._ambientIntensity=n.ambientIntensity,i._reflectionIntensity=n.reflectionIntensity,i._defaultReflectionMode=n.defaultReflectionMode,i._defaultReflectionResolution=n.defaultReflectionResolution,i._sun=UnityEngine.Object.FromHandle(UnityEngine.Light,e.TryGet(n.sunLightObjectId)),i._skybox=n.skybox,i.fogDensity=n.fogDensity,i.fogColor=n.fogColor.clone(),i.fogStart=n.fogStart,i.fogEnd=n.fogEnd,i.fogMode=n.fogMode,i.fog=n.fog,i.hasLightDataAsset=n.hasLightDataAsset,i.hasManualGenerate=n.hasManualGenerate,i.ambientProbe.clear(),this._installSkybox(),i._customReflection=n.customReflection},_updateEnvironmentLighting:function(){const t=UnityEngine.RenderSettings,e=this.application.app;e.scene.skyboxHelper.update(),e.scene.skyboxHelper.environmentCubemap||t.defaultReflectionMode!==UnityEngine.Rendering.DefaultReflectionMode.Skybox&&t.defaultReflectionMode!==UnityEngine.Rendering.DefaultReflectionMode.Custom?(e.scene.skyboxHelper.computeIndirectSpecular(),e.scene.skyboxHelper.updateReflectionIntensity()):UnityEngine.DynamicGI.BakeReflectionsCubemap();const i=1!==t._ambientIntensity||t._ambientMode!==UnityEngine.Rendering.AmbientMode.Skybox||!t.skybox;t._ambientMode===UnityEngine.Rendering.AmbientMode.Skybox&&!t.hasLightDataAsset&&t.hasManualGenerate||(i?(UnityEngine.DynamicGI.BakeLightingCubemap(),UnityEngine.DynamicGI.UpdateEnvironmentLighting()):(UnityEngine.DynamicGI.UpdateEnvironmentLighting(!1),t.ambientProbe.copy(this.renderSettings.ambientProbe)))},_installSkybox:function(){const t=this.application.app;t.scene.skyboxHelper||(t.scene.skyboxHelper=new pc.Skybox(t),t.scene.skyboxHelper.install(t.scene),t.scene.skyboxHelper.environmentCubemap=this.renderSettings.defaultReflection?this.renderSettings.defaultReflection.handle:null)},_installLightmaps:function(){this.renderSettings.lightmaps&&0!==this.renderSettings.lightmaps.length&&(UnityEngine.LightmapSettings.lightmapsMode=this.renderSettings.lightmapsMode,UnityEngine.LightmapSettings.environmentLightingMode=this.renderSettings.environmentLightingMode,UnityEngine.LightmapSettings.manager.loadSceneLightmaps(this.index,this.renderSettings.lightmaps))},_installLightProbes:function(){if(UnityEngine.LightmapSettings.lightProbes||(UnityEngine.LightmapSettings.lightProbes=this.renderSettings.lightProbes),!this.renderSettings.lightProbes||!this.renderSettings.lightProbes.HasProbes)return;const t=UnityEngine.SceneManagement.SceneManager.currentLightProbeProvider;t&&t.index===this.index?UnityEngine.SceneManagement.SceneManager.currentLightProbeProvider=this:(UnityEngine.LightmapSettings.lightProbes&&UnityEngine.LightmapSettings.lightProbes.HasProbes&&console.warn("Another scene with light probes was loaded. Previous light probes were unloaded."),UnityEngine.LightmapSettings.lightProbes=this.renderSettings.lightProbes,UnityEngine.SceneManagement.SceneManager.currentLightProbeProvider=this)},_uninstallLightProbes:function(){if(UnityEngine.SceneManagement.SceneManager.currentLightProbeProvider!==this)return;const t=this.getClosestLoadedSceneMatch(t=>t._containsLightProbes());t&&t._installLightProbes()},getClosestLoadedSceneMatch:function(t){const e=UnityEngine.SceneManagement.SceneManager,i=e.GetSceneIndex(this);if(i<0)return null;const n=e.loadedScenes._items,s=e.loadedScenes.Count;for(let e=i-1;e>=0;e--){const i=n[e];if(i&&i.isLoaded&&(!t||t(i)))return i}for(let e=i+1;e<s;e++){const i=n[e];if(i&&i.isLoaded&&(!t||t(i)))return i}return null},_containsLightProbes:function(){return this.renderSettings.lightProbes&&this.renderSettings.lightProbes.HasProbes},_loadObjects:function(){const t=LunaUnity.Objects.Bundle.handlers.game_object.fork(),e=new LunaUnity.Objects.Request;e.root=this.root;for(let i=0;i<this.rootJsons.length;i++)t.loadAsync(e,this.rootJsons[i]).result;e.resolveReferences(t.registry)},invokeCallbacks:function(t){this.application.app.systems.unitymanager.invokeCallbacks(t)},disableCallbacks:function(t){this.application.app.systems.unitymanager.disableCallbacks()},getRootGameObjects:function(){if(!this.root)return System.Array.init([],UnityEngine.GameObject);const t=this.root.children,e=t.length,i=new Array(e);for(let n=0;n<e;++n)i[n]=UnityEngine.Object.FromHandle(UnityEngine.GameObject,t[n]);return System.Array.init(i,UnityEngine.GameObject)},createInstance:function(){const t=new LunaUnity.Objects.Scene;return t.template=this,t.index=this.index,t.name=this.name,t.rootJsons=this.rootJsons,t.renderSettings=this.renderSettings,t.lightmaps=this.lightmaps,t},setActive:function(t){t&&(this._applyRenderSettings(),this._updateEnvironmentLighting(),window.$scene=this)},addGameObjectToRoot:function(t){const e=t.handle;let i=null;if(null!=e.parent&&(i=e.parent.scene),i&&i===this)return;const n=e.getWorldTransform().clone();e.reparent(this.root,-1),e.setLocalTransform(n)}})}),Bridge.assembly("LunaUnity",(t,e)=>{Bridge.define("LunaUnity.Objects.LightmapManager",{ctor:function(t){this.$initialize(),this.lightmaps=[]},getLightmap:function(t,e){const i=this.lightmaps[t];return i?i.lightmaps[e]:null},loadSceneLightmaps:function(t,e){this.lightmaps[t]=this.lightmaps[t]||{},this.lightmaps[t].lightmaps=e,this.lightmaps[t].custom=!1},setManagedLightmaps:function(t){const e=UnityEngine.SceneManagement.SceneManager.loadedScenes._items;let i=0;const n=UnityEngine.SceneManagement.SceneManager.loadedScenes.Count;for(let s=0;s<n;s++){const r=e[s],o=this.lightmaps[r.index];if(o){const r=[];let a=o.lightmaps.length,u=!0;for(let t=s+1;t<n;t++)if(this.lightmaps[e[t]]){u=!1;break}u&&(a=t.length-i);for(let e=0;e<a;e++)r.push(new UnityEngine.LightmapData.$ctor1(t[i])),i++;o.custom=!0,o.lightmaps=r}}},getManagedLightmaps:function(){if(0===this.lightmaps.length)return System.Array.init([],UnityEngine.LightmapData);const t=[],e=UnityEngine.SceneManagement.SceneManager.loadedScenes._items,i=UnityEngine.SceneManagement.SceneManager.loadedScenes.Count;for(let n=0;n<i;n++){const i=e[n],s=this.lightmaps[i.index];if(s){const e=s.lightmaps;for(let i=0;i<e.length;i++)t.push(new UnityEngine.LightmapData.$ctor1(e[i]))}}return System.Array.init(t,UnityEngine.LightmapData)}})}),function(){let _mouseMovementDelta=null;const unityAttenuationTextureBase64="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABAAAAAABCAYAAABADtw1AAAA+ElEQVRYCc1RSRLDIAxr///jbqlVqhkNJW4IZtEh8oYsyHUz3L64GxCCgYeBjJh4GhArIyZehjxGDUA9Rb9feNGq5ozBAOaUP0WpM1fmGa1dDJqX4nzGy7VXir0aey3sndWexrgzcqAl9s7X9PJZ5IB6O5KXZmpqEbN7GqgD+Z1SNX3P9v7pRvSPaKRb+HfkTI1e7eyI+TM7cIbw/jVn9rjlLDUjNKAVpRPti3o9PKr2CH3ui35r6no8Y6f6mb1fvTBe0RO9gWf6i9i9igbfNMIPtXr8n2h/9NpLt8cb0DO5p/eRO7gLPOJOM/etsps+Rr8395Y4yssbZyWMID2grNAAAAAASUVORK5CYII=",unitySpotTextureBase64="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACABAMAAAAxEHz4AAAAA3NCSVQICAjb4U/gAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAEHRSTlMAESIzRFVmd4iZqrvM3e7/dpUBFQAAAAlwSFlzAAALEgAACxIB0t1+/AAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNui8sowAAAO9SURBVGiB3VnredpAEEQdGHdg0wGiA4tUgKggiFSASAMB3EAQFQTRgeUO7HRg3IHtDkxm9+70AFk6sfoSf9k/2D9mNDO7iHt0Op+6nC7XhQh9LkcBfgYFY67T4n+bPp6APRfVNxTWIhwFJ7DrefyhKCwZgL8k+MBL64YoriwZGN8juO/74yCY4IMo+pYMjIf0IYGDEBUQyQhWrBgUfuABPg3D+RK1CMMZKCDChkHhhz7gQEdcxDEL/JFisMKPA8CjaBNzbcGxCIOJBYOj8dMQ8DjeJVx3cQyKcKYZqkyg/z3C4/FxnCT3j1wPSQKK5YIY+tdVEmBA4VcR4ID+3qOe8AcoorViqDDBBjwf+E2MpzNa1RNUxFsw+F6VCTbgB8DvEoa/6mKK5A4MgV9hwlEGQuD58a+5YhFgCJWJcgkQ4Hrj6ZLwBv52OLwbCmJYziYwUS6BBSAA5Kfxh7Q0A5JEDB9JIAHD8Xxl8G+HXL0bhvViMiqXoAXAAPwXHp+KQA5k4gMJLCCYR7t7wr8d41nE/unhLloE5RJIwHi62sBAKV4xPCbb9WxCEk4dsAAY2D+f6jcuXvYwoSQce1AJrGI2UI4nBpiI1yqF0wjRAhLwMZ4ZSMJkdBIjHAyGLOC5PAATwwtLGN0ce+AI0YJqAVpCtDiJkSPEDNQI0BIwC8cxkgNEWCtAS6AYiwRw4CHCpE6AkpAgRq/ooXvpcoS1AlgCx+jmCXIOagSQhBIPqgccYR0eEijGoz7QFCkHtQJYAnsoElAEu0cbASSBPORDoAh0D+wIuA+5EJyuisDKgfLAIaQEKgKrHmgC9pCFoCOwdMAeiiGoCNBEKwGQoBt53S1kaBtBFoJJMcvQDg8PxRQdnaFtBOkk9K8u8k2wzjBN0bSBm4Axso2AQsAoZW1ommE+xVYIsi7a4tM2qD5yF783aYJqw0/TRxB4zZpg2uBpAtNF6wh4mLNBaI3Avgk8CBkBD+LtfVOCh19mFJlg05xgmxG4w2+N5khP0g89y0TQbBDNKB4T2OP1KKYEgy/nEXy9+X8IxCG20EbhIIlHWfhlEn+dP8EbSfxSlb/WhT8s//63sYWfd+kCQ7zEkS+ypMs88UKzhaWudLEtXu6LNxziLU8bmy7htk+88RRvfeWbb/H2X3wAIT4CkR/CiI+BxAdR8qMw8WGc/DhQfCApPhKVH8qKj4XlB9Pio3H54bz4ekB+QSG/IhFf0sivieQXVeKrMvllnfy6UH5hKb8y7YgvbY2IFm+eZZffZ6L/Vv0BqFspPs/Tph4AAAAASUVORK5CYII=",unityNHxRoughnessBase64="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAABACAMAAADCg1mMAAAAA3NCSVQICAjb4U/gAAABEVBMVEX+/v7v7+/S0tKysrKfn5+ampqHh4d5eXltbW1mZmZkZGRjY2NiYmJeXl5bW1taWlpZWVlTU1NPT09OTk5MTExJSUlISEhHR0dGRkZFRUVERERCQkJBQUE+Pj49PT07Ozs6Ojo5OTk4ODg3Nzc2NjY1NTU0NDQzMzMyMjIxMTEwMDAvLy8uLi4tLS0sLCwrKysqKiopKSkoKCgnJycmJiYlJSUkJCQjIyMiIiIhISEgICAfHx8eHh4dHR0cHBwbGxsaGhoZGRkYGBgXFxcWFhYVFRUUFBQTExMSEhIREREQEBAPDw8ODg4NDQ0MDAwLCwsKCgoJCQkICAgHBwcGBgYFBQUEBAQDAwMCAgIBAQEAAAAUqg0sAAAACXBIWXMAAAsSAAALEgHS3X78AAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M26LyyjAAABDdJREFUeJzl1wlf2jAcxnF334fbnHNz3hvoB9SqxYJSDkUF5RKGW9//C1n+SZsmpWlTWq72eQe/L2laFgzD+Cfe3/HuYfpbMAxvgsgZpl3sGAHwN4hCYYJZA+lRABmDUApTzZQDGCfC7BT7AEgiBFaYcvUf4dwAxoIwyXJxrjyALIK8wnjbgzST9cm8AKI+CtHXB+8dmi9ApAiR5YdqDg4QoUL4/rDZPX7yALIKIQlGjg8QHQIgGoTRAIK3C5rv2Y0AIKkwIkHAfPnye5d1u91RAcIrBBOQrZcJ77ILBSDHENRAEsA/3jO82yGLAEBGIZiBDIB3vEd5h19UACEUpAgC5Iva2ew2XaQAEgqyBkEABPWu7XZ5u4UXPYA/w0gGYgDXfK/2lrUm2rgARlKQJ3DtF9cPtTfpxgrgp+BvIBLw6hfUO9rvzI0fwIfBz8BPwNnvyOfq+fZbvEkBBFQQGYgF+H5hPdvegE0UwFNB0mBIwA2A6WfqmXjc3qijTR7Ai8EDYZiAFxjqd82n9dBev0GbFoC0gpuBg4ARcOvn6ukvD/HXaFMFEDOIENwJHAIUgPv12d/erL9CmwEAPD8EkQEjwAGw/Uy+WX9N6mtoswKA56PgNHASsAIMgNnP5ZP6S7SZAsDzRHAYMAT0ENhHwD4AtB/O/o1dP5MAZBIIjAF3COgRoAfAuvys/Ksr3F6FzSoAnhCBM+AIOIF223oBkPd+45rM/PErsJkGwBMpOI8Bcwjwy9D+/Cfffbfk7qP9OF/XZx8Azx3BxYC8ES0BmPnlj7986vj8X+CVYcXinADgiREcBOZnMSfg6Cf1xfkCwHNB4AysU2D+K7KfAXwDwpu/BndfCe0cLT93AHhDCNSAvBjNP0j4kxB/CtIr0Hr6dV0/Q9O0+QSAuSLYxwBGzwA9AvbvD79+Pp/LzS8AnsBgMHARsAGs/lwudzznADAewTQw/yxZd6F5DZIrEF9/hcLp6cnJyWEMAPCcCObfBesmINcAuQPgAkCPP/Qryn5cAGDOg4BmPQjkKUDPAAXQNOjPZuMEAGMQGANMgAXgDoAbQNNUVVEymXTcAGD8l5J5FeCLAG4BuAMAAH7/vVQqjgAwDsEiIALVqq4XCqp6iPp3NuMKAGMMCAE8BugerFTQO0A9Osikf22uxRkAZr0dyBsBDgG6BsrlM01V9vd+b639iDuAQQ0wQacDAtXSeV5Vsrs766vLCQAwGANE0GwiAb2QO8qmt36ufEkGgDX0Vuz1Wq2bWqWoHWdTG6tLi8kCIASdZr1WPlMPUuvfP39IGgAQ9PutRq2UV3bXvy2+TR4A2qDXua3pambj68eXiQRAp+D+rnaubC+9e5FMAETQb15q6eU3z5MKgJ6D9sXR6qtnyQUwHjql7ddPEgxgGJ3c+8eJBjBaKwvJBjD0RwkHMJ4mHeBT0gGM/4ecz/SdIIT+AAAAAElFTkSuQmCC",_onMouseUp=function(t){const e={x:t.x,y:this.graphicsDevice._height-t.y};window.UnityEngine.Input.mouseButtonsUp[t.button]=!0,window.UnityEngine.Input.mouseButtons[t.button]=!1,window.UnityEngine.Input.mouseButtonsDown[t.button]=!1,window.UnityEngine.Input.mousePosition=new pc.Vec2(e.x,e.y)},_onMouseMove=function(t){const e={x:t.x,y:this.graphicsDevice._height-t.y};_mouseMovementDelta?_mouseMovementDelta.set(e.x-window.UnityEngine.Input.mousePosition.x,-e.y+window.UnityEngine.Input.mousePosition.y):_mouseMovementDelta=new pc.Vec2,window.UnityEngine.Input.axes.Insert("Mouse X",.1*_mouseMovementDelta.x),window.UnityEngine.Input.axes.Insert("Mouse Y",.1*_mouseMovementDelta.y),window.UnityEngine.Input.mousePosition=new pc.Vec2(e.x,e.y)},_onMouseScroll=function(t){window.UnityEngine.Input.axes.Insert("Mouse ScrollWheel",.1*t.wheel),window.UnityEngine.Input.mouseScrollDelta=new pc.Vec2(0,t.wheel)},_onMouseDown=function(t){window.UnityEngine.Input.mouseButtonsDown[t.button]=!0,window.UnityEngine.Input.mouseButtons[t.button]=!0,window.UnityEngine.Input.mouseButtonsUp[t.button]=!1;const e={x:t.x,y:this.graphicsDevice._height-t.y};window.UnityEngine.Input.mousePosition=new pc.Vec2(e.x,e.y)},_onTouchStart=function(t){const e={x:t.changedTouches[0].x,y:t.changedTouches[0].y,button:0};for(let e=0;e<t.changedTouches.length;e++){const i=t.changedTouches[e];UnityEngine.Input.OnTouchStart(i.id,i.x,this.graphicsDevice._height-i.y)}return _onMouseDown.call(this,e),!0},_onTouchEnd=function(t){const e={x:t.changedTouches[0].x,y:t.changedTouches[0].y,button:0};for(let e=0;e<t.changedTouches.length;e++){const i=t.changedTouches[e];UnityEngine.Input.OnTouchEnd(i.id,i.x,this.graphicsDevice._height-i.y)}return _onMouseUp.call(this,e),!0},_onTouchMove=function(t){const e={x:t.changedTouches[0].x,y:t.changedTouches[0].y,button:0};for(let e=0;e<t.changedTouches.length;e++){const i=t.changedTouches[e];UnityEngine.Input.OnTouchMoved(i.id,i.x,this.graphicsDevice._height-i.y)}return _onMouseMove.call(this,e),!0};pc.Application.prototype._onMouseUp=_onMouseUp,pc.Application.prototype._onMouseDown=_onMouseDown,pc.Application.prototype._onTouchStart=_onTouchStart,pc.Application.prototype._onTouchEnd=_onTouchEnd,pc.extend(pc.Application.prototype,{mimicUnityMouse:function(){window.UnityEngine.Input.mousePosition=new pc.Vec2(0,0);let t=this.touch,e=this.mouse;const i=this.graphicsDevice.canvas;"ontouchstart"in window&&pc.input&&pc.input.TouchDevice&&(t=t||new pc.input.TouchDevice(i));const n=!!e;e=e||new pc.Mouse(i),this.touch=t,this.mouse=e,this.touch?(this.touch.on(pc.EVENT_TOUCHSTART,_onTouchStart,this),this.touch.on(pc.EVENT_TOUCHEND,_onTouchEnd,this),this.touch.on(pc.EVENT_TOUCHMOVE,_onTouchMove,this),this.touch.on(pc.EVENT_TOUCHCANCEL,_onTouchEnd,this),UnityEngine.Input.mousePresent=n,UnityEngine.Input.touchSupported=!0):(this.mouse.on(pc.EVENT_MOUSEUP,_onMouseUp,this),this.mouse.on(pc.EVENT_MOUSEDOWN,_onMouseDown,this),this.mouse.on(pc.EVENT_MOUSEMOVE,_onMouseMove,this),this.mouse.on(pc.EVENT_MOUSEWHEEL,_onMouseScroll,this)),this.on("prerender",this._updateInputFlags,this),this.on("prerender",this._updateScreenCache,this),this.on("frameend",this._resetScroll,this)},_updateInputFlags:function(t){window.UnityEngine.Input.mouseButtonsUp[0]=!1,window.UnityEngine.Input.mouseButtonsUp[1]=!1,window.UnityEngine.Input.mouseButtonsUp[2]=!1,window.UnityEngine.Input.mouseButtonsDown[0]=!1,window.UnityEngine.Input.mouseButtonsDown[1]=!1,window.UnityEngine.Input.mouseButtonsDown[2]=!1,window.UnityEngine.Input.axes.Insert("Mouse ScrollWheel",0)},_updateScreenCache:function(){this.renderer._screensRendered={}},_noticeScriptComponent:function(t,e){const i=t.code.$$fullname;this._componentsCache=this._componentsCache||{},this._componentsCache[i]=this._componentsCache[i]||[],e?this._componentsCache[i].push(t.code):this._componentsCache[i]=this._componentsCache[i].filter(e=>e!==t.code)},_resetScroll:function(){window.UnityEngine.Input.axes.Insert("Mouse ScrollWheel",0),window.UnityEngine.Input.mouseScrollDelta=new pc.Vec2(0,0)},getRootObjects:function(){return this.root.children},getMainCamera:function(){let t=null;for(let e=0;e<this.systems.camera.cameras.length;e++){const i=this.systems.camera.cameras[e];if("MainCamera"===i.entity.tag)return i;null!=i.renderTarget||t||(t=i)}return t},initializeBuiltInTextures:function(){const t=[["white",[255,255,255,255]],["red",[255,0,0,0]],["gray",[127,127,127,127]],["bump",[127,127,255,127]],["black",[0,0,0,0]]];let e=null;for(let i=0;i<t.length;i++){const n=t[i][1],s=new pc.Texture(this.graphicsDevice,{width:4,height:4,format:pc.PIXELFORMAT_R8_G8_B8_A8,premultiplyAlpha:!1}),r=s.lock();for(let t=0;t<16;t++)r[4*t+0]=n[0],r[4*t+1]=n[1],r[4*t+2]=n[2],r[4*t+3]=n[3];s.unlock(),UnityEngine.Texture2D[t[i][0]+"Texture"]=UnityEngine.Object.FromHandle(UnityEngine.Texture2D,s),e=r}UnityEngine.Texture2D.greyTexture=UnityEngine.Texture2D.grayTexture;const i=new pc.Texture(this.graphicsDevice,{width:4,height:4,format:pc.PIXELFORMAT_R8_G8_B8_A8,cubemap:!0,premultiplyAlpha:!1});i._levels=[[e,e,e,e,e]],i.upload(),UnityEngine.Cubemap.blackCube=UnityEngine.Object.FromHandle(UnityEngine.Cubemap,i);const n=new pc.Texture(this.graphicsDevice,{width:1024,height:1,addressU:pc.ADDRESS_CLAMP_TO_EDGE,addressV:pc.ADDRESS_CLAMP_TO_EDGE,format:pc.PIXELFORMAT_R8_G8_B8_A8,premultiplyAlpha:!1});let s=document.createElement("IMG");s.src=unityAttenuationTextureBase64,n.setSource(s),UnityEngine.Texture2D.attenuationTexture=UnityEngine.Object.FromHandle(UnityEngine.Texture2D,n);const r=new pc.Texture(this.graphicsDevice,{width:128,height:128,addressU:pc.ADDRESS_CLAMP_TO_EDGE,addressV:pc.ADDRESS_CLAMP_TO_EDGE,format:pc.PIXELFORMAT_R8_G8_B8_A8,premultiplyAlpha:!1});s=document.createElement("IMG"),s.src=unitySpotTextureBase64,r.setSource(s),UnityEngine.Texture2D.spotTexture=UnityEngine.Object.FromHandle(UnityEngine.Texture2D,r);const o=new pc.Texture(this.graphicsDevice,{width:256,height:64,addressU:pc.ADDRESS_CLAMP_TO_EDGE,addressV:pc.ADDRESS_CLAMP_TO_EDGE,format:pc.PIXELFORMAT_R8_G8_B8_A8,premultiplyAlpha:!1});s=document.createElement("IMG"),s.src=unityNHxRoughnessBase64,o.setSource(s),UnityEngine.Texture2D.nhxRoughnessTexture=UnityEngine.Object.FromHandle(UnityEngine.Texture2D,o),pc.UniformDefaultValues[pc.UNIFORMTYPE_TEXTURE2D]=UnityEngine.Texture2D.blackTexture.handle,pc.UniformDefaultValues[pc.UNIFORMTYPE_TEXTURECUBE]=UnityEngine.Cubemap.blackCube.handle,pc.UniformDefaultValues[pc.UNIFORMTYPE_TEXTURE2D_SHADOW]=UnityEngine.Texture2D.blackTexture.handle,pc.UniformDefaultValues[pc.UNIFORMTYPE_TEXTURECUBE_SHADOW]=UnityEngine.Cubemap.blackCube.handle},installPlayroundOverrides:function(){const overrides=window.playgroundOverrides||{};for(const className in overrides){if(!overrides.hasOwnProperty(className))continue;const classNameString=JSON.stringify(className),backupClassNameString=JSON.stringify("_"+className);let code="Deserializers[ "+backupClassNameString+" ] = Deserializers[ "+classNameString+"];\n";code+="Deserializers[ "+classNameString+" ] = function () {\n",code+="  var result = Deserializers[ "+backupClassNameString+" ].apply( this, arguments );\n";const fields=overrides[className];for(const t in fields){if(!fields.hasOwnProperty(t))continue;const e=fields[t];switch(e[0]){case"float":case"int":case"string":code+="  result."+t+" = "+JSON.stringify(e[1])+"; \n";break;case"boolean":code+="  result."+t+" = "+JSON.stringify(!!e[1])+"; \n";break;case"color":code+="  result."+t+" = new pc.Color("+e.slice(1,5).join(",")+"); \n";break;case"vector2":code+="  result."+t+" = new pc.Vec2("+e.slice(1,3).join(",")+"); \n";break;case"vector3":code+="  result."+t+" = new pc.Vec3("+e.slice(1,4).join(",")+"); \n";break;case"vector4":code+="  result."+t+" = new pc.Vec4("+e.slice(1,5).join(",")+"); \n";break;case"enum":code+="  result."+t+" = "+parseInt(e[1],10)+"; \n"}}code+="  return result;\n",code+="}",eval("(function() { "+code+"})()")}},muteAudio:function(){this.systems.sound.volume=0},unmuteAudio:function(){this.systems.sound.volume=1},pause:function(){pc.pause(),this.paused=!0,this.muteAudio()},resume:function(){this.paused&&(pc.resume(),this.paused=!1,this.unmuteAudio())}})}(),pc.extend(pc,function(){const t={size:"fontSize",color:"color",fontStyle:"fontStyle"},e={aqua:"#00ffffff",black:"#000000ff",blue:"#0000ffff",brown:"#a52a2aff",cyan:"#00ffffff",fuchsia:"#ff00ffff",green:"#008000ff",grey:"#808080ff",lightblue:"#add8e6ff",lime:"#00ff00ff",magenta:"#ff00ffff",maroon:"#800000ff",navy:"#000080ff",olive:"#808000ff",orange:"#ffa500ff",purple:"#800080ff",red:"#ff0000ff",silver:"#c0c0c0ff",teal:"#008080ff",white:"#ffffffff",yellow:"#ffff00ff"},i=function(t,e){this.startIndex=t,this.foundTag=e,this.isClosing=!1;const i=(e=e.substr(1,e.length-2)).split("=");let n=i[0];n=n.toLowerCase(),n.startsWith("/")&&(n=n.substr(1),this.isClosing=!0),this.tag=n;let s=i[1]?i[1]:null;if(s&&s.startsWith('"')&&s.endsWith('"')&&(s=s.substr(1,s.length-2)),s&&(s=s.toLowerCase()),this.value=s,this.isClosing)return this;if(this.colorValue=new pc.Color,this.intValue=0,!this.isClosing)switch(this.tag){case"color":this.colorValue=this.parseColor(this.value,this.colorValue);break;case"size":this.intValue=Number.parseInt(this.value,10)}return this};return pc.extend(i.prototype,{apply:function(e,i,n){const s=t[this.tag];if(this.isClosing)switch(this.tag){case"color":e.color.copy(i.color);break;case"size":e.fontSize=i.fontSize,e.fontScale=i.fontScale;break;default:e[s]=i[s]}else switch(this.tag){case"color":e.color.copy(this.colorValue);break;case"size":e.fontSize=this.intValue,e.fontScale=e.fontSize/n;break;default:e[s]=this.intValue}},parseColor:function(t,i){return i=i||new pc.Color,t.startsWith("#")||(t=e[t]),i.fromString(t),i}}),pc.extend(i,{tagRegex:/<.[^>]*>/gm,supportedSingleTags:{br:!0,quad:!0},unityColorsMap:e,removeTags:function(t){return t.replace(this.tagRegex,"")},extractTags:function(t,e){const i=e._tags;i.length=0;let n=0,s=null;for(;null!=(s=this.tagRegex.exec(t));){const t=s[0],e=new pc.TextTag(s.index-n,t);n+=t.length,i.push(e)}const r=this.removeTags(t),o=this.validateTags(i,r);return e.areTagsValid=o,t=o?r:t},validateTags:function(t,e){if(0===t.length)return!0;const i=[];for(let n=0;n<t.length;n++){const s=t[n];if(!pc.TextTag.supportedSingleTags[s.tag])if(s.isClosing){const t=i.pop();if(t.tag!==s.tag)return!1;s.content=e.substr(t.startIndex,s.startIndex-t.startIndex),t.content=e.substr(t.startIndex,s.startIndex-t.startIndex)}else i.push(s)}return 0===i.length}}),{TextTag:i}}()),pc.extend(pc,function(){const t=function(t,e,i,n,s){this.font=t,this.fontSize=e,this.fontScale=i,this.color=n.clone(),this.fontStyle=s};pc.extend(t.prototype,{init:function(t,e,i,n,s){this.font=t,this.fontSize=e,this.fontScale=i,this.color.copy(n),this.fontStyle=s},copy:function(t){this.font=t.font,this.fontSize=t.fontSize,this.fontScale=t.fontScale,this.color.copy(t.color),this.fontStyle=t.fontStyle}});const e=function(){return this.breakable={},this.breakable[" "]=10,this.breakable[","]=20,this.breakable[";"]=30,this.breakable["."]=40,this.breakable["\n"]=500,this};pc.extend(e.prototype,{cleanse:function(t){return t.replace(/\r\n/gm,"\n").replace(/\n\r/gm,"\n")},performWrap:function(t,e,i){let n="";t=this.cleanse(t);const s=Math.round(Math.sqrt(e*t.length/i)),r=Math.round(t.length/s);let o=r,a=0,u=0;for(let e=0;e<s-1;e++)u=a,a=this.bestBreak(t,o,2*r),n+=t.substring(u,a).trim()+"\n",o=a+r;return n+=t.substring(a),n},bestBreak:function(t,e,i){let n=e,s=0,r=0;for(let o=e-(i=Math.min(Math.min(e+i,t.length-1)-e,e-Math.max(e-i,0)));o<=e+i;o++){const i=this.breakable[t[o]];i&&(r=i/Math.abs(1*(e-o)),r>s&&(n=o,s=r))}return Math.min(n+1,t.length-1)}});return{EditableSettings:t,StringWrap:e,MeasuredLine:function(t,e,i){this.text=t,this.width=e,this.fontScale=i},UICharInfo:function(t,e){this.cursorPos=t||new pc.Vec3,this.charWidth=e||0},UILineInfo:function(t,e,i,n){this.startCharIdx=t||0,this.height=e||0,this.topY=i||0,this.leading=n||0}}}()),pc.extend(pc,function(){const t=[{semantic:pc.SEMANTIC_POSITION,components:3,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_TEXCOORD0,components:2,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_TEXCOORD1,components:2,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_COLOR,components:4,type:pc.ELEMENTTYPE_FLOAT32}],e=new pc.Vec4,i=new pc.Vec4,n=new pc.Vec4,s=function(t){return this._offset=new pc.Vec3,this._bakedOffset=new pc.Vec3,this._bounds=new pc.Vec2,this._metrics=new pc.Vec4,this.canvasRenderer=t,this._vertexCount=0,this._bufferSize=0,this._buffer=null,this._resizeBuffers(16),this._fontScale=0,this._bestFit=!1,this._font=null,this._maxFontSize=0,this._minFontSize=0,this._minFontSizeOriginal=0,this._maxFontSizeOriginal=0,this._horizontalWrap=!1,this._verticalOverflow=!1,this._lineHeight=0,this._fontSize=0,this._align=pc.TEXT_ALIGN_CENTER,this._color=new pc.Color(1,1,1,1),this._dirtyVertices=!1,this._dirtyOffset=!1,this._lineCount=0,this._characters=[],this._lines=[],this._tags=[],this.areTagsValid=!0,this._defaultSettings=new pc.EditableSettings(null,0,0,new pc.Color,0),this._currentSettings=new pc.EditableSettings(null,0,0,new pc.Color,0),this._measureSettings=new pc.EditableSettings(null,0,0,new pc.Color,0),this._recursiveCounter=0,this._measures=null,this._originalMeasures=null,this._recursiveLimit=10,this.graphicsDevice=pc.Application.getApplication().graphicsDevice,this};s.fontRatio=3.75;let r=null;return s.createEmptyMesh=function(){const e=pc.Application.getApplication().graphicsDevice,i=new pc.VertexFormat(e,t),n=new pc.VertexBuffer(e,i,0),s=new pc.Mesh(!0);return s.vertexBuffer=n,s.indexBuffer=[new pc.IndexBuffer(e,pc.INDEXFORMAT_UINT16,0)],s.primitive[0].type=pc.gfx.PRIMITIVE_TRIANGLES,s.primitive[0].base=0,s.primitive[0].count=0,s.primitive[0].indexed=!0,s},pc.extend(s.prototype,{_reset:function(){this._bufferSize=0,this._buffer=new Float32Array(0)},_textIndexBuffer:function(){if(r)return r;r=new pc.IndexBuffer(this.graphicsDevice,pc.INDEXFORMAT_UINT16,32768);const t=new Uint16Array(r.lock());let e=0;for(let i=0;i<32762;i+=6)t[i+0]=e+3,t[i+1]=e+0,t[i+2]=e+1,t[i+3]=e+1,t[i+4]=e+3,t[i+5]=e+2,e+=4;return r.unlock(),r.destroy=function(){},r},populate:function(t,e){e._font?(this._updateSettings(e),this._updateText(t),e._dirtyOffset=this._dirtyOffset,e._dirtyVertices=this._dirtyVertices,e._metrics=this._metrics,this._dirtyVertices&&this._fillMesh(),this._dirtyOffset&&this._updateAligns()):this.vertexCount=0},updateMesh:function(t,e,i){i=i||pc.Vec3.ZERO;const n=this._vertexCount,s=t.vertexBuffer;for(let t=0;t<n;t++)this._buffer[11*t+0]+=i.x-this._bakedOffset.x,this._buffer[11*t+1]+=i.y-this._bakedOffset.y,this._buffer[11*t+2]+=i.z-this._bakedOffset.z;for(let t=0;t<this._lines.length;t++){this._lines[t].topY+=i.y-this._bakedOffset.y}for(let t=0;t<this._characters.length;t++){this._characters[t].cursorPos.sub(this._bakedOffset).add(i)}s.numVertices=n,s.storage=this._buffer.buffer,s.unlock(),t.primitive[0].type=pc.gfx.PRIMITIVE_TRIANGLES,t.primitive[0].base=0,t.primitive[0].count=n/4*6,t.primitive[0].indexed=!0,t.indexBuffer[0]=this._textIndexBuffer(),this._bakedOffset.copy(i)},_updateAligns:function(t){t=t||this._measureText(this._text,void 0,!1);const e=this._font.data,i=e.info.lineHeight*this._fontScale,n=Math.floor(this._bounds.y/i),s=(this._verticalOverflow?t.length:Math.min(t.length,n>0?n:1))*i;let r=this._fontSize/e.info.fontSize;this._bestFit&&(r=this._minFontSize/e.info.fontSize);let o=-1;for(let e=0;e<t.length;e++)o=Math.max(t[e].width,o);this._metrics.set(Math.ceil(o/this._fontScale*r),Math.ceil(s/this._fontScale*r),Math.ceil(this._metrics.z),Math.ceil(this._metrics.w)),0===this._fontScale&&(this._metrics.x=0,this._metrics.y=0);const a=this._bounds.y;let u=0;switch(this._verticalAlign){case pc.TEXT_VERTICAL_ALIGN_BOTTOM:u=a-s;break;case pc.TEXT_VERTICAL_ALIGN_MIDDLE:u=.5*(a-s);break;case pc.TEXT_VERTICAL_ALIGN_TOP:u=0}this._offset.set(0,a-u-i,0),this._dirtyOffset=!1},applyTags:function(t,e,i,n){if(this.areTagsValid)for(let s=0;s<this._tags.length;s++){const r=this._tags[s];t===r.startIndex&&r.apply(e,i,n)}},_fillMesh:function(){this._characters.length=0,this._lines.length=0;const t=this._font.data;let e=this._text;e=e.replace(/\r\n/gm,"\n").replace(/\n\r/gm,"\n"),e=e.replace(/\t/gm,"    "),e=pc.TextTag.extractTags(e,this),this._bakedOffset.set(0,0,0),this._fontScale=this._fontSize/t.info.fontSize,0===this._recursiveCounter&&(this._measures=this._measureText(e,1e15,!1));let i=-1,n=0;for(let e=0;e<this._measures.length;e++)i=Math.max(i,this._measures[e].width),n+=t.info.lineHeight*this._measures[e].fontScale;let s=Math.min(this._bounds.x/i,this._bounds.y/n),r=Math.min(this._maxFontSize,t.info.fontSize*s);this._metrics.set(0,0,i,n);const o=this._bestFit&&!this._verticalOverflow;if(o&&this._bounds.x>0){this._metrics.set(0,0,i/this._fontSize*this._maxFontSize,n/this._fontSize*this._maxFontSize);const o=e.split("\n").length;if(0===this._recursiveCounter){s=this._bounds.y/(o*t.info.lineHeight),r=t.info.fontSize*s;const e=Math.max(Math.min(this._maxFontSize,r),this._minFontSize);this._fontScale=e/t.info.fontSize}}if(this._horizontalWrap){if(this._recursiveCounter>=this._recursiveLimit)return;if(this._measures=this._measureText(e,this._bounds.x,!0),this.measureAlignment(),this._recursiveCounter+=1,o){this._maxFontSize-this._minFontSize>.051&&this._fontSize<this._maxFontSize&&(this._recursiveCounter-1==0?this._fontSize=this._minFontSize:this._minFontSize=this._fontSize,this._fontSize+=Math.max((this._maxFontSize-this._fontSize)/2,.05),this._fontSize=Math.floor(20*Math.min(this._fontSize,this._maxFontSize)+.5)/20,this._fillMesh())}}else this._measureText(e,1e15,!0),this.measureAlignment()},measureAlignment(){let t=0,s=0;let r=0;this._defaultSettings.init(this._font,this._fontSize,this._fontScale,this._color,0),this._currentSettings.init(this._font,this._fontSize,this._fontScale,this._color,0);const o=this._font.data;let a=0,u=0,c=0;if(null!==this._measures){for(let h=0;h<this._measures.length;h++){const l=this._measures[h];switch(a=u,this._align){case pc.TEXT_ALIGN_LEFT:t=0;break;case pc.TEXT_ALIGN_CENTER:t=.5*(this._bounds.x-l.width);break;case pc.TEXT_ALIGN_RIGHT:t=this._bounds.x-l.width}const p=o.info.lineHeight*this._currentSettings.fontScale;if(!this._verticalOverflow&&0!==this._bounds.y&&-(s-p)>this._bounds.y+1){if(this._bestFit&&this._fontSize>this._minFontSizeOriginal&&(this._recursiveCounter>0||this._fontSize===this._maxFontSize)){if(this._maxFontSize=this._fontSize,this._fontSize-=Math.max((this._fontSize-this._minFontSize)/2,.05),this._fontSize=Math.floor(20*Math.max(this._fontSize,this._minFontSize)+.5)/20,this._recursiveCounter>=this._recursiveLimit)return;return void this._fillMesh()}0===h&&console.warn("[Rendering] Text will be hidden, as there are not enough space even for 1 line!\nSet BestFit or enable vertical overflow");continue}let d=o.info.lineHeight*l.fontScale;s-=d-o.info.lineHeight*this._measures[Math.max(h-1,0)].fontScale;for(let a=0;a<l.text.length;a++){this.applyTags(c,this._currentSettings,this._defaultSettings,o.info.fontSize),d=o.info.lineHeight*this._currentSettings.fontScale;const h=l.text.charCodeAt(a);let p=0,f=0,y=0;const m=o.chars[h];if(!m)continue;p=m.xoffset*this._currentSettings.fontScale,f=m.yoffset*this._currentSettings.fontScale,y=m.xadvance*this._currentSettings.fontScale;const _=m.width*this._currentSettings.fontScale,g=m.height*this._currentSettings.fontScale,A=s+d,E=d;e.set(t+p,A-f-g,0),i.set(t+p+_,A-f,0),n.set(0,1-(f+g)/E,1,1-f/E),this.addCharToBuffer(r,e,i,m,n,this._currentSettings.color),this._characters.push(new pc.UICharInfo(new pc.Vec3(t+p,A-f-g,0).add(this._bakedOffset),_)),t+=y,r++,u++,c++}this._lines.push(new pc.UILineInfo(a,d,s+this._bakedOffset.y+d,0)),s-=this._lineHeight*o.info.lineHeight*l.fontScale,this.applyTags(c,this._currentSettings,this._defaultSettings,o.info.fontSize),c++}this._vertexCount=4*r,this._dirtyVertices=!1,this._updateAligns(this._measures),this._lineCount=this._measures.length,this.canvasRenderer&&this.canvasRenderer.cacheColors(this.mesh)}},addCharToBuffer(t,e,i,n,s,r){const o=4*t,a=11*(o+0),u=11*(o+1),c=11*(o+2),h=11*(o+3);this._buffer[a]=e.x,this._buffer[a+1]=e.y,this._buffer[a+2]=e.z,this._buffer[a+3]=n.uvBottomLeft[0],this._buffer[a+4]=n.uvBottomLeft[1],this._buffer[a+5]=s.x,this._buffer[a+6]=s.y,this._buffer[a+7]=r.r,this._buffer[a+8]=r.g,this._buffer[a+9]=r.b,this._buffer[a+10]=r.a,this._buffer[u]=e.x,this._buffer[u+1]=i.y,this._buffer[u+2]=e.z,this._buffer[u+3]=n.uvTopLeft[0],this._buffer[u+4]=n.uvTopLeft[1],this._buffer[u+5]=s.x,this._buffer[u+6]=s.w,this._buffer[u+7]=r.r,this._buffer[u+8]=r.g,this._buffer[u+9]=r.b,this._buffer[u+10]=r.a,this._buffer[c]=i.x,this._buffer[c+1]=i.y,this._buffer[c+2]=e.z,this._buffer[c+3]=n.uvTopRight[0],this._buffer[c+4]=n.uvTopRight[1],this._buffer[c+5]=s.z,this._buffer[c+6]=s.w,this._buffer[c+7]=r.r,this._buffer[c+8]=r.g,this._buffer[c+9]=r.b,this._buffer[c+10]=r.a,this._buffer[h]=i.x,this._buffer[h+1]=e.y,this._buffer[h+2]=e.z,this._buffer[h+3]=n.uvBottomRight[0],this._buffer[h+4]=n.uvBottomRight[1],this._buffer[h+5]=s.z,this._buffer[h+6]=s.y,this._buffer[h+7]=r.r,this._buffer[h+8]=r.g,this._buffer[h+9]=r.b,this._buffer[h+10]=r.a},measureText:function(t,e,i){if(t=t||"",this._updateSettings(i),!this._font)return pc.Vec2.ZERO;const n=this._font.data;this._fontScale=this._fontSize/n.info.fontSize,t=pc.TextTag.removeTags(t);const s=this._measureText(t,e,!1);let r=-1;for(let t=0;t<s.length;t++)r=Math.max(r,s[t].width);const o=s.length*n.info.lineHeight*this._fontScale;return new pc.Vec2(r,o)},_measureText:function(t,e,i){const n=this._font.data,s=[],r=t.replace("\n\r","\n").replace("\r\n","\n").split(/\n/);let o="";const a=n.chars[" ".charCodeAt(0)];let u=a?a.xadvance*this._fontScale:0;this._defaultSettings.init(this._font,this._fontSize,this._fontScale,this._color,0),this._currentSettings.init(this._font,this._fontSize,this._fontScale,this._color,0),this._measureSettings.init(this._font,this._fontSize,this._fontScale,this._color,0);let c=0,h=0;const l={maxFontScale:0};this._measureSettings.copy(this._currentSettings);for(let t=0;t<r.length;t++){let p=r[t].split(" ");this._measureSettings.copy(this._currentSettings),p=this._checkBigWords(p,n,this._fontScale,e,c,this._measureSettings,this._defaultSettings,n.info.fontSize,i);let d=0;for(let t=0;t<p.length;t++){const i=p[t],r=this._calculateWidth(i,n,this._fontScale,c,this._currentSettings,this._defaultSettings,n.info.fontSize,l);d>0&&d+r>e&&(u=a?a.xadvance*this._currentSettings.fontScale:0,o=o.substring(0,o.length-1),d-=u,s.push(new pc.MeasuredLine(o,d,h)),h=0,o="",d=0,c++),h=Math.max(h,l.maxFontScale),c+=i.length,o+=i+" ",u=a?a.xadvance*this._currentSettings.fontScale:0,d+=r+u,this.applyTags(c,this._currentSettings,this._defaultSettings,n.info.fontSize),c++}o=o.substring(0,o.length-1),d-=u,s.push(new pc.MeasuredLine(o,d,h)),h=0,o="",d=0}return s},getMeasuredText:function(t){return t.map(t=>t.text).join("\n")},_calculateWidth:function(t,e,i,n,s,r,o,a){let u=0;for(let i=0;i<t.length;i++){this.applyTags(n,s,r,o),a&&(a.maxFontScale=Math.max(a.maxFontScale,s.fontScale));const c=t.charCodeAt(i),h=e.chars[c];h&&(u+=h.xadvance*s.fontScale),n++}return 0===t.length&&a&&(a.maxFontScale=i),u},_splitWord:function(t,e,i,n){const s=[];let r=0,o=0;for(;o<t.length;){const a=t.charCodeAt(o),u=e.chars[a],c=(u?u.xadvance:0)*i;if(u){if(r>0&&r+c>=n){const e=t.substring(0,o);t=t.substring(o),r=c,o=1,s.push(e);continue}r+=c}o++}return s.push(t),s},_checkBigWords:function(t,e,i,n,s,r,o,a,u){const c=[];for(let h=0;h<t.length;h++){const l=t[h];if(this._calculateWidth(l,e,i,s,r,o,a)>n){const t=this._splitWord(l,e,i,n);for(let e=0;e<t.length;e++)c.push(t[e]),s+=t[e].length,u&&e!==t.length-1&&this.applyTagsOffsets(s,1)}else c.push(l)}return c},applyTagsOffsets(t,e){for(let i=0;i<this._tags.length;i++){const n=this._tags[i];n.startIndex<t||(n.startIndex+=e)}},_updateText:function(t){this._text!==t&&(this._dirtyVertices=!0,this._dirtyOffset=!0),this._text=t,this._resizeBuffers(t.length)},_updateSettings:function(t){this._verticalAlign!==t.verticalAlign&&(this._dirtyOffset=!0),this._fontSize===t.fontSize&&this._bestFit===t.bestFit&&this._font===t.font&&this._maxFontSize===t.maxFontSize&&this._minFontSize===t.minFontSize&&this._horizontalWrap===t.horizontalWrap&&this._verticalOverflow===t.verticalOverflow&&this._lineHeight===t.lineHeight&&this._fontSize===t.fontSize&&this._align===t.align&&this._color.equals(t.color)||(this._dirtyVertices=!0,this._dirtyOffset=!0),this._bounds&&this._bounds.x===t.bounds.x&&this._bounds.y===t.bounds.y||(this._dirtyOffset=!0,(this._horizontalWrap||this._bestFit||this._align!==pc.TEXT_ALIGN_LEFT)&&(this._dirtyVertices=!0)),this._verticalAlign=t.verticalAlign,this._fontSize=t.fontSize,this._bestFit=t.bestFit,this._font=t.font,this._align=t.align,this._maxFontSize=t.maxFontSize,this._minFontSize=t.minFontSize,this._minFontSizeOriginal=t.minFontSize,this._maxFontSizeOriginal=t.maxFontSize,this._horizontalWrap=t.horizontalWrap,this._verticalOverflow=t.verticalOverflow,this._recursiveCounter=0,this._measures=null,this._originalMeasures=null,this._recursiveLimit=10,this._bounds.copy(t.bounds),this._lineHeight=t.lineHeight,this._color.copy(t.color)},_resizeBuffers:function(t){this._bufferSize=t,this._buffer=new Float32Array(44*t)},populateWithErrors:function(t,e,i){e.bestFit=e.resizeTextForBestFit,e.font=e.font.handle,e.maxFontSize=e.resizeTextMaxSize,e.minFontSize=e.resizeTextMinSize,e.lineHeight=e.lineSpacing,e.horizontalWrap=!(0===e.horizontalOverflow),e.bounds=e.generationExtents,e.verticalAlign="top",e.align=pc.TEXT_ALIGN_LEFT,e._bestFit=e.resizeTextForBestFit,e._fontSize=e.fontSize,e._font=e.font,e._maxFontSize=e.resizeTextMaxSize,e._minFontSize=e.resizeTextMinSize,e._lineHeight=e.lineSpacing,e._verticalOverflow=e.verticalOverflow,e._horizontalWrap=!(0===e.horizontalOverflow),e._bounds=e.generationExtents,e._verticalAlign="top",e._align=pc.TEXT_ALIGN_LEFT,this.populate(t,e)}}),Object.defineProperty(s.prototype,"offset",{get:function(){return this._offset}}),Object.defineProperty(s.prototype,"vertexCount",{get:function(){return this._vertexCount}}),Object.defineProperty(s.prototype,"lineCount",{get:function(){return this._lineCount}}),Object.defineProperty(s.prototype,"characterCount",{get:function(){return this._characters.length}}),Object.defineProperty(s.prototype,"lines",{get:function(){return this._lines}}),Object.defineProperty(s.prototype,"characters",{get:function(){return this._characters}}),{TextGenerator:s}}()),pc.extend(pc.Entity.prototype,{sendMessageToScripts:function(t,e,i){const n=this._unityComponents.monoBehaviour;if(0!==n.length&&t)for(let s=0;s<n.length;s++){const r=n[s].code;if(r!==i)try{if(r&&r[t]){const i=r[t].apply(r,e);i&&"Bridge.GeneratorEnumerator"===i.$$fullname&&new UnityEngine.Coroutine(i,r.handle)}}catch(t){console.error(t)}}},_elementDimesionsChange:function(){for(let t=0;t<this._dimensionListeners.length;t++)this._dimensionListeners[t].OnRectTransformDimensionsChange()},sendPhysicsEvent:function(t,e){if(!this._magicMethods)return!1;const i=this._magicMethods[t];if(!i)return!1;for(let n=0;n<i.length;n++){const s=i[n];try{s.code[t].call(s.code,e)}catch(t){console.error(t)}}return!0},getScene:function(){const t=this.parent;return t?t.scene?t.scene:t.getScene():null},removeOrReparent:function(t,e){if(null===t)if(e){const t=this.getWorldTransform().clone();let e=this.getScene();e||(e=window.$scene),this.reparent(e.root,-1),this.setLocalTransform(t)}else this.parent.removeChild(this);else this.reparent(t,-1)},allChildren:function(t){t=t||[];for(let e=0;e<this.children.length;e++)this.children[e].allChildren&&(t.push(this.children[e]),this.children[e].allChildren(t));return t},parents:function(){const t=[];let e=this.parent;for(;null!=e;)t.push(e),e=e.parent;return t},getComponents:function(t){const e=[];if(!t){this.c=this.c||[];for(const t in this.c)this.c.hasOwnProperty(t)&&"script"!==t&&e.push(this.c[t]);if(this.c.script&&this.c.script.scripts)for(let t=0;t<this.c.script.scripts.length;t++)e.push(this.c.script.scripts[t])}for(const t in this._unityComponents){if(!this._unityComponents.hasOwnProperty(t))continue;const i=this._unityComponents[t];for(const t in i)i.hasOwnProperty(t)&&e.push(i[t])}return e},getUnityComponents:function(t){const e=[],i=this._unityComponents;if(!i)return e;for(let n=0,s=t.length;n<s;++n){const s=t[n];if(!i.hasOwnProperty(s))continue;const r=i[s];for(const t in r)r.hasOwnProperty(t)&&e.push(r[t])}return e},getUnityComponent:function(t){return this._unityComponents&&this._unityComponents[t][0]||null},collectAllUnityComponents:function(){const t=this._app.systems.unity.systemIds;let e=this.getUnityComponents(t);const i=this.allChildren();for(let n=0;n<i.length;n++)e=i[n].getUnityComponents(t).concat(e);return e}}),pc.Camera.prototype._getProjectionMatrix=pc.Camera.prototype.getProjectionMatrix,pc.extend(pc.Camera.prototype,{getProjectionMatrix:function(){const t=this._projMatDirty;if(this._projMatDirty&&this._projMatOverride?this._projMat.copy(this._projMatOverride):this._getProjectionMatrix(),t){const t=this._nearClip,e=this._farClip,i=this.aspectRatio,n=this.orthoHeight;this._shaderParams[0]=1/e,this._shaderParams[1]=e,this._shaderParams[2]=(1-e/t)/2,this._shaderParams[3]=(1+e/t)/2,this._orthoParams[0]=n*i,this._orthoParams[1]=n,this._orthoParams[2]=0,this._orthoParams[3]=this.projection===pc.PROJECTION_ORTHOGRAPHIC?1:0,this._zbufferParams[0]=1-e/t,this._zbufferParams[1]=e/t,this._zbufferParams[2]=this._zbufferParams[0]/e,this._zbufferParams[3]=this._zbufferParams[1]/e,this._projectionParams[0]=1,this._projectionParams[1]=t,this._projectionParams[2]=e,this._projectionParams[3]=1/e,this._updateScreens(),this._projInvMat.copy(this._projMat),this._projInvMat.invert(),this._vpDirty=!0}return this._projMat},setProjectionMatrix:function(t){this._projMatOverride=t?t.clone():null,this._projMatDirty=!0,this._vpDirty=!0},_updateScreens:function(){const t=pc.Application.getApplication().scene.worldScreens;for(let e=0;e<t.length;e++){const i=t[e];i.screenType===pc.SCREEN_TYPE_CAMERA&&i._calcProjectionMatrix()}}}),function(){const t=[null,null,pc.Vec2,pc.Vec3,pc.Vec4],e=new Float32Array([1,1,1,1]),i=new Float32Array([0,0,0,0]),n=new Float32Array([0,0,0,1]),s=new Float32Array([1,0,0,1]),r=new Float32Array([0,0,1,1]);pc.extend(pc.MeshInstance.prototype,{updateKey:function(){const t=this.material,e=t?t.renderQueue:null,i=t?t.blendType:null,n=2e7-1e3*(e||2e3)+(t?t.id:0);this._key[pc.SORTKEY_FORWARD]=function(t,e,i,n){return(15&t)<<27|(e===pc.BLEND_NONE?1:0)<<26|(i?1:0)<<25|(33554431&n)<<0}(this.layer,i||pc.BLEND_NORMAL,!1,n)},configureLightmap:function(){const t=UnityEngine.LightmapSettings.manager.getLightmap(this.lightmapSceneIndex,this.lightmapIndex);t&&t.lightmapColor?this.setParameter("unity_Lightmap",t.lightmapColor.handle):this.setParameter("unity_Lightmap",null),(this._shaderDefs&pc.SHADERDEF_DIRLM)>0&&(t&&t.lightmapDirection?this.setParameter("unity_LightmapInd",t.lightmapDirection.handle):this.setParameter("unity_LightmapInd",null))}}),Object.defineProperty(pc.MeshInstance.prototype,"renderQueue",{get:function(){return this.material?this.material.renderQueue:2e3}}),Object.defineProperty(pc.MeshInstance.prototype,"isIndexBufferEmpty",{get:function(){return this.mesh.indexBuffer[0].length<=0}}),pc.extend(pc.Mesh.prototype,{allStreams:[{semantic:pc.SEMANTIC_POSITION,components:3,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_NORMAL,components:3,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_TANGENT,components:4,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_BLENDWEIGHT,components:4,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_BLENDINDICES,components:4,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_COLOR,components:4,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_TEXCOORD0,components:2,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_TEXCOORD1,components:2,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_TEXCOORD2,components:2,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_TEXCOORD3,components:2,type:pc.ELEMENTTYPE_FLOAT32}],defaultStreams:[!0,!1,!1,!1,!1,!1,!1,!1,!1,!1],uiVertexSemantics:[{semantic:pc.SEMANTIC_POSITION,components:3,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_NORMAL,components:3,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_TANGENT,components:4,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_COLOR,components:4,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_TEXCOORD0,components:2,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_TEXCOORD1,components:2,type:pc.ELEMENTTYPE_FLOAT32}],destroy:function(){this.vertexBuffer&&(this.vertexBuffer.destroy(),this.vertexBuffer=null);for(let t=0;t<this.indexBuffer.length;t++)this.indexBuffer[t]&&this.indexBuffer[t].destroy(),this.indexBuffer=[]},defaultVertexBuffer:function(t,e,i){const n=[];for(let e=0;e<t.length;e++)t[e]&&n.push(this.allStreams[e]);const s=new pc.VertexFormat(UnityEngine.Graphics.graphicsDevice,n);return new pc.VertexBuffer(UnityEngine.Graphics.graphicsDevice,s,e,this.bufferUsage||pc.BUFFER_STATIC,i)},getDescriptionForSemantics:function(t,e){if(e)return{semantic:t,components:e,type:pc.ELEMENTTYPE_FLOAT32};for(let e=0;e<this.allStreams.length;e++)if(this.allStreams[e].semantic===t)return this.allStreams[e];throw new Error("Unknown or unsupported semantic requested: "+t)},defaultIndexBuffer:function(t,e){return new pc.IndexBuffer(UnityEngine.Graphics.graphicsDevice,pc.INDEXFORMAT_UINT16,t,this.bufferUsage||pc.BUFFER_STATIC,e)},markDynamic:function(){this.vertexBuffer&&(this.vertexBuffer.lock(),this.vertexBuffer.usage=pc.BUFFER_DYNAMIC,this.vertexBuffer.unlock()),this.indexBuffer[0]&&(this.indexBuffer[0].lock(),this.indexBuffer[0].usage=pc.BUFFER_DYNAMIC,this.indexBuffer[0].unlock()),this.bufferUsage=pc.BUFFER_DYNAMIC},uploadMeshData:function(){this.vertexBuffer&&this.vertexBuffer.unlock();for(let t=0;t<this.subMeshes.length;t++){const e=this.subMeshes[t];e.vertexBuffer=this.vertexBuffer,e.indexBuffer[0]&&e.indexBuffer[0].unlock()}},clear:function(){this.vertexBuffer&&this.vertexBuffer.resize(0),this.indexBuffer[0]&&this.indexBuffer[0].resize(0),this.subMeshes=[this],this.version++},setIndicies:function(t,e,i,n,s){this.subMeshes.length>=i&&this.setSubMeshCount(i+1);const r=this.subMeshes[i];let o=null;switch(e){case UnityEngine.MeshTopology.Triangles:o=pc.gfx.PRIMITIVE_TRIANGLES;break;case UnityEngine.MeshTopology.Lines:o=pc.gfx.PRIMITIVE_LINES;break;case UnityEngine.MeshTopology.LineStrip:o=pc.gfx.PRIMITIVE_LINESTRIP;break;case UnityEngine.MeshTopology.Points:o=pc.gfx.PRIMITIVE_POINTS}if(null===o)throw new Error("Unknown or unsupported topology "+e+" passed!");r.primitive[0].type=o,r.primitive[0].base=s,r.primitive[0].count=t.length,r.primitive[0].indexed=!0,r.vertexBuffer=this.vertexBuffer,r.indexBuffer[0]=r.indexBuffer[0]||new pc.IndexBuffer(UnityEngine.Graphics.graphicsDevice,pc.INDEXFORMAT_UINT16,0,pc.BUFFER_STATIC),r.indexBuffer[0].resize(t.length),new Uint16Array(r.indexBuffer[0].lock()).set(t),!1!==n&&this.recalculateBounds(),this.uploadMeshData(),this.version++},getIndicies:function(t){const e=this.subMeshes[t];return new Uint16Array(e.indexBuffer[0].lock())},getUVInTriangle:function(t,e){const i=this.vertexBuffer,n=new pc.Vec2;let s=3*t;if(!i)return n;const r=i.format.getStructureFor(pc.SEMANTIC_TEXCOORD0);let o=0,a=this.subMeshes[o].indexBuffer[0].storage;for(;s>=a.length;)s-=a.length,o++,a=this.subMeshes[o].indexBuffer[0].storage;if(r.offset<0)return n;const u=(a[s+e]*r.stride+r.offset)/4,c=new Float32Array(i.storage);return n.set(c[u+0],c[u+1]),n},getVectorStream:function(e,i,n){const s=this.vertexBuffer;if(!s)return;const r=s.format.getStructureFor(i);if(r.offset<0)return;const o=new Float32Array(s.storage),a=new Array(s.numVertices);let u=0;for(let e=r.offset/4;e<o.length;e+=r.stride/4){const i=new t[n];i.x=o[e+0],i.y=o[e+1],n>2&&(i.z=o[e+2]),n>3&&(i.w=o[e+3]),a[u++]=i}e._items=a,e._size=a.length},setVectorStream:function(t,e,i){if(!t||0===t._size)return void this.disableSemantic(e);this.enableSemantic(e);const n=this.vertexBuffer;n.resize(Math.max(t._size,n.numVertices));const s=n.format.getStructureFor(e),r=new Float32Array(n.storage);let o=0;const a=t._size*s.stride/4;switch(i){case 2:for(let e=s.offset/4;e<a;e+=s.stride/4){const i=t._items[o++];r[e+0]=i.x,r[e+1]=i.y}break;case 3:for(let e=s.offset/4;e<a;e+=s.stride/4){const i=t._items[o++];r[e+0]=i.x,r[e+1]=i.y,r[e+2]=i.z}break;case 4:for(let e=s.offset/4;e<a;e+=s.stride/4){const i=t._items[o++];r[e+0]=i.x,r[e+1]=i.y,r[e+2]=i.z,r[e+3]=i.w}}this.meshInstance&&this.meshInstance._aabbVer++,this.uploadMeshData(),this.version++},getColorStream:function(t,e,i){const n=this.vertexBuffer;if(!n)return;const s=n.format.getStructureFor(e);if(s.offset<0)return;const r=new Float32Array(n.storage),o=new Array(n.numVertices);let a=0;for(let t=s.offset/4;t<r.length;t+=s.stride/4){const e=new pc.Color;e.r=r[t+0]*i,e.g=r[t+1]*i,e.b=r[t+2]*i,e.a=r[t+3]*i,o[a++]=e}t._items=o,t._size=o.length},getUIVertexStream:function(t,e){if(t._size=0,e._size=0,!this.vertexBuffer||!this.indexBuffer[0])return;t._size=t._items.length=this.vertexBuffer.numVertices,e._size=e._items.length=this.primitive[0].count,e._items=Array.from(new Uint16Array(this.indexBuffer[0].storage));const i=new Float32Array(this.vertexBuffer.storage),n=this.vertexBuffer.format.size/4,s=this.vertexBuffer.format.getStructureFor(pc.SEMANTIC_POSITION,!0),r=this.vertexBuffer.format.getStructureFor(pc.SEMANTIC_NORMAL,!0),o=this.vertexBuffer.format.getStructureFor(pc.SEMANTIC_TANGENT,!0),a=this.vertexBuffer.format.getStructureFor(pc.SEMANTIC_COLOR,!0),u=this.vertexBuffer.format.getStructureFor(pc.SEMANTIC_TEXCOORD0,!0),c=this.vertexBuffer.format.getStructureFor(pc.SEMANTIC_TEXCOORD1,!0);for(let e=0;e<i.length;e+=n){const h=new UnityEngine.UIVertex;let l=-1;t._items[e/n|0]=h,(l=s.offset)>=0&&h.position.set(i[e+l+0],i[e+l+1],i[e+l+2]),(l=r.offset)>=0&&h.normal.set(i[e+l+0],i[e+l+1],i[e+l+2]),(l=o.offset)>=0&&h.tangent.set(i[e+l+0],i[e+l+1],i[e+l+2],i[e+l+3]),(l=a.offset)>=0&&(h.color.r=255*i[e+l+0]|0,h.color.g=255*i[e+l+1]|0,h.color.b=255*i[e+l+2]|0,h.color.a=255*i[e+l+3]|0),(l=u.offset)>=0&&h.uv0.set(i[e+l+0],i[e+l+1]),(l=c.offset)>=0&&h.uv1.set(i[e+l+0],i[e+l+1])}},setUIVertexStream:function(t,e){if(this.vertexBuffer){const t=this.uiVertexSemantics,e=this.vertexBuffer.format;if(e.elements.length!==t.length)this.vertexBuffer.destroy(),this.vertexBuffer=null;else for(let i=0;i<t.length;i++)if(e.elements[i].name!==t[i].semantic){this.vertexBuffer.destroy(),this.vertexBuffer=null;break}}if(!this.vertexBuffer){const e=new pc.VertexFormat(UnityEngine.Graphics.graphicsDevice,this.uiVertexSemantics);this.vertexBuffer=new pc.VertexBuffer(UnityEngine.Graphics.graphicsDevice,e,t._size,this.bufferUsage||pc.BUFFER_STATIC,null)}e._items.length=e._size,this.setIndicies(e._items,UnityEngine.MeshTopology.Triangles,0,!0,0),this.vertexBuffer.resize(t._size);const i=new Float32Array(this.vertexBuffer.storage);for(let e=0;e<i.length;e+=18){const n=t._items[e/18];i[e+0]=n.position.x,i[e+1]=n.position.y,i[e+2]=n.position.z,i[e+3]=n.normal.x,i[e+4]=n.normal.y,i[e+5]=n.normal.z,i[e+6]=n.tangent.x,i[e+7]=n.tangent.y,i[e+8]=n.tangent.z,i[e+9]=n.tangent.w,i[e+10]=n.color.r/255,i[e+11]=n.color.g/255,i[e+12]=n.color.b/255,i[e+13]=n.color.a/255,i[e+14]=n.uv0.x,i[e+15]=n.uv0.y,i[e+16]=n.uv1.x,i[e+17]=n.uv1.y}this.uploadMeshData(),this.primitive[0].type=pc.gfx.PRIMITIVE_TRIANGLES,this.primitive[0].base=0,this.primitive[0].count=e._items.length,this.primitive[0].indexed=!0},setColorStream:function(t,e,i){if(!t||0===t._size)return void this.disableSemantic(e);this.enableSemantic(e);const n=this.vertexBuffer;n.resize(Math.max(t._size,n.numVertices));const s=n.format.getStructureFor(e),r=new Float32Array(n.storage);let o=0;const a=t._size*s.stride/4,u=1/i;for(let e=s.offset/4;e<a;e+=s.stride/4){const i=t._items[o++];r[e+0]=i.r*u,r[e+1]=i.g*u,r[e+2]=i.b*u,r[e+3]=i.a*u}this.uploadMeshData(),this.version++},initializeBuffers:function(){this.destroy(),this.vertexBuffer=new pc.VertexBuffer(UnityEngine.Graphics.graphicsDevice,new pc.VertexFormat(UnityEngine.Graphics.graphicsDevice,[]),0),this.vertexBuffer.numBytes=0,this.vertexBuffer.numVertices=0,this.indexBuffer=[new pc.IndexBuffer(UnityEngine.Graphics.graphicsDevice,pc.INDEXFORMAT_UINT16,0,pc.BUFFER_STATIC)]},enableSemantic:function(t){let e=this.vertexBuffer;e||(e=new pc.VertexBuffer(UnityEngine.Graphics.graphicsDevice,new pc.VertexFormat(UnityEngine.Graphics.graphicsDevice,[]),0),e.numBytes=0,e.numVertices=0,this.vertexBuffer=e);const i=e.format;if(i.getStructureFor(t).offset>=0)return;const n=new Float32Array(e.storage),s=[];for(let t=0;t<i.elements.length;t++){const e=i.elements[t];s.push({semantic:e.name,type:e.dataType,components:e.numComponents,normalize:e.normalize})}s.push(this.getDescriptionForSemantics(t));const r=new pc.VertexFormat(UnityEngine.Graphics.graphicsDevice,s),o=new Float32Array(r.size/4*e.numVertices);for(let t=0;t<e.numVertices;t++)for(let e=0;e<i.size/4;e++)o[t*r.size/4+e]=n[t*i.size/4+e];e.invalidateBuffer();const a=e.numVertices*e.format.size;e.device._vram.vb+=a-e.numBytes,e.format=r,e.numBytes=a,e.storage=o.buffer},disableSemantic:function(t){const e=this.vertexBuffer;if(!e)return;const i=e.format;if(i.getStructureFor(t).offset<0)return;const n=this.getDescriptionForSemantics(t),s=new Float32Array(e.storage),r=[];for(let e=0;e<i.elements.length;e++){const n=i.elements[e];n.name!==t&&r.push({semantic:n.name,type:n.dataType,components:n.numComponents,normalize:n.normalize})}const o=new pc.VertexFormat(UnityEngine.Graphics.graphicsDevice,r),a=new Float32Array(o.size/4*e.numVertices);let u=0;for(let t=0;t<e.numVertices;t++){const e=t-Math.floor(t/(o.size/4));e>=n.offset&&e<n.offset+n.components||(a[u++]=s[t])}e.invalidateBuffer();const c=e.numVertices*e.format.size;e.device._vram.vb+=c-e.numBytes,e.format=o,e.numBytes=c,e.storage=a.buffer},recalculateBounds:function(){const t=new pc.Vec3,e=this.vertexBuffer.format.getStructureFor(pc.SEMANTIC_POSITION,!0);if(e.offset<0)return void this._aabb.setMinMax(pc.Vec3.ZERO,pc.Vec3.ZERO);const i=new Float32Array(this.vertexBuffer.lock());this._aabb.setToInfinity();for(let n=0;n<this.subMeshes.length;n++){const s=new pc.Vec3(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),r=new pc.Vec3(-Number.MAX_SAFE_INTEGER,-Number.MAX_SAFE_INTEGER,-Number.MAX_SAFE_INTEGER),o=this.subMeshes[n],a=new Uint16Array(o.indexBuffer[0].storage);for(let n=0;n<a.length;n++){const o=a[n]*e.stride+e.offset;t.set(i[o+0],i[o+1],i[o+2]),s.x=s.x>t.x?t.x:s.x,s.y=s.y>t.y?t.y:s.y,s.z=s.z>t.z?t.z:s.z,r.x=r.x<t.x?t.x:r.x,r.y=r.y<t.y?t.y:r.y,r.z=r.z<t.z?t.z:r.z}a.length>0?o._aabb.setMinMax(s,r):o._aabb.setToInfinity(),a.length>0&&(this._aabb.expandToPoint(s),this._aabb.expandToPoint(r))}},getVertexArrayObject:function(){if(this.vao)return this.vao;const t=UnityEngine.Graphics.graphicsDevice;this.vao=t.gl.createVertexArray(),t.gl.bindVertexArray(this.vao),this.vertexBuffer.unlock(),this.indexBuffer[0].unlock();const o=this.vertexBuffer.format;for(let e=0;e<16;e++)t.gl.disableVertexAttribArray(e);t.gl.vertexAttrib4fv(pc.ShaderAttributeSlots.POSITION,n),t.gl.vertexAttrib4fv(pc.ShaderAttributeSlots.COLOR,e),t.gl.vertexAttrib4fv(pc.ShaderAttributeSlots.TANGENT,s),t.gl.vertexAttrib4fv(pc.ShaderAttributeSlots.NORMAL,r),t.gl.vertexAttrib4fv(pc.ShaderAttributeSlots.TEXCOORD0,i);for(let e=0;e<o.elements.length;e++){const i=o.elements[e],n=pc.ShaderAttributeSlots[i.name];t.gl.enableVertexAttribArray(n),t.gl.vertexAttribPointer(n,i.numComponents,t.glType[i.dataType],i.normalize,i.stride,i.offset)}return t.gl.bindVertexArray(null),this.vao},setSubMeshCount:function(t){for(let e=t;e<this.subMeshes.length;e++)this.subMeshes[e]._refCount=-1/0;this.subMeshes.length=t;for(let e=0;e<t;e++)this.subMeshes[e]||(this.subMeshes[e]=new pc.Mesh(!0),this.subMeshes[e].vertexBuffer=this.vertexBuffer,this.subMeshes[e].indexBuffer=[new pc.IndexBuffer(UnityEngine.Graphics.graphicsDevice,pc.INDEXFORMAT_UINT16,0,pc.BUFFER_STATIC)]);this.version++},recalculateNormals:function(){this.enableSemantic(pc.SEMANTIC_NORMAL);const t=this.vertexBuffer.format.getStructureFor(pc.SEMANTIC_POSITION,!0),e=this.vertexBuffer.format.getStructureFor(pc.SEMANTIC_NORMAL,!0),i=new Float32Array(this.vertexBuffer.lock()),n=new pc.Vec3,s=new pc.Vec3,r=new pc.Vec3;let o=-1;for(let a=0;a<this.subMeshes.length;a++){if(this.getTopology(a)!==UnityEngine.MeshTopology.Triangles)throw new Error("Cannot recalculate normals for non-triangle mesh");const u=this.subMeshes[a],c=new Uint16Array(u.indexBuffer[0].storage);for(let a=0;a<c.length;a+=3)o=c[a+0]*t.stride+t.offset,n.set(i[o+0],i[o+1],i[o+2]),o=c[a+1]*t.stride+t.offset,s.set(i[o+0],i[o+1],i[o+2]),o=c[a+2]*t.stride+t.offset,r.set(i[o+0],i[o+1],i[o+2]),s.sub(r),n.sub(r),r.cross(n,s),o=c[a+0]*e.stride+e.offset,i[o+0]=r.x,i[o+1]=r.y,i[o+2]=r.z,o=c[a+1]*e.stride+e.offset,i[o+0]=r.x,i[o+1]=r.y,i[o+2]=r.z,o=c[a+2]*e.stride+e.offset,i[o+0]=r.x,i[o+1]=r.y,i[o+2]=r.z}this.vertexBuffer.unlock()},recalculateTangents:function(){const t=this.vertexBuffer.format.getStructureFor(pc.SEMANTIC_TEXCOORD0,!0);if(t.offset<0)return;this.enableSemantic(pc.SEMANTIC_TANGENT);const e=this.vertexBuffer.format.getStructureFor(pc.SEMANTIC_POSITION,!0),i=this.vertexBuffer.format.getStructureFor(pc.SEMANTIC_TANGENT,!0),n=new Float32Array(this.vertexBuffer.lock()),s=new pc.Vec3,r=new pc.Vec3,o=new pc.Vec3,a=new pc.Vec2,u=new pc.Vec2,c=new pc.Vec2,h=new pc.Vec3;let l=-1;for(let p=0;p<this.subMeshes.length;p++){if(this.getTopology(p)!==UnityEngine.MeshTopology.Triangles)throw new Error("Cannot recalculate tangents for non-triangle mesh");const d=this.subMeshes[p],f=new Uint16Array(d.indexBuffer[0].storage);for(let p=0;p<f.length;p+=3){l=f[p+0]*e.stride+e.offset,s.set(n[l+0],n[l+1],n[l+2]),l=f[p+1]*e.stride+e.offset,r.set(n[l+0],n[l+1],n[l+2]),l=f[p+2]*e.stride+e.offset,o.set(n[l+0],n[l+1],n[l+2]),l=f[p+0]*t.stride+t.offset,a.set(n[l+0],n[l+1]),l=f[p+1]*t.stride+t.offset,u.set(n[l+0],n[l+1]),l=f[p+2]*t.stride+t.offset,c.set(n[l+0],n[l+1]);const d=u.x-a.x,y=c.x-a.x,m=u.x-c.x,_=u.y-a.y,g=c.y-a.y,A=u.y-c.y,E=Math.abs(d)+Math.abs(_),b=Math.abs(y)+Math.abs(g),S=Math.abs(m)+Math.abs(A);E>b?E>S?(h.sub2(r,s),h.x*=d>0?1:-1,h.y*=_>0?1:-1):(h.sub2(o,r),h.x*=m>0?1:-1,h.y*=A>0?1:-1):b>S?(h.sub2(o,s),h.x*=y>0?1:-1,h.y*=g>0?1:-1):(h.sub2(o,r),h.x*=m>0?1:-1,h.y*=A>0?1:-1),l=f[p+0]*i.stride+i.offset,n[l+0]=h.x,n[l+1]=h.y,n[l+2]=h.z,n[l+3]=1,l=f[p+1]*i.stride+i.offset,n[l+0]=h.x,n[l+1]=h.y,n[l+2]=h.z,n[l+3]=1,l=f[p+2]*i.stride+i.offset,n[l+0]=h.x,n[l+1]=h.y,n[l+2]=h.z,n[l+3]=1}}this.vertexBuffer.unlock()},getVertexCount:function(){return this.vertexBuffer?this.vertexBuffer.numVertices:0},getTopology:function(t){const e=this.subMeshes[t];switch(e.primitive[0].type){case pc.gfx.PRIMITIVE_TRIANGLES:return UnityEngine.MeshTopology.Triangles;case pc.gfx.PRIMITIVE_LINES:return UnityEngine.MeshTopology.Lines;case pc.gfx.PRIMITIVE_LINESTRIP:return UnityEngine.MeshTopology.LineStrip;case pc.gfx.PRIMITIVE_POINTS:return UnityEngine.MeshTopology.Points}throw new Error("Mesh's topology is set to "+e.primitive[0].type+", which is not suppored by Unity API")},configureIndexBufferAsTriangleStrip:function(t,e){this.primitive[t].type=pc.gfx.PRIMITIVE_TRISTRIP,this.primitive[t].base=0,this.primitive[t].count=e,this.primitive[t].indexed=!0},configureIndexBufferAsTriangles:function(t,e){this.primitive[t].type=pc.gfx.PRIMITIVE_TRIANGLES,this.primitive[t].base=0,this.primitive[t].count=e,this.primitive[t].indexed=!0},clone:function(){const t=new pc.Mesh;t.name=this.name+" Instance",t.aabb.copy(this.aabb);const e=pc.ShaderAttributeSlots,i=[];Object.assign(i,this.defaultStreams);const n=this.vertexBuffer.format.elements;for(let t=0;t<n.length;t++)i[e[n[t].name]]=!0;const s=t.defaultVertexBuffer(i,this.getVertexCount(),this.vertexBuffer.storage.slice(0,this.vertexBuffer.storage.byteLength));t.vertexBuffer=s,t.subMeshes=[];for(let e=0;e<this.subMeshes.length;e++){const i=this.subMeshes[e],n=i.indexBuffer[0],r=n.storage.slice(0,n.storage.byteLength),o=new Uint16Array(r),a=new pc.Mesh(!0);a.aabb.copy(i.aabb);const u=t.defaultIndexBuffer(o.length,o);a.vertexBuffer=s,a.indexBuffer[0]=u,a.primitive[0].type=pc.gfx.PRIMITIVE_TRIANGLES,a.primitive[0].base=0,a.primitive[0].count=o.length,a.primitive[0].indexed=!0,t.subMeshes.push(a)}t.indexBuffer=t.subMeshes[0].indexBuffer,t.primitive[0].type=pc.gfx.PRIMITIVE_TRIANGLES,t.primitive[0].base=0,t.primitive[0].count=t.indexBuffer[0].numIndices,t.primitive[0].indexed=!0;for(let e=0;e<this.bindposes.length;e++)t.bindposes.push(this.bindposes[e].clone());return t}})}(),function(){const t=pc.Model;pc.Model=function(){t.call(this),this._lightmapIndex=-1,this._lightmapSceneIndex=0,this._lightmapScaleOffset=new pc.Vec4,this._sortingLayerIndex=0,this._sortingOrder=0,this._drawOrder=0,this._nearestScreen=null,this._stencil=null,this._element=null,this._visible=!0,this._parameters={},this._constAttributes={},this._isStatic=!1,this._needsUpdate=!0,this._masksChildren=!1},pc.Model.prototype=t.prototype,Object.defineProperty(pc.Model.prototype,"visible",{get:function(){return this._visible},set:function(t){this._visible=t,this._needsUpdate||this._updateVisibility()}}),Object.defineProperty(pc.Model.prototype,"stencil",{get:function(){return this._stencil},set:function(t){this._stencil=t,this._needsUpdate||this._updateStencil()}}),Object.defineProperty(pc.Model.prototype,"element",{get:function(){return this._element},set:function(t){this._element=t,this._needsUpdate||this._updateElement()}}),Object.defineProperty(pc.Model.prototype,"nearestScreen",{get:function(){return this._nearestScreen},set:function(t){this._nearestScreen=t,this._needsUpdate||this._updateNearestScreen()}}),Object.defineProperty(pc.Model.prototype,"lightmapIndex",{get:function(){return this._lightmapIndex},set:function(t){this._lightmapIndex=t,this._needsUpdate||this._configureLightmaps()}}),Object.defineProperty(pc.Model.prototype,"lightmapScaleOffset",{get:function(){return this._lightmapScaleOffset},set:function(t){this._lightmapScaleOffset=t,this._needsUpdate||this._configureLightmaps()}}),Object.defineProperty(pc.Model.prototype,"materials",{get:function(){return this._materials},set:function(t){this._materials=t,this._needsUpdate=!0}}),Object.defineProperty(pc.Model.prototype,"material",{get:function(){return this._materials?this._materials[0]:null},set:function(t){this._materials=this._materials||[],this._materials[0]=t,this._needsUpdate=!0}}),Object.defineProperty(pc.Model.prototype,"mesh",{get:function(){return this._mesh},set:function(t){this._mesh=t,this._needsUpdate=!0}}),Object.defineProperty(pc.Model.prototype,"skin",{get:function(){return this._skin},set:function(t){this._skin=t,this._needsUpdate||this._updateSkin()}}),Object.defineProperty(pc.Model.prototype,"bones",{get:function(){return this._bones},set:function(t){this._bones=t,this._needsUpdate||this._updateSkin()}}),Object.defineProperty(pc.Model.prototype,"sortingLayerIndex",{get:function(){return this._sortingLayerIndex},set:function(t){this._sortingLayerIndex=t,this._needsUpdate||this._updateSortingIndexes()}}),Object.defineProperty(pc.Model.prototype,"sortingOrder",{get:function(){return this._sortingOrder},set:function(t){this._sortingOrder=t,this._needsUpdate||this._updateSortingIndexes()}}),Object.defineProperty(pc.Model.prototype,"drawOrder",{get:function(){return this._drawOrder},set:function(t){this._drawOrder=t,this._needsUpdate||this._updateDrawOrder()}}),Object.defineProperty(pc.Model.prototype,"cullingLayer",{get:function(){return this._cullingLayer},set:function(t){this._cullingLayer=t,this._needsUpdate||this._updateCulling()}}),Object.defineProperty(pc.Model.prototype,"lightProbe",{get:function(){return this._lightProbe},set:function(t){this._lightProbe=t,this._needsUpdate||this._updateLightProbe()}}),Object.defineProperty(pc.Model.prototype,"lightProbeUsage",{get:function(){return this._lightProbeUsage},set:function(t){t!==this._lightProbeUsage&&(this._lightProbeUsage=t,this._needsUpdate||this._updateLightProbe())}}),Object.defineProperty(pc.Model.prototype,"blendReflectionProbes",{get:function(){return this._blendReflectionProbes},set:function(t){this._blendReflectionProbes!==t&&(this._blendReflectionProbes=t,this._needsUpdate||this._updateReflectionProbesBlending())}}),Object.defineProperty(pc.Model.prototype,"reflectionProbes",{get:function(){return this._reflectionProbes},set:function(t){null===this._reflectionProbes&&null===t||(this._reflectionProbes=t,this._needsUpdate||this._updateReflectionProbes())}}),Object.defineProperty(pc.Model.prototype,"flipFaces",{get:function(){return this._flipFaces},set:function(t){this._flipFaces!==t&&(this._flipFaces=t,this._needsUpdate||this._updateFlipFaces())}}),Object.defineProperty(pc.Model.prototype,"isStatic",{get:function(){return this._isStatic},set:function(t){if(this._isStatic===t)return;let e,i;if(this._isStatic=t,this.model){const n=this.model.meshInstances;for(e=0;e<n.length;e++)i=n[e],i.isStatic=t}}}),Object.defineProperty(pc.Model.prototype,"masksChildren",{get:function(){return this._masksChildren},set:function(t){this._masksChildren=t,this._needsUpdate||this._updateMasksChildren()}}),pc.extend(pc.Model.prototype,{setParameter:function(t,e){this._parameters[t]=e,this._needsUpdate||this._updateParameters()},deleteParameter:function(t){delete this._parameters[t],this._needsUpdate||this._updateParameters()},setConstant:function(t,e){this._constAttributes[t]=e,this._needsUpdate||this._updateConstants()},deleteConstant:function(t){delete this._constAttributes[t],this._needsUpdate||this._updateConstants()},setLightProbe:function(t,e){this._lightProbe=t,this._updateLightProbe(e)},update:function(){this._needsUpdate&&(this._needsUpdate=!1,this._configureMeshInstances())},setMeshDirectlyToMeshInstance:function(t){if(0===this.meshInstances.length)this.mesh!==t&&(this.mesh=t);else{const e=this.meshInstances[0];e.mesh!==t&&(e.mesh=t)}},setBlendShapeWeight:function(t,e){this.morphInstance?this.morphInstance.setWeight(t,e):console.error("SetBlendShapeWeight called for non blendable mesh.")},_configureMeshInstances:function(){if(!this._mesh)return void(this.meshInstances.length=0);if(!this._materials)return void console.log("Missing materials on "+this.entity.name);const t=this._mesh.subMeshes.length,e=this._materials.length;let i=0,n=!1;i=1===t?Math.max(1,e):t,this.meshInstances.length=i;for(let t=0;t<this.meshInstances.length;t++){const e=this._materials[Math.min(this._materials.length-1,t)],i=this._mesh.subMeshes[Math.min(this._mesh.subMeshes.length-1,t)];if(this.meshInstances[t]){const s=this.meshInstances[t].mesh!==i;n=n||s||this.meshInstances[t].material!==e,this.meshInstances[t].mesh=i,this.meshInstances[t].material=e,s&&(this.meshInstances[t]._aabbVer=-1)}else this.meshInstances[t]=new pc.MeshInstance(this.entity,i,e),n=!0,this.morphInstance&&(this.meshInstances[t].morphInstance=this.morphInstance)}this.entity&&(this._flipFaces=this.entity._isOddlyScaled()),this._updateParameters(),this._updateConstants(),this._updateSkin(),this._updateFlipFaces(),this._updateSortingIndexes(),this._updateCulling(),this._updateEntity(),this._configureLightmaps(),this._updateLightProbe(),this._updateReflectionProbes(),this._updateReflectionProbesBlending(),this._updateVisibility(),this._updateElement(),this._updateNearestScreen(),this._updateDrawOrder(),this._updateStencil(),this._updateMasksChildren()},_configureLightmaps:function(){if(!this._mesh)return;let t=0;this._mesh.vertexBuffer.format.hasUv1||(t|=pc.SHADERDEF_LMUV0),1===UnityEngine.LightmapSettings.environmentLightingMode&&(t|=pc.SHADERDEF_LM_BAKED_AMBIENT),UnityEngine.LightmapSettings.lightmapsMode===UnityEngine.LightmapsMode.CombinedDirectional&&(t|=pc.SHADERDEF_DIRLM);for(let e=0;e<this.meshInstances.length;e++){const i=this.meshInstances[e];!this._lightmapScaleOffset||this._lightmapIndex<0?(i._shaderDefs&=~(pc.SHADERDEF_LM|pc.SHADERDEF_DIRLM|pc.SHADERDEF_LMUV0|pc.SHADERDEF_LM_DLDR),i.deleteParameter("unity_Lightmap"),i.deleteParameter("unity_LightmapInd"),i.deleteParameter("unity_LightmapST")):(i._shaderDefs|=t|pc.SHADERDEF_LM,i.setParameter("unity_LightmapST",[this._lightmapScaleOffset.x,this._lightmapScaleOffset.y,this._lightmapScaleOffset.z,this._lightmapScaleOffset.w]),i.lightmapIndex=this._lightmapIndex,i.lightmapSceneIndex=this._lightmapSceneIndex)}},_updateParameters:function(){const t=Object.keys(this._parameters);for(let e=0;e<this.meshInstances.length;e++){const i=this.meshInstances[e];i.parameters={};for(let e=0;e<t.length;e++)i.setParameter(t[e],this._parameters[t[e]])}},_updateConstants:function(){const t=Object.keys(this._constAttributes);for(let e=0;e<this.meshInstances.length;e++){const i=this.meshInstances[e];i.constAttributes={};for(let e=0;e<t.length;e++)i.constAttributes[t[e]]=this._constAttributes[t[e]]}},_updateSkin:function(){if(!this._skin)return;const t=new pc.SkinInstance(this._skin);t.bones=this._bones;for(let e=0;e<this.meshInstances.length;e++)this.meshInstances[e].mesh.skin=this._skin,this.meshInstances[e].skinInstance=t},_updateSortingIndexes:function(){for(let t=0;t<this.meshInstances.length;t++)this.meshInstances[t].sortingLayerIndex=this._sortingLayerIndex,this.meshInstances[t].sortingOrder=this._sortingOrder},_updateFlipFaces:function(){for(let t=0;t<this.meshInstances.length;t++)this.meshInstances[t]._flipFaces=this._flipFaces},_updateReflectionProbes:function(){const t=this._reflectionProbes?this._reflectionProbes[0]:null,e=this._reflectionProbes?this._reflectionProbes[1]:null,i=pc.reflectionProbeUniforms;for(let n=0;n<this.meshInstances.length;n++){const s=this.meshInstances[n];if(null!=t){const e=t.getBox(s.aabb);s.setParameter(i[0],t.cubemap),s.setParameter(i[1],e.min.data),s.setParameter(i[2],e.max.data),s.setParameter(i[3],e.position.data)}else s.deleteParameter(i[0]),s.deleteParameter(i[1]),s.deleteParameter(i[2]),s.deleteParameter(i[3]);if(null!=e){const t=e.getBox(s.aabb);s.setParameter(i[4],e.cubemap),s.setParameter(i[5],t.min.data),s.setParameter(i[6],t.max.data),s.setParameter(i[7],t.position.data)}else s.deleteParameter(i[4]),s.deleteParameter(i[5]),s.deleteParameter(i[6]),s.deleteParameter(i[7])}},_updateReflectionProbesBlending:function(){for(let t=0;t<this.meshInstances.length;t++){const e=this.meshInstances[t];this._blendReflectionProbes?e._shaderDefs|=pc.SHADERDEF_BLEND_REFLECTION_PROBES:e._shaderDefs&=~pc.SHADERDEF_BLEND_REFLECTION_PROBES}},_updateLightProbe:function(){const t=(!this._lightmapScaleOffset||this._lightmapIndex<0)&&this.lightProbeUsage;for(let e=0;e<this.meshInstances.length;e++){const i=this.meshInstances[e];t?(i._shaderDefs|=pc.SHADERDEF_LIGHTPROBES,i._lightProbe=this._lightProbe):(i._shaderDefs&=~pc.SHADERDEF_LIGHTPROBES,i._lightProbe=null)}},_updateCulling:function(){for(let t=0;t<this.meshInstances.length;t++)this.meshInstances[t].mask=1<<this._cullingLayer},_updateVisibility:function(){for(let t=0;t<this.meshInstances.length;t++)this.meshInstances[t].visible=this._visible},_updateEntity:function(){for(let t=0;t<this.meshInstances.length;t++)this.meshInstances[t].node=this.entity},_updateElement:function(){for(let t=0;t<this.meshInstances.length;t++)this.meshInstances[t]._element=this._element},_updateNearestScreen:function(){for(let t=0;t<this.meshInstances.length;t++)this.meshInstances[t]._nearestScreen=this._nearestScreen},_updateDrawOrder:function(){for(let t=0;t<this.meshInstances.length;t++)this.meshInstances[t].drawOrder=this._drawOrder},_updateStencil:function(){for(let t=0;t<this.meshInstances.length;t++)this.meshInstances[t].stencilBack=this._stencil,this.meshInstances[t].stencilFront=this._stencil},_updateMasksChildren:function(){for(let t=0;t<this.meshInstances.length;t++){const e=this.meshInstances[t];this._masksChildren?e._shaderDefs|=pc.SHADERDEF_UI_MASK:e._shaderDefs&=~pc.SHADERDEF_UI_MASK}}})}(),window.Bridge.property=function(t,e,i,n,s,r){const o={enumerable:!r,configurable:!0};if(i&&i.get&&(o.get=i.get),i&&i.set&&(o.set=i.set),!i||!i.get&&!i.set){const t=Bridge.getTypeAlias(s)+"$"+e;s.$init=s.$init||{},n&&(s.$init[t]=i),function(t,e,i,n){t.get=function(){const t=this.$init[i];return void 0===t?n:t},t.set=function(t){this.$init[i]=t}}(o,0,t,i)}const a=[e],u=s.$descriptors||[];for(let t=0;t<u.length;t++){const i=u[t];if(i.name===e)for(let t=0;t<u.length;t++){const e=u[t];e.get===i.get&&e.set===i.set&&(-1===a.indexOf(e.name)&&a.push(e.name))}}for(const e of a)Object.defineProperty(t,e,o),t["get"+e]=t["get"+e]||o.get,t["set"+e]=t["set"+e]||o.set;return o},pc.extend(pc.Texture.prototype,{toBuffer:function(){const t=this.device.gl;this._glTexture||(this.device.setTexture(this,0),this.device.uploadTexture(this));const e=this._glTexture,i=this.width,n=this.height;(this._needsUpload||this._needsMipmapsUpload)&&this.device.uploadTexture(this);const s=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,s),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0);const r=new Uint8Array(i*n*4);return t.readPixels(0,0,i,n,t.RGBA,t.UNSIGNED_BYTE,r),t.deleteFramebuffer(s),r},sync:function(t){const e=this.device.gl,i=this._glTexture,n=this.width/(1<<t),s=this.height/(1<<t),r=this.device.activeFramebuffer,o=e.createFramebuffer();if(this.device.setFramebuffer(o),this._cubemap){this._levels=this._levels||[],this._levels[t]=this._levels[t]||[];for(let r=0;r<6;r++)e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+r,i,t),this._levels[t][r]=new Uint8Array(n*s*4),e.readPixels(0,0,n,s,e.RGBA,e.UNSIGNED_BYTE,this._levels[t][r])}else e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,i,t),this._levels=this._levels||[],this._levels[t]=new Uint8Array(n*s*4),e.readPixels(0,0,n,s,e.RGBA,e.UNSIGNED_BYTE,this._levels[t]);this.device.setFramebuffer(r)},markUploaded:function(){this._needsUpdate||(this._needsUpload=!1)},setPixels:function(t){null===this._buffer&&(this._buffer=this.createBuffer(this._format,this._width,this._height));for(let e=0;e<t.length;e++){const i=4*e;this._buffer[i+0]=255*t[e].r,this._buffer[i+1]=255*t[e].g,this._buffer[i+2]=255*t[e].b,this._buffer[i+3]=255*t[e].a}this._levels[0]=this._buffer,this._needsUpload=!0},setPixelData:function(t){this.device.setTexture(this,0),this._levels=[t],this._needsUpload=!0,this.device.uploadTexture(this)},toDataURI:function(){const t=this.width,e=this.height,i=this.toBuffer(),n=document.createElement("canvas");n.width=t,n.height=e;const s=n.getContext("2d",{alpha:!0}),r=s.createImageData(t,e);return r.data.set(i),s.putImageData(r,0,0),s.scale(1,-1),s.translate(0,-r.height),s.drawImage(s.canvas,0,0),n.toDataURL()},copyCubemap:function(t){t._glTexture||this.device.uploadTexture(t),this._glTexture=t._glTexture,this._glTarget=t._glTarget,this._glInternalFormat=t._glInternalFormat,this._glFormat=t._glFormat,this._glPixelType=t._glPixelType,this._parameterFlags=t._parameterFlags,this.rgbm=t.rgbm,this._width=t._width,this._height=t._height,this._needsUpload=!1,this._needsMipmapsUpload=!1}}),pc.extend(pc.VertexBuffer.prototype,{resize:function(t){const e=t*this.format.size;if(e!==this.numBytes){this.device._vram.vb+=e-this.numBytes,this.numBytes=e,this.numVertices=t;const i=this.storage;this.storage=new ArrayBuffer(this.numBytes),new Uint8Array(this.storage).set(new Uint8Array(i.slice(0,this.numBytes))),this.invalidateBuffer()}},invalidateBuffer:function(){const t=this.device;if(this.bufferId){const e=t.gl;e.deleteBuffer(this.bufferId),this.bufferId=null,t.boundBuffer=null,t.vertexBuffers.length=0,t.vbOffsets.length=0,t.attributesInvalidated=!0;for(const i in t.enabledAttributes)e.disableVertexAttribArray(i);t.enabledAttributes={}}}}),pc.extend(pc.IndexBuffer.prototype,{resize:function(t){const e=t*this.bytesPerIndex;if(e!==this.numBytes){this.numBytes=e,this.numIndices=t;const i=this.storage;this.storage=new ArrayBuffer(this.numBytes),new Uint8Array(this.storage).set(new Uint8Array(i.slice(0,this.numBytes))),this.invalidateBuffer()}},invalidateBuffer:function(){const t=this.device;this.bufferId&&(t.gl.deleteBuffer(this.bufferId),this.bufferId=null,t.indexBuffer===this&&(t.indexBuffer=null))}}),pc.extend(pc.VertexFormat.prototype,{getStructureFor:function(t,e){let i=-1;const n=e?4:1;for(let e=0;e<this.elements.length;e++)if(this.elements[e].name===t){i=this.elements[e].offset;break}return{offset:i/n,stride:this.size/n}}}),pc.extend(pc.VertexIterator.prototype,{setVector4:function(t,e){this.element[t].set(e[0],e[1],e[2]||0,e[3]||1)},setVector3:function(t,e){this.element[t].set(e[0],e[1],e[2])},setVector2:function(t,e){this.element[t].set(e[0],e[1])}}),function(){const t=new pc.Vec2,e=new pc.Vec2;pc.extend(pc.Vec2,{ctor:pc.Vec2,$kind:"struct",kEpsilon:1e-5,kEpsilonNormalSqrt:1e-15,angle:function(i,n){return t.copy(i).normalize(),e.copy(n).normalize(),Math.acos(pc.math.clamp(t.dot(e),-1,1))*pc.math.RAD_TO_DEG},signedAngle:function(t,e){return pc.Vec2.angle(t,e)*pc.math.sign(t.x*e.y-t.y*e.x)},lengthClamp:function(t,e){return t.lengthSq()>e*e?t.clone().normalize().scale(e):t.clone()},reflect:function(e,i){t.copy(i);const n=-2*t.dot(e);return t.scale(n),t.add(e).clone()},moveTowards:function(e,i,n){const s=t.copy(i).sub(e),r=s.length();return r<=n||r<1401298e-51?i.clone():e.clone().add(s.scale(1/r*n))},smoothDamp:function(t,e,i,n,s,r){const o=2/(n=Math.max(1e-4,n)),a=o*r,u=1/(1+a+.479999989271164*a*a+.234999999403954*a*a*a),c=t.clone().sub(e.clone()),h=e.clone(),l=s*n,p=pc.Vec2.lengthClamp(c.clone(),l);e=t.clone().sub(p.clone());const d=i.v.clone().add(p.clone().scale(o)).scale(r);i.v=i.v.clone().sub(d.clone().scale(o)).scale(u);let f=e.clone().add(p.clone().add(d.clone()).scale(u));return h.clone().sub(t.clone()).dot(f.clone().sub(h.clone()))>0&&(f=h.clone(),i.v=f.clone().sub(h.clone()).scale(1/r)),f.clone()},equals:function(t,e){return null===t&&null===e||t&&e&&t.equals(e)},getDefaultValue:function(){return new pc.Vec2},FromVector3:function(t){return new pc.Vec2(t.x,t.y)},FromVector4:function(t){return new pc.Vec2(t.x,t.y)}}),pc.extend(pc.Vec2.prototype,{setFromMax:function(t,e){return t>this.x&&(this.x=t),e>this.y&&(this.y=e),this},strictEquals:function(t){return t instanceof pc.Vec2&&this.equals(t)},div:function(t){return this.x/=t.x,this.y/=t.y,this},$getType:function(){return pc.Vec2},getitem:pc.Vec2.prototype.iget=function(t){switch(t){case 0:return this.x;case 1:return this.y;default:return NaN}},setitem:pc.Vec2.prototype.iset=function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e}},getHashCode:pc.Vec2.prototype.hash=function(){return this.x^this.y},$clone:function(t){return(t=t||new pc.Vec2).copy(this),t},fromVector3:function(t){return this.x=t.x,this.y=t.y,this},fromVector4:function(t){return this.x=t.x,this.y=t.y,this}})}(),function(){const t=new pc.Vec3(1,1,-1),e=new pc.Vec3,i=new pc.Vec3,n=new pc.Quat,s=new pc.Quat;function r(t){return Math.abs(t)>1e-5?1/t:0}pc.extend(pc.Vec3,{ctor:pc.Vec3,$kind:"struct",kEpsilon:1e-5,kEpsilonNormalSqrt:1e-15,distance:function(t,i){return e.copy(t).sub(i).length()},projectOnPlane:function(t,n,s){return s=s||new pc.Vec3,e.copy(t),i.copy(t),e.sub(i.project(n)),s.copy(e),s},smoothDamp:function(t,e,i,n,s,r){const o=2/(n=UnityEngine.Mathf.Max(1e-4,n)),a=o*r,u=1/(1+a+.479999989271164*a*a+.234999999403954*a*a*a),c=t.clone().sub(e.clone()),h=e.clone(),l=s*n,p=pc.Vec3.clampMagnitude(c.clone(),l);e=t.clone().sub(p.clone());const d=i.v.clone().add(p.clone().scale(o)).scale(r);i.v=i.v.clone().sub(d.clone().scale(o)).scale(u);let f=e.clone().add(p.clone().add(d.clone()).scale(u));return h.clone().sub(t.clone()).dot(f.clone().sub(h.clone()))>0&&(f=h.clone(),i.v=f.clone().sub(h.clone()).scale(1/r)),f.clone()},clampMagnitude:function(t,e){return t.length()>Math.abs(e)?t.clone().normalize().scale(e):t.clone()},reflect:function(t,i){return e.copy(i),e.scale(-2*t.dot(i)).add(t),e.clone()},moveTowards:function(t,i,n){const s=e.copy(i).sub(t),r=s.length();return r<=n||r<1401298e-51?i.clone():t.clone().add(s.scale(1/r*n))},orthoNormalize:function(t,e,i){t.normalize(),e.cross(t,e),e.cross(e,t),e.normalize(),i.cross(t,e)},signedAngle:function(t,n,s){e.copy(t).normalize(),i.copy(n).normalize();const r=pc.math.clamp(i.dot(e),-1,1);e.cross(t,n);const o=s.dot(e),a=pc.math.sign(o);return Math.acos(r)*a*pc.math.RAD_TO_DEG},rotateTowards:function(t,r,o,a){const u=e.cross(t,r),c=n.setLookAt(t,u),h=s.setLookAt(r,u),l=pc.Quat.rotateTowards(c,h,o*pc.math.RAD_TO_DEG);e.set(0,0,1);const p=l.transformVector(e,i),d=r.length()-t.length(),f=t.length()+pc.math.sign(d)*Math.min(Math.abs(d),a);return p.normalize(),p.mul(new pc.Vec3(f,f,f)),p.clone()},angle:function(t,n){return Math.acos(pc.math.clamp(e.copy(t).normalize().dot(i.copy(n).normalize()),-1,1))*pc.math.RAD_TO_DEG},equals:function(t,e){return null===t&&null===e||t&&e&&t.equals(e)},getDefaultValue:function(){return new pc.Vec3},FromVector2:function(t){return new pc.Vec3(t.x,t.y,0)},FromVector4:function(t){return new pc.Vec3(t.x,t.y,t.z)},cachedNegativeInfinity:new pc.Vec3(-1/0,-1/0,-1/0),cachedPositiveInfinity:new pc.Vec3(1/0,1/0,1/0),cachedForward:new pc.Vec3(0,0,1),cachedBack:new pc.Vec3(0,0,-1),cachedOne:new pc.Vec3(1,1,1)}),pc.extend(pc.Vec3.prototype,{slerp:function(t,e,i){i=pc.math.clamp(i,0,1);const n=t.length();if(n<Number.EPSILON)return this.copy(t);const s=e.length();if(s<Number.EPSILON)return this.copy(e);const r=1-i,o=t.dot(e)/(n*s);if(o<=-1||o>=1)return this.copy(t).normalize().scale(r*n+i*s);const a=Math.acos(o);if(a<Number.EPSILON)return this.copy(t);const u=Math.sin(a),c=Math.sin(r*a)/u,h=Math.sin(i*a)/u;return this.set(t.x*c+e.x*h,t.y*c+e.y*h,t.z*c+e.z*h).normalize().scale(r*n+i*s)},slerpUnclamped:function(t,e,i){const n=t.length();if(n<Number.EPSILON)return this.copy(t);const s=e.length();if(s<Number.EPSILON)return this.copy(e);const r=1-i,o=t.dot(e)/(n*s);if(o<=-1||o>=1)return this.copy(t).normalize().scale(r*n+i*s);const a=Math.acos(o);if(a<Number.EPSILON)return this.copy(t);const u=Math.sin(a),c=Math.sin(r*a)/u,h=Math.sin(i*a)/u;return this.set(t.x*c+e.x*h,t.y*c+e.y*h,t.z*c+e.z*h).normalize().scale(r*n+i*s)},abs:function(t){return t?(t.x=this.x<0?-this.x:this.x,t.y=this.y<0?-this.y:this.y,t.z=this.z<0?-this.z:this.z,t):(this.x<0&&(this.x=-this.x),this.y<0&&(this.y=-this.y),this.z<0&&(this.z=-this.z),this)},strictEquals:function(t){return t instanceof pc.Vec3&&this.equals(t)},approximatelyEquals:function(t,e){return e=e||1e-5,Math.abs(this.x-t.x)<e&&Math.abs(this.y-t.y)<e&&Math.abs(this.z-t.z)<e},invertSafe(){return this.x=r(this.x),this.y=r(this.y),this.z=r(this.z),this},$getType:function(){return pc.Vec3},getitem:pc.Vec3.prototype.iget=function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:return NaN}},setitem:pc.Vec3.prototype.iset=function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e}},getHashCode:pc.Vec3.prototype.hash=function(){return this.x^this.y^this.z},$clone:function(t){return(t=t||new pc.Vec3).copy(this),t},fromVector2:function(t){return this.x=t.x,this.y=t.y,this.z=0,this},fromVector4:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},equalsWithEpsilon:function(t,e){return e=e||1e-6,Math.abs(this.x-t.x)<e&&Math.abs(this.y-t.y)<e&&Math.abs(this.z-t.z)<e}}),pc.Vec3.REVERSED_Z=t}(),function(){const t=new pc.Vec4;pc.extend(pc.Vec4,{ctor:pc.Vec4,$kind:"struct",distance:function(e,i){return t.copy(e).sub(i).length()},moveTowards:function(e,i,n){const s=t.copy(i).sub(e),r=s.length();return r<=n||r<1401298e-51?i.clone():e.clone().add(s.scale(1/r*n))},equals:function(t,e){return null===t&&null===e||null!==t&&null!==e&&t.equals(e)},getDefaultValue:function(){return new pc.Vec4},FromVector2:function(t){return new pc.Vec4(t.x,t.y,0,0)},FromVector3:function(t){return new pc.Vec4(t.x,t.y,t.z,0)}}),pc.extend(pc.Vec4.prototype,{project:function(t){const e=(this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w)/(t.x*t.x+t.y*t.y+t.z*t.z+t.w*t.w);return this.x=t.x*e,this.y=t.y*e,this.z=t.z*e,this.w=t.w*e,this},getitem:pc.Vec4.prototype.iget=function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:return NaN}},setitem:pc.Vec4.prototype.iset=function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e}},strictEquals:function(t){return t instanceof pc.Vec4&&this.equals(t)},lerpUnclamped:function(t,e,i){return this.x=t.x+i*(e.x-t.x),this.y=t.y+i*(e.y-t.y),this.z=t.z+i*(e.z-t.z),this},hash:function(){return this.x^this.y^this.z^this.w},getHashCode:function(){return this.hash()},fromVector2:function(t){return this.x=t.x,this.y=t.y,this.z=0,this.w=0,this},fromVector3:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=0,this},$getType:function(){return pc.Vec4},$clone:function(t){return(t=t||new pc.Vec4).copy(this),t}})}(),pc.extend(pc.Quat,{ctor:pc.Quat,$kind:"struct",getDefaultValue:function(){return new pc.Quat},rotateTowards:function(t,e,i){const n=this.angle(t,e);return n<1401298e-51?e:(new pc.Quat).slerpUnclamped(t,e,Math.min(1,i/n))},angle:function(t,e){const i=t.dot(e);let n=0;return i<.999998986721039&&(n=2*Math.acos(Math.min(Math.abs(i),1))*pc.math.RAD_TO_DEG),n}}),pc.extend(pc.Quat.prototype,{getitem:pc.Quat.prototype.iget=function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:return NaN}},setitem:pc.Quat.prototype.iset=function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e}},setFromEulerAngles_Unity:function(t,e,i){const n=t*pc.math.DEG_TO_RAD*.5,s=e*pc.math.DEG_TO_RAD*.5,r=i*pc.math.DEG_TO_RAD*.5,o=Math.sin(n),a=Math.cos(n),u=Math.sin(s),c=Math.cos(s),h=Math.sin(r),l=Math.cos(r);return this.x=c*o*l+u*a*h,this.y=u*a*l-c*o*h,this.z=c*a*h-u*o*l,this.w=c*a*l+u*o*h,this},getEulerAngles_Unity:function(t){t=t||new pc.Vec3;const e=this,i=e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w,n=e.x*e.w-e.y*e.z;return n>.4995*i?(t.x=Math.PI/2,t.y=2*Math.atan2(e.y,e.x),t.z=0):n<-.4995*i?(t.x=-Math.PI/2,t.y=-2*Math.atan2(e.y,e.x),t.z=0):(t.x=Math.asin(2*(e.w*e.x-e.y*e.z)),t.y=Math.atan2(2*e.w*e.y+2*e.z*e.x,1-2*(e.x*e.x+e.y*e.y)),t.z=Math.atan2(2*e.w*e.z+2*e.x*e.y,1-2*(e.z*e.z+e.x*e.x))),t.x*=pc.math.RAD_TO_DEG,t.y*=pc.math.RAD_TO_DEG,t.z*=pc.math.RAD_TO_DEG,t.x+=t.x<0?360:0,t.y+=t.y<0?360:0,t.z+=t.z<0?360:0,t},getPositiveEulerAngles:function(){return this.getEulerAngles_Unity()},fromToRotation:function(t,e){const i=new pc.Vec3;i.cross(t,e);const n=new pc.Quat;return n.x=i.x,n.y=i.y,n.z=i.z,n.w=Math.sqrt(t.lengthSq()*e.lengthSq())+t.dot(e),n.normalize()},lookRotation:function(t,e){const i=new pc.Vec3(0,0,0),n=new pc.Vec3(0,0,0),s=t.clone().scale(-1);s.normalize(),i.cross(e,s).normalize(),n.cross(s,i).normalize();const r=new pc.Mat3;return r.M11=i.x,r.M21=i.y,r.M31=i.z,r.M12=n.x,r.M22=n.y,r.M32=n.z,r.M13=s.x,r.M23=s.y,r.M33=s.z,this.rotationMatrix(r)},rotationMatrix:function(t){const e=new pc.Quat;let i,n;const s=t.M11+t.M22+t.M33;return s>0?(i=Math.sqrt(s+1),e.w=.5*i,i=.5/i,e.x=(t.M23-t.M32)*i,e.y=(t.M31-t.M13)*i,e.z=(t.M12-t.M21)*i):t.M11>=t.M22&&t.M11>=t.M33?(i=Math.sqrt(1+t.M11-t.M22-t.M33),n=.5/i,e.x=.5*i,e.y=(t.M12+t.M21)*n,e.z=(t.M13+t.M31)*n,e.w=(t.M23-t.M32)*n):t.M22>t.M33?(i=Math.sqrt(1+t.M22-t.M11-t.M33),n=.5/i,e.x=(t.M21+t.M12)*n,e.y=.5*i,e.z=(t.M32+t.M23)*n,e.w=(t.M31-t.M13)*n):(i=Math.sqrt(1+t.M33-t.M11-t.M22),n=.5/i,e.x=(t.M31+t.M13)*n,e.y=(t.M32+t.M23)*n,e.z=.5*i,e.w=(t.M12-t.M21)*n),e.normalize(),e},strictEquals:function(t){return t instanceof pc.Quat&&this.equals(t)},approximatelyEquals:function(t,e=1e-5){return Math.abs(this.x-t.x)<e&&Math.abs(this.y-t.y)<e&&Math.abs(this.z-t.z)<e&&Math.abs(this.w-t.w)<e},toAngleAxis:function(t,e){const i=this.$clone().normalize();t.v=2*Math.acos(i.w)*pc.math.RAD_TO_DEG;const n=Math.sqrt(1-i.w*i.w);n<1e-4?(e.v.x=1,e.v.z=e.v.y=0):(e.v.x=i.x/n,e.v.y=i.y/n,e.v.z=i.z/n)},$clone:function(t){return(t=t||new pc.Quat).copy(this),t}}),Object.defineProperty(pc.Quat.prototype,"xyz",{get:function(){return new pc.Vec3(this.x,this.y,this.z)}}),pc.extend(pc.Mat4,{ctor:pc.Mat4,$kind:"struct",fromArray:function(t){const e=Object.create(pc.Mat4.prototype);return e.data=t,e},getDefaultValue:function(){return new pc.Mat4},mat3FromMat4:function(t,e){t.data[0]=e.data[0],t.data[1]=e.data[1],t.data[2]=e.data[2],t.data[3]=e.data[4],t.data[4]=e.data[5],t.data[5]=e.data[6],t.data[6]=e.data[8],t.data[7]=e.data[9],t.data[8]=e.data[10]},inverse3DAffine:function(t,e){e.v=t.clone().invert()},setFrustumUnity:function(t,e,i,n,s,r){const o=2*s,a=e-t,u=n-i,c=s-r,h=new pc.Mat4;return h.data[0]=o/a,h.data[1]=0,h.data[2]=0,h.data[3]=0,h.data[4]=0,h.data[5]=o/u,h.data[6]=0,h.data[7]=0,h.data[8]=(e+t)/a,h.data[9]=(n+i)/u,h.data[10]=(r+s)/c,h.data[11]=-1,h.data[12]=0,h.data[13]=0,h.data[14]=o*r/c,h.data[15]=0,h},setLookAtUnity:function(t,e,i){const n=new pc.Mat4,s=new pc.Vec3,r=new pc.Vec3,o=new pc.Vec3;return o.sub2(e,t),o.length()<1e-6?n.setIdentity():(o.normalize(),r.copy(i).normalize(),s.cross(r,o).normalize(),r.cross(o,s),n.data[0]=-s.x,n.data[1]=s.y,n.data[2]=-s.z,n.data[3]=0,n.data[4]=r.x,n.data[5]=r.y,n.data[6]=r.z,n.data[7]=0,n.data[8]=-o.x,n.data[9]=-o.y,n.data[10]=-o.z,n.data[11]=0,n.data[12]=t.x,n.data[13]=t.y,n.data[14]=t.z,n.data[15]=1,this)},equals:function(t,e){return null===t&&null===e||null!==t&&null!==e&&t.equals(e)}}),pc.Mat4.prototype.getitem=pc.Mat4.prototype.iget=function(t){return this.data[t]},pc.Mat4.prototype.setitem=pc.Mat4.prototype.iset=function(t,e){return this.data[t]=e,e},pc.Mat4.prototype.getitem$1=pc.Mat4.prototype.ijget=function(t,e){return this.data[t+4*e]},pc.Mat4.prototype.setitem$1=pc.Mat4.prototype.ijset=function(t,e,i){return this.data[t+4*e]=i,i},pc.Mat4.prototype.getHashCode=pc.Mat4.prototype.hash=function(){return this.x^this.y^this.z},pc.extend(pc.Mat4.prototype,{setColumn:function(t,e){return this.data[4*t]=e.x,this.data[4*t+1]=e.y,this.data[4*t+2]=e.z,this.data[4*t+3]=e.w,this},getColumn:function(t){switch(t){case 0:return new pc.Vec4(this.data[0],this.data[1],this.data[2],this.data[3]);case 1:return new pc.Vec4(this.data[4],this.data[5],this.data[6],this.data[7]);case 2:return new pc.Vec4(this.data[8],this.data[9],this.data[10],this.data[11]);case 3:return new pc.Vec4(this.data[12],this.data[13],this.data[14],this.data[15]);default:return null}},getRow:function(t){switch(t){case 0:return new pc.Vec4(this.data[0],this.data[4],this.data[8],this.data[12]);case 1:return new pc.Vec4(this.data[1],this.data[5],this.data[9],this.data[13]);case 2:return new pc.Vec4(this.data[2],this.data[6],this.data[10],this.data[14]);case 3:return new pc.Vec4(this.data[3],this.data[7],this.data[11],this.data[15]);default:return null}},scale:function(t){for(let e=0;e<16;e++)this.data[e]*=t},determinant:function(){const t=this.data,e=t[0],i=t[1],n=t[2],s=t[3],r=t[4],o=t[5],a=t[6],u=t[7],c=t[8],h=t[9],l=t[10],p=t[11],d=t[12],f=t[13],y=t[14],m=t[15];return(e*o-i*r)*(l*m-p*y)-(e*a-n*r)*(h*m-p*f)+(e*u-s*r)*(h*y-l*f)+(i*a-n*o)*(c*m-p*d)-(i*u-s*o)*(c*y-l*d)+(n*u-s*a)*(c*f-h*d)},getRotation:function(t){const e=t||new pc.Quat;return e.setFromMat4(this),e},make64:function(){return this.data=new Float64Array(this.data),this},multiplyInverse:function(){const t=new pc.Vec3,e=new pc.Vec3,i=new pc.Quat,n=new pc.Quat;return function(s){i.setFromMat4(this).conjugate(),n.setFromMat4(s),s.getTranslation(e),this.getTranslation(t),e.sub(t),i.transformVector(e,e),i.mul(n),this.setTRS(e,i,pc.Vec3.ONE)}}(),transformVectorInverse:function(){const t=new pc.Quat,e=new pc.Vec3;return function(i,n){return n=n||new pc.Vec3,t.setFromMat4(this),this.getTranslation(e),n.sub2(i,e),t.transformVectorInverse(n,n),n}}(),setRotation:function(t){return this.setTRS(pc.Vec3.ZERO,t,pc.Vec3.ONE)},setTranslation:function(t){const e=this.data;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},setPerspective_Unity:function(t,e,i,n,s){return this.setPerspective(t,e,i,n,s),this.data[8]*=-1,this.data[9]*=-1,this.data[10]*=-1,this.data[11]*=-1,this},multiplyPoint:function(t,e){const i=this.data,n=t.x,s=t.y,r=t.z;(e=void 0===e?new pc.Vec3:e).x=n*i[0]+s*i[4]+r*i[8]+i[12],e.y=n*i[1]+s*i[5]+r*i[9]+i[13],e.z=n*i[2]+s*i[6]+r*i[10]+i[14];const o=1/(n*i[3]+s*i[7]+r*i[11]+i[15]);return e.scale(o),e},setData:function(t,e,i,n,s,r,o,a,u,c,h,l,p,d,f,y){return this.data[0]=t,this.data[1]=e,this.data[2]=i,this.data[3]=n,this.data[4]=s,this.data[5]=r,this.data[6]=o,this.data[7]=a,this.data[8]=u,this.data[9]=c,this.data[10]=h,this.data[11]=l,this.data[12]=p,this.data[13]=d,this.data[14]=f,this.data[15]=y,this},validTRS:function(){return!(Math.abs(this.data[3])>1e-5||Math.abs(this.data[7])>1e-5||Math.abs(this.data[11])>1e-5||Math.abs(this.data[15]-1)>1e-5||Math.abs(this.determinant)<1e-5)},decomposeProjection:function(){const t=new UnityEngine.FrustumPlanes.ctor;return t.zFar=(this.data[15]-this.data[14])/(this.data[11]-this.data[10]),t.zNear=(this.data[15]+this.data[14])/(this.data[11]+this.data[10]),t.left=(this.data[11]+this.data[8])/(this.data[3]+this.data[0])*t.zNear,t.right=(this.data[11]-this.data[8])/(this.data[3]-this.data[0])*t.zNear,t.top=(this.data[11]-this.data[9])/(this.data[7]-this.data[5])*t.zNear,t.bottom=(this.data[11]+this.data[9])/(this.data[7]+this.data[5])*t.zNear,t},transformPlane:function(t){const e=this.clone().invert(),i=t.normal.x,n=t.normal.y,s=t.normal.z,r=t.distance;return new UnityEngine.Plane.$ctor1(new pc.Vec3(e.e00*i+e.e10*n+e.e20*s+e.e30*r,e.e01*i+e.e11*n+e.e21*s+e.e31*r,e.e02*i+e.e12*n+e.e22*s+e.e32*r),e.e03*i+e.e13*n+e.e23*s+e.e33*r)},strictEquals:function(t){return t instanceof pc.Mat4&&this.equals(t)},$clone:function(t){return(t=t||new pc.Mat4).copy(this),t},equalsWithEpsilon:function(t,e){e=e||1e-6;const i=this.data,n=t.data;for(let t=0;t<16;t++)if(Math.abs(i[t]-n[t])>=e)return!1;return!0}}),Object.defineProperty(pc.Mat4.prototype,"e00",{get:function(){return this.data[0]},set:function(t){this.data[0]=t}}),Object.defineProperty(pc.Mat4.prototype,"e10",{get:function(){return this.data[1]},set:function(t){this.data[1]=t}}),Object.defineProperty(pc.Mat4.prototype,"e20",{get:function(){return this.data[2]},set:function(t){this.data[2]=t}}),Object.defineProperty(pc.Mat4.prototype,"e30",{get:function(){return this.data[3]},set:function(t){this.data[3]=t}}),Object.defineProperty(pc.Mat4.prototype,"e01",{get:function(){return this.data[4]},set:function(t){this.data[4]=t}}),Object.defineProperty(pc.Mat4.prototype,"e11",{get:function(){return this.data[5]},set:function(t){this.data[5]=t}}),Object.defineProperty(pc.Mat4.prototype,"e21",{get:function(){return this.data[6]},set:function(t){this.data[6]=t}}),Object.defineProperty(pc.Mat4.prototype,"e31",{get:function(){return this.data[7]},set:function(t){this.data[7]=t}}),Object.defineProperty(pc.Mat4.prototype,"e02",{get:function(){return this.data[8]},set:function(t){this.data[8]=t}}),Object.defineProperty(pc.Mat4.prototype,"e12",{get:function(){return this.data[9]},set:function(t){this.data[9]=t}}),Object.defineProperty(pc.Mat4.prototype,"e22",{get:function(){return this.data[10]},set:function(t){this.data[10]=t}}),Object.defineProperty(pc.Mat4.prototype,"e32",{get:function(){return this.data[11]},set:function(t){this.data[11]=t}}),Object.defineProperty(pc.Mat4.prototype,"e03",{get:function(){return this.data[12]},set:function(t){this.data[12]=t}}),Object.defineProperty(pc.Mat4.prototype,"e13",{get:function(){return this.data[13]},set:function(t){this.data[13]=t}}),Object.defineProperty(pc.Mat4.prototype,"e23",{get:function(){return this.data[14]},set:function(t){this.data[14]=t}}),Object.defineProperty(pc.Mat4.prototype,"e33",{get:function(){return this.data[15]},set:function(t){this.data[15]=t}}),Object.defineProperty(pc.Mat4.prototype,"singular",{get:function(){return 0===this.determinant()}}),pc.GraphicsDevice.prototype.applyStencilState=function(t,e,i){t||e||!i?(t||e)&&(this.setStencilTest(!0),t===e?(this.setStencilFunc(t.func,t.ref,t.readMask),this.setStencilOperation(t.fail,t.zfail,t.zpass,t.writeMask)):(t?(this.setStencilFuncFront(t.func,t.ref,t.readMask),this.setStencilOperationFront(t.fail,t.zfail,t.zpass,t.writeMask)):(this.setStencilFuncFront(pc.FUNC_ALWAYS,0,255),this.setStencilOperationFront(pc.STENCILOP_KEEP,pc.STENCILOP_KEEP,pc.STENCILOP_KEEP,255)),e?(this.setStencilFuncBack(e.func,e.ref,e.readMask),this.setStencilOperationBack(e.fail,e.zfail,e.zpass,e.writeMask)):(this.setStencilFuncBack(pc.FUNC_ALWAYS,0,255),this.setStencilOperationBack(pc.STENCILOP_KEEP,pc.STENCILOP_KEEP,pc.STENCILOP_KEEP,255)))):this.setStencilTest(!1)},pc.UNIFORMS_USAGE_MAP={},pc.UNIFORMS_USAGE_MAP["unity_CameraWorldClipPlanes[0]"]=1,pc.UNIFORMS_USAGE_MAP.unity_MatrixMVP=2,pc.UNIFORMS_USAGE_MAP.unity_MatrixMV=4,pc.UNIFORMS_USAGE_MAP.unity_MatrixVP=8,pc.UNIFORMS_USAGE_MAP.unity_MatrixV=16,pc.UNIFORMS_USAGE_MAP.unity_MatrixInvV=32,pc.UNIFORMS_USAGE_MAP.glstate_matrix_projection=64,pc.UNIFORMS_USAGE_MAP.unity_MatrixTMV=128,pc.UNIFORMS_USAGE_MAP.unity_MatrixITMV=256,pc.UNIFORMS_USAGE_MAP.unity_ObjectToWorld=512,pc.UNIFORMS_USAGE_MAP.unity_WorldToObject=1024,pc.UNIFORMS_USAGE_MAP.unity_CameraProjection=2048,pc.UNIFORMS_USAGE_MAP.unity_CameraInvProjection=4096,pc.UNIFORMS_USAGE_MAP["hlslcc_mtx4x4unity_MatrixMVP[0]"]=2,pc.UNIFORMS_USAGE_MAP["hlslcc_mtx4x4unity_MatrixMV[0]"]=4,pc.UNIFORMS_USAGE_MAP["hlslcc_mtx4x4unity_MatrixVP[0]"]=8,pc.UNIFORMS_USAGE_MAP["hlslcc_mtx4x4unity_MatrixV[0]"]=16,pc.UNIFORMS_USAGE_MAP["hlslcc_mtx4x4unity_MatrixInvV[0]"]=32,pc.UNIFORMS_USAGE_MAP["hlslcc_mtx4x4glstate_matrix_projection[0]"]=64,pc.UNIFORMS_USAGE_MAP["hlslcc_mtx4x4unity_MatrixTMV[0]"]=128,pc.UNIFORMS_USAGE_MAP["hlslcc_mtx4x4unity_MatrixITMV[0]"]=256,pc.UNIFORMS_USAGE_MAP["hlslcc_mtx4x4unity_ObjectToWorld[0]"]=512,pc.UNIFORMS_USAGE_MAP["hlslcc_mtx4x4unity_WorldToObject[0]"]=1024,pc.UNIFORMS_USAGE_MAP["hlslcc_mtx4x4unity_CameraProjection[0]"]=2048,pc.UNIFORMS_USAGE_MAP["hlslcc_mtx4x4unity_CameraInvProjection[0]"]=4096,pc.GraphicsDevice.prototype.getUniformsInUse=function(t){let e=0;for(let i=0;i<t.length;i++){const n=t[i],s=pc.UNIFORMS_USAGE_MAP[n.scopeId.name];void 0!==s&&(e|=s)}return e},function(){let t=null,e=null,i=null,n=0;const s=new pc.Color,r=[0,1,2,0,2,3,0,3,4,0,4,5,0,5,6],o=[0,1,5,5,4,0,1,2,6,6,5,1,2,3,7,7,6,2,4,5,9,9,8,4,5,6,10,10,9,5,6,7,11,11,10,6,8,9,13,13,12,8,9,10,14,14,13,9,10,11,15,15,14,10],a=[0,1,5,5,4,0,1,2,6,6,5,1,2,3,7,7,6,2,4,5,9,9,8,4,6,7,11,11,10,6,8,9,13,13,12,8,9,10,14,14,13,9,10,11,15,15,14,10];pc.extend(pc.ImageElement.prototype,{_imageIndexBuffer:function(){if(t)return t;return t=new pc.IndexBuffer(this._system.app.graphicsDevice,pc.INDEXFORMAT_UINT16,o.length),new Uint16Array(t.lock()).set(o),t.unlock(),t.destroy=function(){},t},_emptyCenterImageIndexBuffer:function(){if(e)return e;return e=new pc.IndexBuffer(this._system.app.graphicsDevice,pc.INDEXFORMAT_UINT16,a.length),new Uint16Array(e.lock()).set(a),e.unlock(),e.destroy=function(){},e},_imageRadialIndexBuffer:function(){if(i)return i;return i=new pc.IndexBuffer(this._system.app.graphicsDevice,pc.INDEXFORMAT_UINT16,r.length),new Uint16Array(i.lock()).set(r),i.unlock(),i.destroy=function(){},i},_createMesh:function(){if(this._entity.isPrefab)return null;const t=new pc.VertexFormat(this._system.app.graphicsDevice,[{semantic:pc.SEMANTIC_POSITION,components:3,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_TEXCOORD0,components:2,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_COLOR,components:4,type:pc.ELEMENTTYPE_FLOAT32}],16);n=9,this._fillEdges=new pc.Vec4(0,0,1,1),this._buffer=new Float32Array(16*n);const e=new pc.VertexBuffer(this._system.app.graphicsDevice,t,16,pc.BUFFER_STATIC,this._buffer.buffer),i=new pc.Mesh(!0);return i.vertexBuffer=e,i.indexBuffer[0]=this._imageIndexBuffer(),i.primitive[0].type=pc.PRIMITIVE_TRIANGLES,i.primitive[0].base=0,i.primitive[0].count=o.length,i.primitive[0].indexed=!0,i.subMeshes=[i],i},_updateMesh:function(){null==this._texture&&(this._spriteType=pc.SPRITE_TYPE_SIMPLE),this._mesh?(this._spriteType===pc.SPRITE_TYPE_FILLED&&this._fillMethod===pc.FILL_METHOD_RADIAL360?(this._updateMeshRadial(),this._mesh.indexBuffer[0]=this._imageRadialIndexBuffer(),this._mesh.primitive[0].count=r.length):(this._updateMeshSquare(),this._fillCenter?(this._mesh.indexBuffer[0]=this._imageIndexBuffer(),this._mesh.primitive[0].count=o.length):(this._mesh.indexBuffer[0]=this._emptyCenterImageIndexBuffer(),this._mesh.primitive[0].count=a.length)),this._canvasRenderer.setMesh(this._mesh)):this._canvasRenderer.setMesh(null)},_updateMeshSquare:function(){const t=this._element.width||0,e=this._element.height||0,i=new pc.Vec4(0,0,0,0),s=new pc.Vec2(0,0);this._calculatePaddings(t,e,i,s),this._spriteType===pc.SPRITE_TYPE_FILLED?(this._fillMethod===pc.FILL_METHOD_HORIZONTAL&&this._fillEdges.set(this._fillOrigin===pc.FILL_ORIGIN_BOTTOM_LEFT?0:1-this._fillAmount,0,this._fillOrigin===pc.FILL_ORIGIN_BOTTOM_LEFT?this._fillAmount:1,1),this._fillMethod===pc.FILL_METHOD_VERTICAL&&this._fillEdges.set(0,this._fillOrigin===pc.FILL_ORIGIN_BOTTOM_LEFT?0:1-this._fillAmount,1,this._fillOrigin===pc.FILL_ORIGIN_BOTTOM_LEFT?this._fillAmount:1)):this._fillEdges.set(0,0,1,1);let r=this._spriteType===pc.SPRITE_TYPE_SLICED||this._spriteType===pc.SPRITE_TYPE_TILED?1:0;this._sprite&&this._element.screen&&(r=r*this._element.screen.screen.referencePixelsPerUnit/this._sprite.pixelsPerUnit);const o=[i.x+t*this._fillEdges.x,i.x+t*this._fillEdges.x+Math.min(this._border.x*r,.5*t),i.x+(t-i.x-i.z)*this._fillEdges.z-Math.min(this._border.z*r,.5*t),i.x+(t-i.x-i.z)*this._fillEdges.z],a=[i.y+(e-i.y-i.w)*this._fillEdges.w,i.y+(e-i.y-i.w)*this._fillEdges.w-Math.min(this._border.w*r,.5*e),i.y+e*this._fillEdges.y+Math.min(this._border.y*r,.5*e),i.y+e*this._fillEdges.y],u=[pc.math.lerp(this._rect.x,this._rect.x+this._rect.z,this._fillEdges.x),pc.math.lerp(this._rect.x,this._rect.x+this._rect.z,this._fillEdges.x),pc.math.lerp(this._rect.x,this._rect.x+this._rect.z,this._fillEdges.z),pc.math.lerp(this._rect.x,this._rect.x+this._rect.z,this._fillEdges.z)],c=[pc.math.lerp(this._rect.y,this._rect.y+this._rect.w,this._fillEdges.w),pc.math.lerp(this._rect.y,this._rect.y+this._rect.w,this._fillEdges.w),pc.math.lerp(this._rect.y,this._rect.y+this._rect.w,this._fillEdges.y),pc.math.lerp(this._rect.y,this._rect.y+this._rect.w,this._fillEdges.y)];if(this._spriteType!==pc.SPRITE_TYPE_SLICED&&this._spriteType!==pc.SPRITE_TYPE_TILED||!this._texture)this._spriteType,pc.SPRITE_TYPE_TILED;else{if(u[1]+=this._border.x/this._texture.width,u[2]-=this._border.z/this._texture.width,o[1]>o[2]){const t=o[1];o[1]=o[2],o[2]=t}if(c[1]-=this._border.w/this._texture.height,c[2]+=this._border.y/this._texture.height,a[2]>a[1]){const t=a[1];a[1]=a[2],a[2]=t}}const h=this._mesh.vertexBuffer,l=this.color,p=new Float32Array(h.storage);for(let t=0;t<4;t++)for(let e=0;e<4;e++){let i=(4*t+e)*n;p[i++]=-this._element._pivotPoint.x+o[e],p[i++]=-this._element._pivotPoint.y+a[t],p[i++]=0,p[i++]=u[e],p[i++]=c[t],p[i++]=l.r,p[i++]=l.g,p[i++]=l.b,p[i++]=l.a}h.unlock()},_calculatePaddings:function(t,e,i,n){let s=t,r=e,o=1,a=1;if(this._texture&&(s=this._texture.width,r=this._texture.height),this._sprite){i.copy(this._sprite.transparency);const t=this._sprite.getTextureRect();s=t.z-t.x+i.x+i.z,r=t.w-t.y+i.y+i.w}if(t===s&&e===r||(o=t/s,a=e/r),n.x=t,n.y=e,this._preserveAspect&&this._spriteType!==pc.SPRITE_TYPE_SLICED&&this._spriteType!==pc.SPRITE_TYPE_TILED){const t=Math.min(o,a);n.x=t*s,n.y=t*r,i.scale(t)}else 1===o&&1===a||(i.x*=o,i.y*=a,i.z*=o,i.w*=a);return n.x===t&&n.y===e||i.add(new pc.Vec4((t-n.x)*this._element.pivot.x,(e-n.y)*this._element.pivot.y,(t-n.x)*(1-this._element.pivot.x),(e-n.y)*(1-this._element.pivot.y))),i},_updateMeshRadial:function(){const t=this._element.width||0,e=this._element.height||0,i=new pc.Vec4(0,0,0,0),s=new pc.Vec2(0,0);this._calculatePaddings(t,e,i,s);let r=360*this._fillAmount;const o=s.x/2,a=i.x+o,u=s.y/2,c=i.y+u,h=this._rect.z/2,l=this._rect.w/2,p=this._rect.x+h,d=this._rect.y+l,f=[a],y=[c],m=[p],_=[d];let g=0,A=0,E=!1;switch(this._fillOrigin){case pc.FILL_ORIGIN_RADIAL_BOTTOM:A=270;break;case pc.FILL_ORIGIN_RADIAL_RIGHT:A=0;break;case pc.FILL_ORIGIN_RADIAL_TOP:A=90;break;case pc.FILL_ORIGIN_RADIAL_LEFT:A=180}const b=this._element["UnityEngine.UI.Image"].m_FillClockwise?-1:1;let S=0,M=0;for(;r>0;){const t=Math.min(r,g);A+=b*t,A=(A+360)%360,A<=45||A>315?(f.push(a+o),m.push(p+h),M=Math.tan(A*pc.math.DEG_TO_RAD),y.push(c+u*M),_.push(d+l*M)):A<=135?(S=1/Math.tan(A*pc.math.DEG_TO_RAD),f.push(a+o*S),m.push(p+h*S),y.push(c+u),_.push(d+l)):A<=225?(f.push(a-o),m.push(p-h),M=-Math.tan(A*pc.math.DEG_TO_RAD),y.push(c+u*M),_.push(d+l*M)):A<=315&&(S=-1/Math.tan(A*pc.math.DEG_TO_RAD),f.push(a+o*S),m.push(p+h*S),y.push(c-u),_.push(d-l)),r-=t,E?g=90:(g=45,E=!0)}for(;f.length<16;)f.push(a);for(;y.length<16;)y.push(c);for(;m.length<16;)m.push(p);for(;_.length<16;)_.push(d);const C=this._mesh.vertexBuffer,x=this.color,O=new Float32Array(C.storage);for(let t=0;t<16;t++)O[t*n+0]=-this._element._pivotPoint.x+f[t],O[t*n+1]=-this._element._pivotPoint.y+y[t],O[t*n+2]=0,O[t*n+3]=m[t],O[t*n+4]=_[t],O[t*n+5]=x.r,O[t*n+6]=x.g,O[t*n+7]=x.b,O[t*n+8]=x.a;C.unlock()},synchornizeProperties:function(t,e){const i=t.m_OverrideSprite||t.m_Sprite,n=i?i.handle:null,r=e&&t.m_Texture?t.m_Texture.handle:null,o=e?this._texture!==r:this._sprite!==n,a=e&&(t.m_UVRect.m_XMin!==this._rect.x||t.m_UVRect.m_YMin!==this._rect.y||t.m_UVRect.m_Width!==this._rect.z||t.m_UVRect.m_Height!==this._rect.w);(this._fillCenter!==t.m_FillCenter||this._fillAmount!==t.m_FillAmount||this._fillMethod!==t.m_FillMethod||this._fillOrigin!==t.m_FillOrigin||o||a)&&(e&&this._texture!==r?this.texture=r:this._sprite!==n&&(this.sprite=n),a&&this._rect.set(t.m_UVRect.m_XMin,t.m_UVRect.m_YMin,t.m_UVRect.m_Width,t.m_UVRect.m_Height),e||(this._fillCenter=t.m_FillCenter,this._fillAmount=t.m_FillAmount,this._fillMethod=t.m_FillMethod,this._fillOrigin=t.m_FillOrigin),this._updateMesh()),s.copy(t.m_Color)}}),pc.extend(pc,{SPRITE_TYPE_SIMPLE:0,SPRITE_TYPE_SLICED:1,SPRITE_TYPE_TILED:2,SPRITE_TYPE_FILLED:3,FILL_METHOD_HORIZONTAL:0,FILL_METHOD_VERTICAL:1,FILL_METHOD_RADIAL90:2,FILL_METHOD_RADIAL180:3,FILL_METHOD_RADIAL360:4,FILL_ORIGIN_BOTTOM_LEFT:0,FILL_ORIGIN_TOP_RIGHT:1,FILL_ORIGIN_RADIAL_BOTTOM:0,FILL_ORIGIN_RADIAL_RIGHT:1,FILL_ORIGIN_RADIAL_TOP:2,FILL_ORIGIN_RADIAL_LEFT:3}),Object.defineProperty(pc.ImageElement.prototype,"sprite",{set:function(t){if(this._sprite=t,t){this._texture=t.texture,this._canvasRenderer.setTexture(this._texture);const e=t.uvRect;e instanceof pc.Vec4?this._rect.set(e.x,e.y,e.z,e.w):this._rect.set(e[0],e[1],e[2],e[3]);const i=this.spriteType===pc.SPRITE_TYPE_SIMPLE?pc.Vec4.ZERO:t.border;i instanceof pc.Vec4?this._border.set(i.x,i.y,i.z,i.w):this._border.set(i[0],i[1],i[2],i[3])}else this._texture=null,this._canvasRenderer.setTexture(this._texture);this._updateMesh()},get:function(){return this._sprite}}),Object.defineProperty(pc.ImageElement.prototype,"spriteType",{set:function(t){this._spriteType=t,this.sprite=this._sprite},get:function(){return this._spriteType||pc.SPRITE_TYPE_SLICED}}),Object.defineProperty(pc.ImageElement.prototype,"preserveAspect",{set:function(t){this._preserveAspect=t,this._updateMesh()},get:function(){return this._preserveAspect}}),Object.defineProperty(pc.ImageElement.prototype,"fillMethod",{set:function(t){this._fillMethod=t,this._updateMesh()},get:function(){return this._fillMethod}}),Object.defineProperty(pc.ImageElement.prototype,"fillCenter",{set:function(t){this._fillCenter=t,this._updateMesh()},get:function(){return this._fillCenter}}),Object.defineProperty(pc.ImageElement.prototype,"fillOrigin",{set:function(t){this._fillOrigin=t,this._updateMesh()},get:function(){return this._fillOrigin}}),Object.defineProperty(pc.ImageElement.prototype,"fillAmount",{set:function(t){this._fillAmount=t,this._updateMesh()},get:function(){return this._fillAmount}})}(),function(){const t=new pc.Color,e=new pc.Vec3;pc.extend(pc.TextElement.prototype,{_createMesh:function(){if(this._entity.isPrefab)return null;this.bounds=new pc.Vec2,this._textOffsets=new pc.Vec3,this._textGenerator=new pc.TextGenerator(this.canvasRenderer),this._computedAlpha=1;const t=pc.TextGenerator.createEmptyMesh();return t.subMeshes=[t],t},_updateAligns:function(t){void 0!==this._element.width&&void 0!==this._element.height&&(t||(this.bounds.set(this._element.width,this._element.height),this._textGenerator.populate(this.text,this)),e.set(-this._element._pivotPoint.x,-this._element._pivotPoint.y,0).add(this._textGenerator.offset),this._textGenerator.updateMesh(this._mesh,this,e))},_updateMesh:function(t,e){if(this._entity.isPrefab)return;if(this._element._dirtyRect&&this._entity._sync(),!(0===this._element.width||0===this._element.height||this._element&&this._element.width&&this._element.height))return;this.bounds.set(this._element.width,this._element.height),this._textGenerator.populate(e,this),0!==this._textGenerator.vertexCount?(this._dirtyVertices&&this._textGenerator.updateMesh(this._mesh,this),this._dirtyOffset&&this._updateAligns(!0),(this._dirtyVertices||this._dirtyOffset)&&this._element.dirtifyRect(),this._canvasRenderer.getMesh()||this._canvasRenderer.setMesh(t)):this._canvasRenderer.setMesh(null)},setVerticesDirty:function(){this._updateText(this._text)},_updateText:function(t){this._font&&(void 0===t&&(t=this._text),this._mesh||(this._updateMaterial(),this._mesh=this._createMesh(t),this._canvasRenderer.setMesh(this._mesh)),this._updateMesh(this._mesh,t),this._canvasRenderer.setTexture(this._font.texture))},synchornizeProperties:function(e){t.copy(e.m_Color)}}),Object.defineProperty(pc.TextElement.prototype,"tintTexture",{set:function(t){this._tintTexture=t,this._updateText(this._text)},get:function(){return this._tintTexture}})}(),Object.defineProperty(pc.ScreenComponent.prototype,"referencePixelsPerUnit",{get:function(){return this._referencePixelsPerUnit},set:function(t){this._referencePixelsPerUnit=t,this.resolution=this._resolution}}),Object.defineProperty(pc.ScreenComponent.prototype,"rootScreen",{get:function(){let t=this,e=this.entity;for(;e;)t=e.screen||t,e=e.parent;return t}}),Object.defineProperty(pc.ScreenComponent.prototype,"scaleFactor",{get:function(){return this._scaleFactor},set:function(t){this._scaleFactor=t,this._updateScale(),this._calcProjectionMatrix()}}),Object.defineProperty(pc.ScreenComponent.prototype,"overrideSorting",{get:function(){return this["__UnityEngine.Canvas"].overrideSorting},set:function(t){this._sortingOrder=t}}),Object.defineProperty(pc.ScreenComponent.prototype,"sortingOrder",{get:function(){return!this.isNested||this["__UnityEngine.Canvas"].overrideSorting?this._sortingOrder:this.parentScreen.sortingOrder},set:function(t){this._sortingOrder=t}}),Object.defineProperty(pc.ScreenComponent.prototype,"sortingLayerIndex",{get:function(){return!this.isNested||this["__UnityEngine.Canvas"].overrideSorting?this._sortingLayerIndex:this.parentScreen.sortingLayerIndex},set:function(t){this._sortingLayerIndex=t}}),Object.defineProperty(pc.ScreenComponent.prototype,"isNested",{get:function(){return null!=this.parentScreen}}),Object.defineProperty(pc.ScreenComponent.prototype,"drawOrder",{get:function(){return this.entity.element.drawOrder}}),pc.extend(pc.Color,{ctor:pc.Color,$kind:"struct",gammaToLinear:function(t){return t<=.04045?t/12.92:t<1?Math.pow((t+.055)/1.055,2.4):Math.pow(t,2.2)},hsvToRGB:function(t,e,i,n){let s,r,o;const a=Math.floor(6*t),u=6*t-a;switch(a%6){case 0:s=i,r=i*(1-(1-u)*e),o=i*(1-e);break;case 1:s=i*(1-u*e),r=i,o=i*(1-e);break;case 2:s=i*(1-e),r=i,o=i*(1-(1-u)*e);break;case 3:s=i*(1-e),r=i*(1-u*e),o=i;break;case 4:s=i*(1-(1-u)*e),r=i*(1-e),o=i;break;case 5:s=i,r=i*(1-e),o=i*(1-u*e)}return n||(s=pc.math.clamp(s,0,1),r=pc.math.clamp(r,0,1),o=pc.math.clamp(o,0,1)),new pc.Color(s,r,o,1)},rgbToHSV:function(t,e,i,n){t.b>t.g&&t.b>t.r?this.rgbHelper(4,t.b,t.r,t.g,e,i,n):t.g>t.r?this.rgbHelper(2,t.g,t.b,t.r,e,i,n):this.rgbHelper(0,t.r,t.g,t.b,e,i,n)},rgbToHSVHelper:function(t,e,i,n,s,r,o){if(o.v=e,0!==o.v){const e=i<=n?i:n,a=o.v-e;if(0!==a?(r.v=a/o.v,s.v=t+(i-n)/a):(r.v=0,s.v=t+(i-n)),s.v/=6,s.v>=0)return;++s.v}else r.v=0,s.v=0},lerp:function(t,e,i){return pc.Color.lerpUnclamped(t,e,pc.math.clamp(i,0,1))},lerpUnclamped:function(t,e,i){return new pc.Color(UnityEngine.Mathf.LerpUnclamped(t.r,e.r,i),UnityEngine.Mathf.LerpUnclamped(t.g,e.g,i),UnityEngine.Mathf.LerpUnclamped(t.b,e.b,i),UnityEngine.Mathf.LerpUnclamped(t.a,e.a,i))},equals:function(t,e){return null===t&&null===e||null!==t&&null!==e&&t.equals(e)},getDefaultValue:function(){return new pc.Color}}),pc.extend(pc.Color.prototype,{getitem:function(t){switch(t){case 0:return this.r;case 1:return this.g;case 2:return this.b;case 3:return this.a;default:return NaN}},setitem:function(t,e){switch(t){case 0:this.r=e;break;case 1:this.g=e;break;case 2:this.b=e;break;case 3:this.a=e}},premultiply:function(){return this.r*=this.a,this.g*=this.a,this.b*=this.a,this},mul:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this.a*=t.a,this},mul2:function(t,e){return this.r=t.r*e.r,this.g=t.g*e.g,this.b=t.b*e.b,this.a=t.a*e.a,this},scale:function(t){return this.r*=t,this.g*=t,this.b*=t,this.a*=t,this},toLinear:function(){return this.r=pc.Color.gammaToLinear(this.r),this.g=pc.Color.gammaToLinear(this.g),this.b=pc.Color.gammaToLinear(this.b),this},equals:function(t){return Math.abs(this.r-t.r)<1e-5&&Math.abs(this.g-t.g)<1e-5&&Math.abs(this.b-t.b)<1e-5&&Math.abs(this.a-t.a)<1e-5},getHashCode:pc.Color.prototype.hash=function(){return this.x^this.y^this.z^this.w},strictEquals:function(t){return t instanceof pc.Color&&this.equals(t)},lerpTo:function(t,e){this.r=t.r*e+this.r*(1-e),this.g=t.g*e+this.g*(1-e),this.b=t.b*e+this.b*(1-e),this.a=t.a*e+this.a*(1-e)},grayscale:function(){return.29899999499321*this.r+.587000012397766*this.g+.114*this.b},linear:function(){return new pc.Color(UnityEngine.Mathf.GammaToLinearSpace(this.r),UnityEngine.Mathf.GammaToLinearSpace(this.g),UnityEngine.Mathf.GammaToLinearSpace(this.b),this.a)},gamma:function(){return new pc.Color(UnityEngine.Mathf.LinearToGammaSpace(this.r),UnityEngine.Mathf.LinearToGammaSpace(this.g),UnityEngine.Mathf.LinearToGammaSpace(this.b),this.a)},maxColorComponent:function(){return Math.max(Math.max(this.r,this.g),this.b)},$getType:function(){return pc.Color},$clone:function(t){return(t=t||new pc.Color).copy(this),t}}),pc.extend(pc.Light.prototype,{getFinalColor:function(){return this.dirtyColor&&(this.dirtyColor=!1,this.setColor(this._color)),this._finalColor},getLinearFinalColor:function(){return this.dirtyColor&&(this.dirtyColor=!1,this.setColor(this._color)),this._linearFinalColor}}),function(){const t=new RegExp(/[A-Za-z\u0061-\u007A\u00B5\u00DF-\u00F6\u00F8-\u00FF\u0101\u0103\u0105\u0107\u0109\u010B\u010D\u010F\u0111\u0113\u0115\u0117\u0119\u011B\u011D\u011F\u0121\u0123\u0125\u0127\u0129\u012B\u012D\u012F\u0131\u0133\u0135\u0137\u0138\u013A\u013C\u013E\u0140\u0142\u0144\u0146\u0148\u0149\u014B\u014D\u014F\u0151\u0153\u0155\u0157\u0159\u015B\u015D\u015F\u0161\u0163\u0165\u0167\u0169\u016B\u016D\u016F\u0171\u0173\u0175\u0177\u017A\u017C\u017E-\u0180\u0183\u0185\u0188\u018C\u018D\u0192\u0195\u0199-\u019B\u019E\u01A1\u01A3\u01A5\u01A8\u01AA\u01AB\u01AD\u01B0\u01B4\u01B6\u01B9\u01BA\u01BD-\u01BF\u01C6\u01C9\u01CC\u01CE\u01D0\u01D2\u01D4\u01D6\u01D8\u01DA\u01DC\u01DD\u01DF\u01E1\u01E3\u01E5\u01E7\u01E9\u01EB\u01ED\u01EF\u01F0\u01F3\u01F5\u01F9\u01FB\u01FD\u01FF\u0201\u0203\u0205\u0207\u0209\u020B\u020D\u020F\u0211\u0213\u0215\u0217\u0219\u021B\u021D\u021F\u0221\u0223\u0225\u0227\u0229\u022B\u022D\u022F\u0231\u0233-\u0239\u023C\u023F\u0240\u0242\u0247\u0249\u024B\u024D\u024F-\u0293\u0295-\u02AF\u0371\u0373\u0377\u037B-\u037D\u0390\u03AC-\u03CE\u03D0\u03D1\u03D5-\u03D7\u03D9\u03DB\u03DD\u03DF\u03E1\u03E3\u03E5\u03E7\u03E9\u03EB\u03ED\u03EF-\u03F3\u03F5\u03F8\u03FB\u03FC\u0430-\u045F\u0461\u0463\u0465\u0467\u0469\u046B\u046D\u046F\u0471\u0473\u0475\u0477\u0479\u047B\u047D\u047F\u0481\u048B\u048D\u048F\u0491\u0493\u0495\u0497\u0499\u049B\u049D\u049F\u04A1\u04A3\u04A5\u04A7\u04A9\u04AB\u04AD\u04AF\u04B1\u04B3\u04B5\u04B7\u04B9\u04BB\u04BD\u04BF\u04C2\u04C4\u04C6\u04C8\u04CA\u04CC\u04CE\u04CF\u04D1\u04D3\u04D5\u04D7\u04D9\u04DB\u04DD\u04DF\u04E1\u04E3\u04E5\u04E7\u04E9\u04EB\u04ED\u04EF\u04F1\u04F3\u04F5\u04F7\u04F9\u04FB\u04FD\u04FF\u0501\u0503\u0505\u0507\u0509\u050B\u050D\u050F\u0511\u0513\u0515\u0517\u0519\u051B\u051D\u051F\u0521\u0523\u0525\u0527\u0561-\u0587\u1D00-\u1D2B\u1D6B-\u1D77\u1D79-\u1D9A\u1E01\u1E03\u1E05\u1E07\u1E09\u1E0B\u1E0D\u1E0F\u1E11\u1E13\u1E15\u1E17\u1E19\u1E1B\u1E1D\u1E1F\u1E21\u1E23\u1E25\u1E27\u1E29\u1E2B\u1E2D\u1E2F\u1E31\u1E33\u1E35\u1E37\u1E39\u1E3B\u1E3D\u1E3F\u1E41\u1E43\u1E45\u1E47\u1E49\u1E4B\u1E4D\u1E4F\u1E51\u1E53\u1E55\u1E57\u1E59\u1E5B\u1E5D\u1E5F\u1E61\u1E63\u1E65\u1E67\u1E69\u1E6B\u1E6D\u1E6F\u1E71\u1E73\u1E75\u1E77\u1E79\u1E7B\u1E7D\u1E7F\u1E81\u1E83\u1E85\u1E87\u1E89\u1E8B\u1E8D\u1E8F\u1E91\u1E93\u1E95-\u1E9D\u1E9F\u1EA1\u1EA3\u1EA5\u1EA7\u1EA9\u1EAB\u1EAD\u1EAF\u1EB1\u1EB3\u1EB5\u1EB7\u1EB9\u1EBB\u1EBD\u1EBF\u1EC1\u1EC3\u1EC5\u1EC7\u1EC9\u1ECB\u1ECD\u1ECF\u1ED1\u1ED3\u1ED5\u1ED7\u1ED9\u1EDB\u1EDD\u1EDF\u1EE1\u1EE3\u1EE5\u1EE7\u1EE9\u1EEB\u1EED\u1EEF\u1EF1\u1EF3\u1EF5\u1EF7\u1EF9\u1EFB\u1EFD\u1EFF-\u1F07\u1F10-\u1F15\u1F20-\u1F27\u1F30-\u1F37\u1F40-\u1F45\u1F50-\u1F57\u1F60-\u1F67\u1F70-\u1F7D\u1F80-\u1F87\u1F90-\u1F97\u1FA0-\u1FA7\u1FB0-\u1FB4\u1FB6\u1FB7\u1FBE\u1FC2-\u1FC4\u1FC6\u1FC7\u1FD0-\u1FD3\u1FD6\u1FD7\u1FE0-\u1FE7\u1FF2-\u1FF4\u1FF6\u1FF7\u210A\u210E\u210F\u2113\u212F\u2134\u2139\u213C\u213D\u2146-\u2149\u214E\u2184\u2C30-\u2C5E\u2C61\u2C65\u2C66\u2C68\u2C6A\u2C6C\u2C71\u2C73\u2C74\u2C76-\u2C7B\u2C81\u2C83\u2C85\u2C87\u2C89\u2C8B\u2C8D\u2C8F\u2C91\u2C93\u2C95\u2C97\u2C99\u2C9B\u2C9D\u2C9F\u2CA1\u2CA3\u2CA5\u2CA7\u2CA9\u2CAB\u2CAD\u2CAF\u2CB1\u2CB3\u2CB5\u2CB7\u2CB9\u2CBB\u2CBD\u2CBF\u2CC1\u2CC3\u2CC5\u2CC7\u2CC9\u2CCB\u2CCD\u2CCF\u2CD1\u2CD3\u2CD5\u2CD7\u2CD9\u2CDB\u2CDD\u2CDF\u2CE1\u2CE3\u2CE4\u2CEC\u2CEE\u2CF3\u2D00-\u2D25\u2D27\u2D2D\uA641\uA643\uA645\uA647\uA649\uA64B\uA64D\uA64F\uA651\uA653\uA655\uA657\uA659\uA65B\uA65D\uA65F\uA661\uA663\uA665\uA667\uA669\uA66B\uA66D\uA681\uA683\uA685\uA687\uA689\uA68B\uA68D\uA68F\uA691\uA693\uA695\uA697\uA723\uA725\uA727\uA729\uA72B\uA72D\uA72F-\uA731\uA733\uA735\uA737\uA739\uA73B\uA73D\uA73F\uA741\uA743\uA745\uA747\uA749\uA74B\uA74D\uA74F\uA751\uA753\uA755\uA757\uA759\uA75B\uA75D\uA75F\uA761\uA763\uA765\uA767\uA769\uA76B\uA76D\uA76F\uA771-\uA778\uA77A\uA77C\uA77F\uA781\uA783\uA785\uA787\uA78C\uA78E\uA791\uA793\uA7A1\uA7A3\uA7A5\uA7A7\uA7A9\uA7FA\uFB00-\uFB06\uFB13-\uFB17\uFF41-\uFF5A\u0041-\u005A\u00C0-\u00D6\u00D8-\u00DE\u0100\u0102\u0104\u0106\u0108\u010A\u010C\u010E\u0110\u0112\u0114\u0116\u0118\u011A\u011C\u011E\u0120\u0122\u0124\u0126\u0128\u012A\u012C\u012E\u0130\u0132\u0134\u0136\u0139\u013B\u013D\u013F\u0141\u0143\u0145\u0147\u014A\u014C\u014E\u0150\u0152\u0154\u0156\u0158\u015A\u015C\u015E\u0160\u0162\u0164\u0166\u0168\u016A\u016C\u016E\u0170\u0172\u0174\u0176\u0178\u0179\u017B\u017D\u0181\u0182\u0184\u0186\u0187\u0189-\u018B\u018E-\u0191\u0193\u0194\u0196-\u0198\u019C\u019D\u019F\u01A0\u01A2\u01A4\u01A6\u01A7\u01A9\u01AC\u01AE\u01AF\u01B1-\u01B3\u01B5\u01B7\u01B8\u01BC\u01C4\u01C7\u01CA\u01CD\u01CF\u01D1\u01D3\u01D5\u01D7\u01D9\u01DB\u01DE\u01E0\u01E2\u01E4\u01E6\u01E8\u01EA\u01EC\u01EE\u01F1\u01F4\u01F6-\u01F8\u01FA\u01FC\u01FE\u0200\u0202\u0204\u0206\u0208\u020A\u020C\u020E\u0210\u0212\u0214\u0216\u0218\u021A\u021C\u021E\u0220\u0222\u0224\u0226\u0228\u022A\u022C\u022E\u0230\u0232\u023A\u023B\u023D\u023E\u0241\u0243-\u0246\u0248\u024A\u024C\u024E\u0370\u0372\u0376\u0386\u0388-\u038A\u038C\u038E\u038F\u0391-\u03A1\u03A3-\u03AB\u03CF\u03D2-\u03D4\u03D8\u03DA\u03DC\u03DE\u03E0\u03E2\u03E4\u03E6\u03E8\u03EA\u03EC\u03EE\u03F4\u03F7\u03F9\u03FA\u03FD-\u042F\u0460\u0462\u0464\u0466\u0468\u046A\u046C\u046E\u0470\u0472\u0474\u0476\u0478\u047A\u047C\u047E\u0480\u048A\u048C\u048E\u0490\u0492\u0494\u0496\u0498\u049A\u049C\u049E\u04A0\u04A2\u04A4\u04A6\u04A8\u04AA\u04AC\u04AE\u04B0\u04B2\u04B4\u04B6\u04B8\u04BA\u04BC\u04BE\u04C0\u04C1\u04C3\u04C5\u04C7\u04C9\u04CB\u04CD\u04D0\u04D2\u04D4\u04D6\u04D8\u04DA\u04DC\u04DE\u04E0\u04E2\u04E4\u04E6\u04E8\u04EA\u04EC\u04EE\u04F0\u04F2\u04F4\u04F6\u04F8\u04FA\u04FC\u04FE\u0500\u0502\u0504\u0506\u0508\u050A\u050C\u050E\u0510\u0512\u0514\u0516\u0518\u051A\u051C\u051E\u0520\u0522\u0524\u0526\u0531-\u0556\u10A0-\u10C5\u10C7\u10CD\u1E00\u1E02\u1E04\u1E06\u1E08\u1E0A\u1E0C\u1E0E\u1E10\u1E12\u1E14\u1E16\u1E18\u1E1A\u1E1C\u1E1E\u1E20\u1E22\u1E24\u1E26\u1E28\u1E2A\u1E2C\u1E2E\u1E30\u1E32\u1E34\u1E36\u1E38\u1E3A\u1E3C\u1E3E\u1E40\u1E42\u1E44\u1E46\u1E48\u1E4A\u1E4C\u1E4E\u1E50\u1E52\u1E54\u1E56\u1E58\u1E5A\u1E5C\u1E5E\u1E60\u1E62\u1E64\u1E66\u1E68\u1E6A\u1E6C\u1E6E\u1E70\u1E72\u1E74\u1E76\u1E78\u1E7A\u1E7C\u1E7E\u1E80\u1E82\u1E84\u1E86\u1E88\u1E8A\u1E8C\u1E8E\u1E90\u1E92\u1E94\u1E9E\u1EA0\u1EA2\u1EA4\u1EA6\u1EA8\u1EAA\u1EAC\u1EAE\u1EB0\u1EB2\u1EB4\u1EB6\u1EB8\u1EBA\u1EBC\u1EBE\u1EC0\u1EC2\u1EC4\u1EC6\u1EC8\u1ECA\u1ECC\u1ECE\u1ED0\u1ED2\u1ED4\u1ED6\u1ED8\u1EDA\u1EDC\u1EDE\u1EE0\u1EE2\u1EE4\u1EE6\u1EE8\u1EEA\u1EEC\u1EEE\u1EF0\u1EF2\u1EF4\u1EF6\u1EF8\u1EFA\u1EFC\u1EFE\u1F08-\u1F0F\u1F18-\u1F1D\u1F28-\u1F2F\u1F38-\u1F3F\u1F48-\u1F4D\u1F59\u1F5B\u1F5D\u1F5F\u1F68-\u1F6F\u1FB8-\u1FBB\u1FC8-\u1FCB\u1FD8-\u1FDB\u1FE8-\u1FEC\u1FF8-\u1FFB\u2102\u2107\u210B-\u210D\u2110-\u2112\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u2130-\u2133\u213E\u213F\u2145\u2183\u2C00-\u2C2E\u2C60\u2C62-\u2C64\u2C67\u2C69\u2C6B\u2C6D-\u2C70\u2C72\u2C75\u2C7E-\u2C80\u2C82\u2C84\u2C86\u2C88\u2C8A\u2C8C\u2C8E\u2C90\u2C92\u2C94\u2C96\u2C98\u2C9A\u2C9C\u2C9E\u2CA0\u2CA2\u2CA4\u2CA6\u2CA8\u2CAA\u2CAC\u2CAE\u2CB0\u2CB2\u2CB4\u2CB6\u2CB8\u2CBA\u2CBC\u2CBE\u2CC0\u2CC2\u2CC4\u2CC6\u2CC8\u2CCA\u2CCC\u2CCE\u2CD0\u2CD2\u2CD4\u2CD6\u2CD8\u2CDA\u2CDC\u2CDE\u2CE0\u2CE2\u2CEB\u2CED\u2CF2\uA640\uA642\uA644\uA646\uA648\uA64A\uA64C\uA64E\uA650\uA652\uA654\uA656\uA658\uA65A\uA65C\uA65E\uA660\uA662\uA664\uA666\uA668\uA66A\uA66C\uA680\uA682\uA684\uA686\uA688\uA68A\uA68C\uA68E\uA690\uA692\uA694\uA696\uA722\uA724\uA726\uA728\uA72A\uA72C\uA72E\uA732\uA734\uA736\uA738\uA73A\uA73C\uA73E\uA740\uA742\uA744\uA746\uA748\uA74A\uA74C\uA74E\uA750\uA752\uA754\uA756\uA758\uA75A\uA75C\uA75E\uA760\uA762\uA764\uA766\uA768\uA76A\uA76C\uA76E\uA779\uA77B\uA77D\uA77E\uA780\uA782\uA784\uA786\uA78B\uA78D\uA790\uA792\uA7A0\uA7A2\uA7A4\uA7A6\uA7A8\uA7AA\uFF21-\uFF3A\u01C5\u01C8\u01CB\u01F2\u1F88-\u1F8F\u1F98-\u1F9F\u1FA8-\u1FAF\u1FBC\u1FCC\u1FFC\u02B0-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0374\u037A\u0559\u0640\u06E5\u06E6\u07F4\u07F5\u07FA\u081A\u0824\u0828\u0971\u0E46\u0EC6\u10FC\u17D7\u1843\u1AA7\u1C78-\u1C7D\u1D2C-\u1D6A\u1D78\u1D9B-\u1DBF\u2071\u207F\u2090-\u209C\u2C7C\u2C7D\u2D6F\u2E2F\u3005\u3031-\u3035\u303B\u309D\u309E\u30FC-\u30FE\uA015\uA4F8-\uA4FD\uA60C\uA67F\uA717-\uA71F\uA770\uA788\uA7F8\uA7F9\uA9CF\uAA70\uAADD\uAAF3\uAAF4\uFF70\uFF9E\uFF9F\u00AA\u00BA\u01BB\u01C0-\u01C3\u0294\u05D0-\u05EA\u05F0-\u05F2\u0620-\u063F\u0641-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u0800-\u0815\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0972-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E45\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10D0-\u10FA\u10FD-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17DC\u1820-\u1842\u1844-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C77\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u2135-\u2138\u2D30-\u2D67\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3006\u303C\u3041-\u3096\u309F\u30A1-\u30FA\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA014\uA016-\uA48C\uA4D0-\uA4F7\uA500-\uA60B\uA610-\uA61F\uA62A\uA62B\uA66E\uA6A0-\uA6E5\uA7FB-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA6F\uAA71-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB\uAADC\uAAE0-\uAAEA\uAAF2\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF66-\uFF6F\uFF71-\uFF9D\uFFA0-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/),e=new RegExp(/[0-9\u0030-\u0039\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0BE6-\u0BEF\u0C66-\u0C6F\u0CE6-\u0CEF\u0D66-\u0D6F\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F29\u1040-\u1049\u1090-\u1099\u17E0-\u17E9\u1810-\u1819\u1946-\u194F\u19D0-\u19D9\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\uA620-\uA629\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19]/),i=new RegExp(/[\u0021-\u0023\u0025-\u002A\u002C-\u002F\u003A\u003B\u003F\u0040\u005B-\u005D\u005F\u007B\u007D\u00A1\u00A7\u00AB\u00B6\u00B7\u00BB\u00BF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u0AF0\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E3B\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65\u002D\u058A\u05BE\u1400\u1806\u2010-\u2015\u2E17\u2E1A\u2E3A\u2E3B\u301C\u3030\u30A0\uFE31\uFE32\uFE58\uFE63\uFF0D\u0028\u005B\u007B\u0F3A\u0F3C\u169B\u201A\u201E\u2045\u207D\u208D\u2329\u2768\u276A\u276C\u276E\u2770\u2772\u2774\u27C5\u27E6\u27E8\u27EA\u27EC\u27EE\u2983\u2985\u2987\u2989\u298B\u298D\u298F\u2991\u2993\u2995\u2997\u29D8\u29DA\u29FC\u2E22\u2E24\u2E26\u2E28\u3008\u300A\u300C\u300E\u3010\u3014\u3016\u3018\u301A\u301D\uFD3E\uFE17\uFE35\uFE37\uFE39\uFE3B\uFE3D\uFE3F\uFE41\uFE43\uFE47\uFE59\uFE5B\uFE5D\uFF08\uFF3B\uFF5B\uFF5F\uFF62\u0029\u005D\u007D\u0F3B\u0F3D\u169C\u2046\u207E\u208E\u232A\u2769\u276B\u276D\u276F\u2771\u2773\u2775\u27C6\u27E7\u27E9\u27EB\u27ED\u27EF\u2984\u2986\u2988\u298A\u298C\u298E\u2990\u2992\u2994\u2996\u2998\u29D9\u29DB\u29FD\u2E23\u2E25\u2E27\u2E29\u3009\u300B\u300D\u300F\u3011\u3015\u3017\u3019\u301B\u301E\u301F\uFD3F\uFE18\uFE36\uFE38\uFE3A\uFE3C\uFE3E\uFE40\uFE42\uFE44\uFE48\uFE5A\uFE5C\uFE5E\uFF09\uFF3D\uFF5D\uFF60\uFF63\u00AB\u2018\u201B\u201C\u201F\u2039\u2E02\u2E04\u2E09\u2E0C\u2E1C\u2E20\u00BB\u2019\u201D\u203A\u2E03\u2E05\u2E0A\u2E0D\u2E1D\u2E21\u005F\u203F\u2040\u2054\uFE33\uFE34\uFE4D-\uFE4F\uFF3F\u0021-\u0023\u0025-\u0027\u002A\u002C\u002E\u002F\u003A\u003B\u003F\u0040\u005C\u00A1\u00A7\u00B6\u00B7\u00BF\u037E\u0387\u055A-\u055F\u0589\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u0AF0\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u166D\u166E\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u1805\u1807-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2016\u2017\u2020-\u2027\u2030-\u2038\u203B-\u203E\u2041-\u2043\u2047-\u2051\u2053\u2055-\u205E\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00\u2E01\u2E06-\u2E08\u2E0B\u2E0E-\u2E16\u2E18\u2E19\u2E1B\u2E1E\u2E1F\u2E2A-\u2E2E\u2E30-\u2E39\u3001-\u3003\u303D\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFE10-\uFE16\uFE19\uFE30\uFE45\uFE46\uFE49-\uFE4C\uFE50-\uFE52\uFE54-\uFE57\uFE5F-\uFE61\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF07\uFF0A\uFF0C\uFF0E\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3C\uFF61\uFF64\uFF65]/),n=new RegExp(/[\u2028\u2029\u0020\u00A0\u1680\u180E\u2000-\u200A\u202F\u205F\u3000]/),s=[33,34,35,37,38,39,40,41,42,44,45,46,47,58,59,63,64,91,92,93,95,123,125,161,171,173,183,187,191];System.Array.resize=function(t,e,i){if(e<0)throw new System.ArgumentOutOfRangeException.$ctor3("newSize",e,"newSize cannot be less than 0.");let n=0;const s=Bridge.isFunction(i);let r=!1,o=t.v;if(o){const t=o;n=t.length,o=new Array(e);const i=Math.min(n,e);if(i>0){const e=t[0];r=e&&"struct"===e.__proto__.$kind,o[0]=r?e.$clone():e}for(let e=1;e<i;e++)o[e]=r?t[e].$clone():t[e]}else o=new Array(e);if(e>n){const t=s?i():i;r=t&&"struct"===t.__proto__.$kind,o[n]=r?t.$clone():t}for(let t=n+1;t<e;t++){let e=s?i():i;r&&(e=e.$clone()),o[t]=e}t.v=o};const r=function(t,e){this.o=t,this.n=e};Object.defineProperty(r.prototype,"v",{get:function(){return null==this.n?this.o:this.o[this.n]},set:function(t){null==this.n&&(t&&t.$clone?t.$clone(this.o):this.o=t),this.o[this.n]=t}}),Bridge.ref=function(t,e){return Bridge.isArray(e)&&(e=System.Array.toIndex(t,e)),new r(t,e)},System.Char.isWhiteSpace=function(t){return" "===t||"\t"===t||"\n"===t||"\v"===t||"\f"===t||"\r"===t||""===t||" "===t},System.Char.isLetter=function(e){return e<256?e>=65&&e<=90||e>=97&&e<=122:t.test(String.fromCharCode(e))},System.Char.isDigit=function(t){return t<256?t>=48&&t<=57:e.test(String.fromCharCode(t))},System.Char.isPunctuation=function(t){return t<256?-1!==s.indexOf(t):i.test(String.fromCharCode(t))},System.Char.isHighSurrogate=function(t){return t>=55296&&t<=56319},System.Char.isLowSurrogate=function(t){return t>=56320&&t<=57343},System.Char.isSurrogate=function(t){return t>=55296&&t<=57343},System.Char.isSeparator=function(t){return t<256?32===t||160===t:n.test(String.fromCharCode(t))}}(),Object.assign(pc,function(){const t=function(t,e){this._videoWidth=0,this._videoHeight=0,this._frameCount=0,this._frameRate=24,void 0!==e&&(this._videoWidth=void 0!==e.width?e.width:this._videoWidth,this._videoHeight=void 0!==e.height?e.height:this._videoHeight,this._frameRate=void 0!==e.frameRate?e.frameRate:this._frameRate,this._frameCount=void 0!==e.frameCount?e.frameCount:this._frameCount),pc.Texture.prototype.constructor.call(this,t,e)};return(t.prototype=Object.create(pc.Texture.prototype)).constructor=t,Object.defineProperty(t.prototype,"frameRate",{get:function(){return this._frameRate}}),Object.defineProperty(t.prototype,"frameCount",{get:function(){return this._frameCount}}),Object.defineProperty(t.prototype,"videoWidth",{get:function(){return this._videoWidth}}),Object.defineProperty(t.prototype,"videoHeight",{get:function(){return this._videoHeight}}),{VideoTexture:t}}()),pc.extend(pc,function(){const t=[new pc.Vec2(0,1),new pc.Vec2(1,1),new pc.Vec2(0,0),new pc.Vec2(1,0)],e=[0,1,2,2,1,3];let i;const n=[0,1,2,0,2,3,0,3,4,0,4,5,0,5,6],s=[0,1,5,5,4,0,1,2,6,6,5,1,2,3,7,7,6,2,4,5,9,9,8,4,5,6,10,10,9,5,6,7,11,11,10,6,8,9,13,13,12,8,9,10,14,14,13,9,10,11,15,15,14,10],r=[0,1,5,5,4,0,1,2,6,6,5,1,2,3,7,7,6,2,4,5,9,9,8,4,6,7,11,11,10,6,8,9,13,13,12,8,9,10,14,14,13,9,10,11,15,15,14,10];let o=null,a=null,u=null;const c=[!0,!1,!1,!1,!1,!1,!0,!1,!1,!1],h=function(){return this};return Object.defineProperty(h,"device",{get:function(){return i||(i=pc.Application.getApplication().graphicsDevice),i}}),h.createSpriteMesh=function(t){const e=new pc.Mesh,i=new Float32Array(t.attributes.vertices),n=t.attributes.vertices.length/5;return e.vertexBuffer=e.defaultVertexBuffer(c,n,i.buffer),e.setIndicies(t.attributes.triangles,UnityEngine.MeshTopology.Triangles,0,!0,0),e},h.createQuadMesh=function(i){const n=new pc.Mesh,s=i.pixelsPerUnit,r=i.pixelSize,o=i.getPivotNormalized(),a=new pc.Vec3(-o.x*r.x/s,-o.y*r.y/s,0),u=new pc.Vec3((1-o.x)*r.x/s,(1-o.y)*r.y/s,0),c=[new pc.Vec3(a.x,u.y,0),new pc.Vec3(u.x,u.y,0),new pc.Vec3(a.x,a.y,0),new pc.Vec3(u.x,a.y,0)];return n.setVectorStream({_items:c,_size:c.length},pc.SEMANTIC_POSITION,3),n.setVectorStream({_items:t,_size:t.length},pc.SEMANTIC_TEXCOORD0,2),n.setIndicies(e,UnityEngine.MeshTopology.Triangles,0,!0,0),n},h.create9SlicedMesh=function(t,e){const i=new pc.Mesh,n=new Float32Array(80);return i.vertexBuffer=i.defaultVertexBuffer(c,16,n.buffer),i.setIndicies(s,UnityEngine.MeshTopology.Triangles,0,!1,0),this.update9SlicedMesh(t,i,e)},h.update9SlicedMesh=function(t,e,i){const n=i.x,s=i.y,r=.5*n,o=.5*s,a=new pc.Vec2(t.pivotNormalized.x*n,t.pivotNormalized.y*s),u=t.getBorderUnits(),c=t.getInnerUvRect(),l=t.getOuterUvRect(),p=new pc.Vec2(n-u.x-u.z,s-u.y-u.w),d=n>u.x+u.z?[-a.x,-a.x+u.x,-a.x+u.x+p.x,-a.x+n]:[-a.x,-a.x+r,-a.x+r,-a.x+n],f=s>u.y+u.w?[-a.y,-a.y+u.y,-a.y+u.y+p.y,-a.y+s]:[-a.y,-a.y+o,-a.y+o,-a.y+s],y=[l.x,c.x,c.z,l.z],m=[l.y,c.y,c.w,l.w],_=e.vertexBuffer;return h.fillMesh(new Float32Array(_.storage),d,f,y,m),_.unlock(),e.recalculateBounds(),e},h.create9TiledMesh=function(t,e){const i=pc.Sprite.vertexFormat||new pc.VertexFormat(h.device,[{semantic:pc.SEMANTIC_POSITION,components:3,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_TEXCOORD0,components:2,type:pc.ELEMENTTYPE_FLOAT32}]),n=e.x,s=e.y,r=t.border,o=t.pixelSize,a=t.pixelsPerUnit,u=(new pc.Vec4).copy(r).scale(1/a),c=new pc.Vec2((o.x-r.x-r.z)/a,(o.y-r.y-r.w)/a),l=new pc.Vec2(n-u.x-u.z,s-u.y-u.w),p=4+2*Math.max(0,Math.ceil(l.x/c.x)),d=4+2*Math.max(0,Math.ceil(l.y/c.y)),f=new pc.Vec2(l.x%c.x,l.y%c.y),y=p*d,m=(p-1)*(d-1)*6,_=new pc.IndexBuffer(h.device,pc.INDEXFORMAT_UINT16,m);let g=0;const A=new Uint16Array(_.lock());for(let t=0;t<d-1;t++)for(let e=0;e<p-1;e++){const i=t*p+e;A[g++]=i,A[g++]=i+1,A[g++]=i+p,A[g++]=i+1,A[g++]=i+1+p,A[g++]=i+p}_.unlock(),_.destroy=function(){};const E=new Float32Array(5*y);this._vertexHelper=UnityEngine.UI.VertexHelper.FromNativeData(E);const b=new pc.VertexBuffer(h.device,i,0);b.storage=E.buffer,b.numVertices=y,b.unlock();const S=new pc.Mesh;return S.vertexBuffer=b,S.indexBuffer[0]=_,S.primitive[0].type=pc.PRIMITIVE_TRIANGLES,S.primitive[0].base=0,S.primitive[0].count=m,S.primitive[0].indexed=!0,S.aabb=new pc.BoundingBox(new pc.Vec3(t.aabb[0],t.aabb[1],t.aabb[2]),new pc.Vec3(t.aabb[3],t.aabb[4],t.aabb[5])),S.subMeshes=[S],this.update9TiledMesh(t,S,e,p,d,c,f),S},h.update9TiledMesh=function(t,e,i,n,s,r,o){const a=i.x,u=i.y,c=new pc.Vec2(t.pivotNormalized.x*a,t.pivotNormalized.y*u),l=t.border,p=t.borderUv,d=t.getBorderUnits(),f=t.getInnerUvRect(),y=t.getOuterUvRect(),m=new pc.Vec2(1-p.z-p.x,1-p.w-p.y),_=new pc.Vec2(a-d.x-d.z,u-d.y-d.w),g=new pc.Vec2(m.x*(o.x/r.x),m.y*(o.y/r.y));let A,E;const b=d.x+d.z;if(a>b)A=[-c.x,-c.x+d.x,-c.x+d.x+_.x,-c.x+a],E=[y.x,f.x,f.z,y.z];else{const t=l.x/(l.x+l.z)*a;A=[-c.x,-c.x+t,-c.x+t,-c.x+a];const e=a/b;E=[y.x,y.x+p.x*e,f.z,f.z+p.z*e]}let S,M;const C=d.y+d.w;if(u>C)S=[-c.y,-c.y+d.y,-c.y+d.y+_.y,-c.y+u],M=[y.y,f.y,f.w,y.w];else{const t=u/C,e=l.y/(l.y+l.w)*u;S=[-c.y,-c.y+e,-c.y+e,-c.y+u],M=[y.y,y.y+p.y*t,f.w,f.w+p.w*t]}const x=e.vertexBuffer,O=new Float32Array(x.storage);let P=0,v=0,T=0;const F=new pc.Vec2(A[0],S[0]);for(let t=0;t<s;t++){let e=0;for(0===t?(e=M[0],F.y=S[0]):1===t?(e=M[1],F.y=S[1]):t===s-3?(e=M[1]+g.y,F.y=S[2]):t===s-2?(e=M[2],F.y=S[2]):t===s-1?(e=M[3],F.y=S[3]):e=t%2==0?M[1]:M[2],v=t*n,T=5*v,h.fillStride(O,T,A[0],F.y,E[0],e),v+=1,T=5*v,h.fillStride(O,T,A[1],F.y,E[1],e),F.x=A[1],P=2;P<n-4;P+=2)v=t*n+P,T=5*v,h.fillStride(O,T,F.x,F.y,E[1],e),F.x+=P===n-4?o.x:r.x,v+=1,T=5*v,h.fillStride(O,T,F.x,F.y,E[2],e);n>4&&(P=n-4,v=t*n+P,T=5*v,h.fillStride(O,T,F.x,F.y,E[1],e),F.x+=o.x,v+=1,T=5*v,h.fillStride(O,T,A[2],F.y,E[1]+g.x,e)),P=n-2,v=t*n+P,T=5*v,h.fillStride(O,T,A[2],F.y,E[2],e),P=n-1,v=t*n+P,T=5*v,h.fillStride(O,T,A[3],F.y,E[3],e),t===s-4?F.y+=o.y:t%2==0&&(F.y+=r.y)}x.unlock()},h.updateMeshRadial=function(t,e,i,n,s,r,o,a,u,c,l,p){if(!i&&!n)return;const d=new pc.Vec4(0,0,0,0),f=new pc.Vec2(0,0);h.calculatePaddings(t,i,n,u,c,l,d,f);let y=360*p;const m=f.x/2,_=d.x+m,g=f.y/2,A=d.y+g,E=s.z/2,b=s.w/2,S=s.x+E,M=s.y+b,C=[-a.x+_],x=[-a.y+A],O=[S],P=[M];let v=0,T=0,F=!1;switch(r){case pc.FILL_ORIGIN_RADIAL_BOTTOM:T=270;break;case pc.FILL_ORIGIN_RADIAL_RIGHT:T=0;break;case pc.FILL_ORIGIN_RADIAL_TOP:T=90;break;case pc.FILL_ORIGIN_RADIAL_LEFT:T=180}const w=o?-1:1;let D=0,I=0;for(;y>0;){const t=Math.min(y,v);T+=w*t,T=(T+360)%360,T<=45||T>315?(C.push(-a.x+_+m),O.push(S+E),I=Math.tan(T*pc.math.DEG_TO_RAD),x.push(-a.y+A+g*I),P.push(M+b*I)):T<=135?(D=1/Math.tan(T*pc.math.DEG_TO_RAD),C.push(-a.x+_+m*D),O.push(S+E*D),x.push(-a.y+A+g),P.push(M+b)):T<=225?(C.push(-a.x+_-m),O.push(S-E),I=-Math.tan(T*pc.math.DEG_TO_RAD),x.push(-a.y+A+g*I),P.push(M+b*I)):T<=315&&(D=-1/Math.tan(T*pc.math.DEG_TO_RAD),C.push(-a.x+_+m*D),O.push(S+E*D),x.push(-a.y+A-g),P.push(M-b)),y-=t,F?v=90:(v=45,F=!0)}for(;C.length<16;)C.push(_);for(;x.length<16;)x.push(A);for(;O.length<16;)O.push(S);for(;P.length<16;)P.push(M);const B=e.vertexBuffer,R=new Float32Array(B.storage);h.fillMesh2(R,C,x,O,P,16),B.unlock()},h.calculatePaddings=function(t,e,i,n,s,r,o,a){let u=e,c=i,h=1,l=1;if(t){const e=t.texture;e&&(u=e.width,c=e.height),o.copy(t.transparency)}if(t){const e=t.getTextureRect();u=e.z+o.x+o.z,c=e.w+o.y+o.w}if(e===u&&i===c||(h=e/u,l=i/c),a.x=e,a.y=i,n&&s!==pc.SPRITE_TYPE_SLICED&&s!==pc.SPRITE_TYPE_TILED){const t=Math.min(h,l);a.x=t*u,a.y=t*c,o.scale(t)}else 1===h&&1===l||(o.x*=h,o.y*=l,o.z*=h,o.w*=l);return a.x===e&&a.y===i||o.add(new pc.Vec4((e-a.x)*r.x,(i-a.y)*r.y,(e-a.x)*(1-r.x),(i-a.y)*(1-r.y))),o},h.setFillEdges=function(t,e,i,n){return n=n||new pc.Vec4,i===pc.FILL_METHOD_HORIZONTAL&&n.set(t===pc.FILL_ORIGIN_BOTTOM_LEFT?0:1-e,0,t===pc.FILL_ORIGIN_BOTTOM_LEFT?e:1,1),i===pc.FILL_METHOD_VERTICAL&&n.set(0,t===pc.FILL_ORIGIN_BOTTOM_LEFT?0:1-e,1,t===pc.FILL_ORIGIN_BOTTOM_LEFT?e:1),n},h.fillMesh=function(t,e,i,n,s){for(let r=0;r<4;r++)for(let o=0;o<4;o++){h.fillStride(t,5*(4*r+o),e[o],i[r],n[o],s[r])}},h.fillMesh2=function(t,e,i,n,s,r){let o=0;for(let a=0;a<r;a++)o=5*a,t[o+0]=e[a],t[o+1]=i[a],t[o+2]=0,t[o+3]=n[a],t[o+4]=s[a]},h.fillBufferZeros=function(t){for(let e=0;e<t.length;e++)t[e]=0},h.createSlicedUiMesh=function(){const t=new pc.Mesh,e=new Float32Array(80);return t.vertexBuffer=t.defaultVertexBuffer(c,16,e.buffer),t.setIndicies(s,UnityEngine.MeshTopology.Triangles,0,!1,0),t},h.imageIndexBuffer=function(){if(o)return o;return o=new pc.IndexBuffer(h.device,pc.INDEXFORMAT_UINT16,s.length),new Uint16Array(o.lock()).set(s),o.unlock(),o.destroy=function(){},o},h.emptyCenterImageIndexBuffer=function(){if(a)return a;return a=new pc.IndexBuffer(h.device,pc.INDEXFORMAT_UINT16,r.length),new Uint16Array(a.lock()).set(r),a.unlock(),a.destroy=function(){},a},h.imageRadialIndexBuffer=function(){if(u)return u;return u=new pc.IndexBuffer(h.device,pc.INDEXFORMAT_UINT16,n.length),new Uint16Array(u.lock()).set(n),u.unlock(),u.destroy=function(){},u},h.fillStride=function(t,e,i,n,s,r){t[e]=i,t[e+1]=n,t[e+2]=0,t[e+3]=s,t[e+4]=r},{SpriteUtils:h}}()),pc.extend(pc,function(){const t=function(t){return this.attributes=t,this.$sprite=!0,this.mesh=null,this};return t.create=function(t,e,i,n,s,r,o){const a=(e.z-e.x)/2/n,u=(e.w-e.y)/2/n;return new pc.Sprite({aabb:{center:[0,0,0],halfExtents:[a,u,0]},border:o,bounds:[-a,-u,a,u],pixelsPerUnit:n,texture:t,textureRect:(new pc.Vec4).copy(e),transparency:new pc.Vec4(0,0,0,0),triangles:[0,1,2,2,1,3],vertices:[-a,u,0,0,1,a,u,0,1,1,-a,-u,0,0,0,a,-u,0,1,0],pivot:i.clone()})},t.prototype={getUvRect:function(){const t=this.textureRect,e=this.texture;return new pc.Vec4(t.x/e.width,t.y/e.height,(t.z-t.x)/e.width,(t.w-t.y)/e.height)},getInnerUvRect:function(){const t=this.uvRect,e=this.borderUv;return new pc.Vec4(t.x+e.x,t.y+e.y,t.x+t.z-e.z,t.y+t.w-e.w)},getOuterUvRect:function(){const t=this.uvRect;return new pc.Vec4(t.x,t.y,t.x+t.z,t.y+t.w)},getPivot:function(){return this.attributes.pivot},getPivotNormalized:function(){const t=this.attributes.textureRect;return new pc.Vec2((this.attributes.pivot.x-t.x)/t.z,(this.attributes.pivot.y-t.y)/t.w)},getAABB:function(){return this.attributes.aabb},getVertices:function(){const t=new Array(this.attributes.vertices.length/5);for(let e=0;e<t.length;e++)t[e]=new pc.Vec2(this.attributes.vertices[5*e],this.attributes.vertices[5*e+1]);return t},getTriangles:function(){return this.attributes.triangles},getTextureRect:function(){return this.attributes.textureRect},getBorder:function(){return this.attributes.border},getBorderUnits:function(){const t=this.border,e=this.pixelsPerUnit;return(new pc.Vec4).copy(t).scale(1/e)},getBorderUv:function(){const t=this.uvRect,e=this.border,i=this.pixelSize;return new pc.Vec4(t.z*(e.x/i.x),t.w*(e.y/i.y),t.z*(e.z/i.x),t.w*(e.w/i.y))},getTexture:function(){return this.attributes.texture},getTransparency:function(){return this.attributes.transparency},getBounds:function(){return this.attributes.bounds},getPixelsPerUnit:function(){return this.attributes.pixelsPerUnit},getTextureRectOffset:function(){return this.attributes.textureRectOffset},getMesh:function(){return this.mesh?this.mesh:(this.mesh=this.attributes.vertices?pc.SpriteUtils.createSpriteMesh(this):pc.SpriteUtils.createQuadMesh(this),this.mesh)}},Object.defineProperty(t.prototype,"pivotNormalized",{get:t.prototype.getPivotNormalized}),Object.defineProperty(t.prototype,"pivot",{get:t.prototype.getPivot}),Object.defineProperty(t.prototype,"aabb",{get:t.prototype.getAABB}),Object.defineProperty(t.prototype,"transparency",{get:t.prototype.getTransparency}),Object.defineProperty(t.prototype,"textureRect",{get:t.prototype.getTextureRect}),Object.defineProperty(t.prototype,"pixelsPerUnit",{get:t.prototype.getPixelsPerUnit}),Object.defineProperty(t.prototype,"texture",{get:t.prototype.getTexture}),Object.defineProperty(t.prototype,"border",{get:t.prototype.getBorder}),Object.defineProperty(t.prototype,"borderUv",{get:t.prototype.getBorderUv}),Object.defineProperty(t.prototype,"uvRect",{get:t.prototype.getUvRect}),Object.defineProperty(t.prototype,"vertices",{get:t.prototype.getVertices}),Object.defineProperty(t.prototype,"pixelSize",{get:function(){return new pc.Vec2(this.textureRect.z,this.textureRect.w)}}),{Sprite:t}}()),pc.extend(pc,function(){const t=function(t,e,i){this._path=t,this._property=e,this._componentTypeName=i,this._name=t+":"+i+":"+e,this._keys=[]};t.prototype={};const e=function(){return this};return(e.prototype=Object.create(pc.Animation.prototype)).constructor=e,pc.extend(e.prototype,{}),Object.defineProperty(e.prototype,"key",{get:function(){return this._key=this._key||this.name+"#"+this.id,this._key}}),{CurveAnimation:e,CurveKey:function(t,e,i,n){this.time=t,this.value=e,this.inTangent=i,this.outTangent=n},CurveNode:t}}()),pc.extend(pc,function(){function t(t){this._written=!1,this._curve=t,this._value=null}t.prototype.write=function(){return!!this._written&&(this._written=!1,this._object?this._target[this._object][this._property]=this._value:this._target[this._property]=this._value,!0)},t.prototype.setValue=function(t){if(void 0===t)throw new Error;this._written=t!==this._value,this._value=t};const e=function(t){this._guid=pc.guid.create(),this._speed=1,this._looping=!0,this._animation=null,this._time=0,this._interpolatedKeys=[],this._interpolatedKeyDict={},this._interpolatedKeyNames=[],this._currKeyIndices={},this.graph=t};return(e.prototype=Object.create(pc.Skeleton.prototype)).constructor=e,e.prototype={setGraph:function(t){this.graph=t,this._setupKeys()},setAnimation:function(t){this._animation=t,this._looping=t.isLooping,this._time=0,this._setupKeys()},_setupKeys:function(){this._sampler=new pc.CurveSampler},updateGraph:function(){this._sampler.apply(UnityEngine.Object.FromHandle(UnityEngine.GameObject,this.graph))},blend:function(t,e,i){const n=t._sampler.id+"+"+e._sampler.id;this._blendId!==n&&(this._sampler=new pc.CurveSampler),this._sampler.blendSamplers(t._sampler,i,e._sampler,1-i)},addTime:function(t){if(null!==this._animation){const e=this._animation.curves,i=this._animation.length;if(this._time===i&&!this._looping)return;t*=this._speed,this._time+=t,this._time>=i?this._time=this._looping?0:i:this._time<0&&(this._time=this._looping?i:0);for(let t=0;t<e.length;t++)e[t].sample(this._sampler,this._time)}},getSpeed:function(){return this._speed},setSpeed:function(t){this._speed=t},getLooping:function(){return this._looping},setLooping:function(t){this._looping=t}},Object.defineProperty(e.prototype,"animation",{get:pc.Skeleton.prototype.getAnimation,set:e.prototype.setAnimation}),Object.defineProperty(e.prototype,"speed",{get:e.prototype.getSpeed,set:e.prototype.setSpeed}),Object.defineProperty(e.prototype,"looping",{get:e.prototype.getLooping,set:e.prototype.setLooping}),Object.defineProperty(e.prototype,"currentTime",{get:function(){return this._time},set:function(t){this._time=t;const e=this._interpolatedKeys.length;for(let t=0;t<e;t++){const e=this._interpolatedKeys[t]._name;this._currKeyIndices[e]=0}this.addTime(0),this.updateGraph()}}),{PropertySkeleton:e}}()),pc.extend(pc,function(){const t=function(t){return this.id=t.id,this.name=t.name,this.speed=t.speed,this.speedParameter=t.speedParameter,this.speedParameterActive=t.speedParameterActive,this.mirror=t.mirror,this.mirrorParameter=t.mirrorParameter,this.mirrorParameterActive=t.mirrorParameterActive,this.motion=t.motion,this};t.prototype={};const e=function(t){return this.condition=t.condition,this.parameter=t.parameter,this.threshold=t.threshold,this};e.CONDITION_IF=1,e.CONDITION_IF_NOT=2,e.CONDITION_GREATER=3,e.CONDITION_LESS=4,e.CONDITION_EQUALS=6,e.CONDITION_NOT_EQUAL=7,e.prototype={matches:function(t,i){const n=i[this.parameter]||t[this.parameter];switch(this.condition){case e.CONDITION_IF:return i[this.parameter]&&(i[this.parameter]=!1),n;case e.CONDITION_IF_NOT:return!n;case e.CONDITION_GREATER:return n>this.threshold;case e.CONDITION_LESS:return n<this.threshold;case e.CONDITION_EQUALS:return n===this.threshold;case e.CONDITION_NOT_EQUAL:return n!==this.threshold}return!1}};const i=function(t){return this.sourceState=t.sourceState,this.targetState=t.targetState,this.mute=t.mute,this.solo=t.solo,this.exitTime=t.exitTime,this.hasExitTime=t.hasExitTime,this.duration=t.duration,this.hasFixedDuration=t.hasFixedDuration,this.conditions=t.conditions,this.canTransitionToSelf=t.canTransitionToSelf,this};i.prototype={matches:function(t,e){if(0===this.conditions.length)return!1;for(let i=0;i<this.conditions.length;i++)if(!this.conditions[i].matches(t,e))return!1;return!0}};const n=function(t){return this.name=t.name,this.type=t.type,this.type===n.PARAMETER_TYPE_FLOAT&&(this.default=t.defaultFloat),this.type===n.PARAMETER_TYPE_INT&&(this.default=t.defaultInt),this.type===n.PARAMETER_TYPE_BOOL&&(this.default=t.defaultBool),this};n.PARAMETER_TYPE_FLOAT=1,n.PARAMETER_TYPE_INT=3,n.PARAMETER_TYPE_BOOL=4,n.PARAMETER_TYPE_TRIGGER=9,n.prototype={};const s=function(t){this.id=t.id,this.states=t.states,this.stateMap={};for(let t=0;t<this.states.length;t++)this.stateMap[this.states[t].id]=this.states[t];return this.defaultState=t.defaultState,this.entryTransitions=t.entryTransitions,this.anyStateTransitions=t.anyStateTransitions,this.transitions=t.transitions,this};s.prototype={};const r=function(t){return this.layers=t.layers,this.parameters=t.parameters,this};return r.prototype={},r.Parameter=n,r.Layer=s,r.State=t,r.Transition=i,r.Condition=e,{AnimatorController:r}}()),pc.extend(pc,function(){const t=function(t){return this._animation=t,t.animator=this,this.setAnimatorController(null),pc.ComponentSystem.on("update",this.update,this),this};return t.prototype={setAnimatorController:function(t){},scheduleTransitionRequest:function(t,e){},processTransitionQueue:function(t,e){},applyCurrentStateSettings:function(t){},processLayer:function(t){},update:function(t){},setTrigger:function(t){},setParameter:function(t,e){}},{Animator:t}}()),function(){function t(){this._seed=1}Object.assign(t.prototype,{setSeed:function(t){this._seed=t},nextInteger:function(){return this._seed=16807*this._seed%2147483647},nextFloat:function(){return this.nextInteger()/2147483647},nextGFloat:function(){return(this.nextFloat()+this.nextFloat()+this.nextFloat()+this.nextFloat()+this.nextFloat()+this.nextFloat())/6}}),pc.Random=t}(),function(){function t(){this.value=0}t.prototype.update=function(t){this.value+=t},t.prototype.take=function(t){this.value>=t&&(this.value-=t)},Object.defineProperty(t.prototype,"accumulated",{get:function(){return Math.floor(this.value)}}),pc.IntAccumulator=t}(),function(){const t={BLEND:0,FIXED:1},e=function(e,i,n){e=e||[],i=i||[],this.colorKeys="object"!=typeof e[0]?this.formatColorKeys(e):e,this.alphaKeys="object"!=typeof i[0]?this.formatAlphaKeys(i):i,this.mode=n||t.BLEND},i={lower:null,upper:null},n={lower:null,upper:null};let s,r;e.prototype.sampleInplace=function(e,s){if(this.findExtremeColors(e,i),this.findExtremeAlphaValues(e,n),i.lower===i.upper&&n.lower===n.upper)return s.copy(i.lower.color),void(s.a=n.lower.alpha);switch(this.mode){case t.FIXED:return void(i.lower.position===e?(s.copy(i.lower.color),s.a=n.lower.alpha):(s.copy(i.upper.color),s.a=n.upper.alpha));case t.BLEND:{const t=(e-i.lower.time)/(i.upper.time-i.lower.time),r=(e-n.lower.time)/(n.upper.time-n.lower.time);return void this.lerpColorInPlace(i.lower.color,i.upper.color,n.lower.alpha,n.upper.alpha,t,r,s)}default:throw new System.NotSupportedException}},e.prototype.evaluate=function(t){const e=new pc.Color;return this.sampleInplace(t,e),e},e.prototype.evaluateRef=function(t,e){return this.sampleInplace(t,e),e},e.prototype.findExtremeColors=function(t,e){s=r=this.colorKeys[0];for(let e=0;e<this.colorKeys.length;e++){if(!(this.colorKeys[e].time<=t)){r=this.colorKeys[e];break}s=r=this.colorKeys[e]}e.lower=s,e.upper=r},e.prototype.findExtremeAlphaValues=function(t,e){s=r=this.alphaKeys[0];for(let e=0;e<this.alphaKeys.length;e++){if(!(this.alphaKeys[e].time<=t)){r=this.alphaKeys[e];break}s=r=this.alphaKeys[e]}e.lower=s,e.upper=r},e.prototype.lerpColorInPlace=function(t,e,i,n,s,r,o){o.r=pc.math.lerp(t.r,e.r,s),o.g=pc.math.lerp(t.g,e.g,s),o.b=pc.math.lerp(t.b,e.b,s),o.a=pc.math.lerp(i,n,r)},e.prototype.formatColorKeys=function(t){const e=[];for(let i=0;i<t.length;i+=5){const n={};n.time=t[i],n.color=new pc.Color(t[i+1],t[i+2],t[i+3],t[i+4]),e.push(n)}return e},e.prototype.formatAlphaKeys=function(t){const e=[];for(let i=0;i<t.length;i+=2){const n={};n.time=t[i],n.alpha=t[i+1],e.push(n)}return e},e.prototype.setKeys=function(t,e){this.colorKeys=("object"!=typeof t[0]?this.formatColorKeys(t):t)||[],this.alphaKeys=("object"!=typeof e[0]?this.formatAlphaKeys(e):e)||[]},e.prototype.setKey=function(t,e){for(let e=0;e<this.colorKeys.length;e++)this.colorKeys.time===t.time&&(this.colorKeys[e]=t,t=null);null!=t&&this.colorKeys.push(t);for(let t=0;t<this.alphaKeys.length;t++)this.alphaKeys.time===e.time&&(this.alphaKeys[t]=e,e=null);null!=e&&this.alphaKeys.push(e)},pc.GradientType=t,pc.ColorGradient=e}(),function(){const t={Constant:0,Curve:1,TwoCurves:2,TwoConstants:3},e=function(e,i,n){"number"==typeof e&&i instanceof pc.AnimationCurve&&n instanceof pc.AnimationCurve?this.init(0,0,i,n,t.TwoCurves,e):"number"==typeof e&&"number"==typeof i?this.init(e,i,new pc.AnimationCurve({}),new pc.AnimationCurve({}),t.TwoConstants,1):"number"==typeof e&&i instanceof pc.AnimationCurve?this.init(0,0,new pc.AnimationCurve({}),i,t.Constant,e):"number"==typeof e?this.init(0,e,new pc.AnimationCurve({}),new pc.AnimationCurve({}),t.Constant,1):this.init(0,0,new pc.AnimationCurve({}),new pc.AnimationCurve({}),t.Constant,1)};e.prototype.init=function(t,e,i,n,s,r){this.m_ConstantMax=e,this.m_ConstantMin=t,this.m_CurveMax=n,this.m_CurveMin=i,this.m_CurveMultiplier=r,this.m_Mode=s,this._random=new pc.Random},Object.defineProperty(e.prototype,"mode",{get:function(){return this.m_Mode},set:function(t){this.m_Mode=t}}),Object.defineProperty(e.prototype,"constant",{get:function(){return this.m_ConstantMax},set:function(t){this.m_ConstantMax=t}}),Object.defineProperty(e.prototype,"constantMax",{get:function(){return this.m_ConstantMax},set:function(t){this.m_ConstantMax=t}}),Object.defineProperty(e.prototype,"constantMin",{get:function(){return this.m_ConstantMin},set:function(t){this.m_ConstantMin=t}}),Object.defineProperty(e.prototype,"curve",{get:function(){return this.m_CurveMax},set:function(t){this.m_CurveMax=t}}),Object.defineProperty(e.prototype,"curveMax",{get:function(){return this.m_CurveMax},set:function(t){this.m_CurveMax=t}}),Object.defineProperty(e.prototype,"curveMin",{get:function(){return this.m_CurveMin},set:function(t){this.m_CurveMin=t}}),Object.defineProperty(e.prototype,"curveMultiplier",{get:function(){return this.m_CurveMultiplier},set:function(t){this.m_CurveMultiplier=t}}),e.prototype.evaluate=function(e){switch(this.mode){case t.Constant:return this._evaluateConstant();case t.Curve:return this._evaluateCurve(e);case t.TwoConstants:return this._evaluateTwoConstants(e,this._random.nextFloat());case t.TwoCurves:return this._evaluateTwoCurves(e,this._random.nextFloat());default:return null}},e.prototype._evaluateConstant=function(){return this.m_ConstantMax},e.prototype._evaluateCurve=function(t){return this.m_CurveMax.value(t)*this.m_CurveMultiplier},e.prototype._evaluateTwoCurves=function(t,e){const i=this.m_CurveMin.value(t)*this.m_CurveMultiplier,n=this.m_CurveMax.value(t)*this.m_CurveMultiplier;return pc.math.lerp(i,n,e)},e.prototype._evaluateTwoConstants=function(t,e){return pc.math.lerp(this.m_ConstantMin,this.constantMax,e)},pc.MinMaxCurveMode=t,pc.MinMaxCurve=e}(),function(){const t=new pc.Color,e=new pc.Color,i={Color:0,Gradient:1,TwoColors:2,TwoGradients:3,RandomColor:4},n=function(t,e){t instanceof pc.Color&&e instanceof pc.Color?this.init(t,e,new pc.ColorGradient,new pc.ColorGradient,i.TwoColors):t instanceof pc.ColorGradient&&e instanceof pc.ColorGradient?this.init(0,0,t,e,i.TwoGradients):t instanceof pc.Color?this.init(0,t,new pc.ColorGradient,new pc.ColorGradient,i.Color):t instanceof pc.ColorGradient?this.init(0,0,new pc.ColorGradient,t,i.Gradient):this.init(0,0,new pc.ColorGradient,new pc.ColorGradient,i.Color)};n.prototype.init=function(t,e,i,n,s){return this.m_ColorMax=e,this.m_ColorMin=t,this.m_GradientMax=n,this.m_GradientMin=i,this.m_Mode=s,this._random=new pc.Random,this},Object.defineProperty(n.prototype,"mode",{get:function(){return this.m_Mode},set:function(t){this.m_Mode=t}}),Object.defineProperty(n.prototype,"color",{get:function(){return this.m_ColorMax},set:function(t){this.m_ColorMax=t}}),Object.defineProperty(n.prototype,"colorMin",{get:function(){return this.m_ColorMin},set:function(t){this.m_ColorMin=t}}),Object.defineProperty(n.prototype,"colorMax",{get:function(){return this.m_ColorMax},set:function(t){this.m_ColorMax=t}}),Object.defineProperty(n.prototype,"gradient",{get:function(){return this.m_GradientMax},set:function(t){this.m_GradientMax=t}}),Object.defineProperty(n.prototype,"gradientMax",{get:function(){return this.m_GradientMax},set:function(t){this.m_GradientMax=t}}),Object.defineProperty(n.prototype,"gradientMin",{get:function(){return this.m_GradientMin},set:function(t){this.m_GradientMin=t}}),n.prototype.evaluate=function(t){const e=new pc.Color(1,1,1,1);switch(this.mode){case i.Color:this._evaluateColorInplace(e);break;case i.Gradient:this._evaluateGradientInplace(t,e);break;case i.TwoColors:this._evaluateTwoColorsInplace(t,e);break;case i.TwoGradients:this._evaluateTwoGradientsInplace(t,e);break;case i.RandomColor:this._evaluateGradientInplace(this._random.nextFloat(),e)}return e},n.prototype.evaluateInplace=function(t,e){switch(this.mode){case i.Color:this._evaluateColorInplace(e);break;case i.Gradient:this._evaluateGradientInplace(t,e);break;case i.TwoColors:this._evaluateTwoColorsInplace(t,e);break;case i.TwoGradients:this._evaluateTwoGradientsInplace(t,e);break;case i.RandomColor:this._evaluateGradientInplace(this._random.nextFloat(),e)}},n.prototype._evaluateColorInplace=function(t){t.copy(this.m_ColorMax)},n.prototype._evaluateGradientInplace=function(t,e){this.gradient.sampleInplace(t,e)},n.prototype._evaluateTwoGradientsInplace=function(i,n){this.gradientMin.sampleInplace(i,t),this.gradientMax.sampleInplace(i,e);const s=this._random.nextFloat();n.copy(t).lerpTo(e,s)},n.prototype._evaluateTwoColorsInplace=function(t,e){const i=this._random.nextFloat();e.copy(this.colorMin).lerpTo(this.m_ColorMax,i)},pc.MinMaxGradientMode=i,pc.MinMaxGradient=n}(),function(){const t=new pc.Vec3;function e(){this.t=new pc.Vec3,this.r=new pc.Quat,this.s=new pc.Vec3,this.ownSpeed=new pc.Vec3,this.totalSpeed=new pc.Vec3,this.initialScale=new pc.Vec3,this.tmpScale=new pc.Vec3(1,1,1),this.angularVelocity=new pc.Vec3,this.startRotationAxis=new pc.Vec3(0,0,1),this.color=new pc.Color(1,1,1,1),this.startColor=new pc.Color(1,1,1,1),this.texSheetAnimationInitialized=!1,this.lifetime=0,this.elapsedTime=0,this.birthTimeOffset=0,this.velocityOverLifetimeValue=t,this.rotationOverLifetimeValue=t,this.colorOverLifetimeValue=t,this.colorBySpeedValue=t,this.sizeOverLifetimeValue=t,this.inheritVelocityValue=t,this.forceOverLifetimeValue=t}Object.defineProperty(e.prototype,"lifePart",{get:function(){return this.elapsedTime/this.lifetime}}),Object.defineProperty(e.prototype,"isAlive",{get:function(){return this.elapsedTime<this.lifetime}}),e.prototype.initialize=function(t){this.t.copy(t.translation),this.r.copy(t.rotation),this.s.copy(t.scale),this.initialScale.copy(t.scale),t.startRotationAxis&&this.startRotationAxis.copy(t.startRotationAxis),this.ownSpeed.copy(t.speed),this.color.copy(t.color),this.startColor.copy(t.color),this.lifetime=t.lifetime,this.elapsedTime=0,this.startFrame=null,this.tmpScale.set(1,1,1),this.velocityOverLifetimeValue=null,this.rotationOverLifetimeValue=null,this.colorOverLifetimeValue=null,this.colorBySpeedValue=null,this.sizeOverLifetimeValue=null,this.inheritVelocityValue=null,this.forceOverLifetimeValue=null,this.birthTimeOffset=t.birthTimeOffset,this.texSheetAnimationInitialized=!1,this.angularVelocity.set(0,0,0),this.totalSpeed.set(0,0,0)},e.prototype.copy=function(t){this.t.copy(t.t),this.r.copy(t.r),this.s.copy(t.s),this.ownSpeed.copy(t.ownSpeed),this.totalSpeed.copy(t.totalSpeed),this.initialScale.copy(t.initialScale),this.tmpScale.copy(t.tmpScale),this.angularVelocity.copy(t.angularVelocity),this.color.copy(t.color),this.startColor.copy(t.startColor),this.texSheetAnimationInitialized=t.texSheetAnimationInitialized,this.lifetime=t.lifetime,this.elapsedTime=t.elapsedTime,this.startRotationAxis.copy(t.startRotationAxis),t.velocityOverLifetimeValue?this.velocityOverLifetimeValue=(new pc.Vec3).copy(t.velocityOverLifetimeValue):this.velocityOverLifetimeValue=null,t.rotationOverLifetimeValue?this.rotationOverLifetimeValue=(new pc.Vec3).copy(t.rotationOverLifetimeValue):this.rotationOverLifetimeValue=null,t.colorOverLifetimeValue?this.colorOverLifetimeValue=(new pc.Vec3).copy(t.colorOverLifetimeValue):this.colorOverLifetimeValue=null,t.colorBySpeedValue?this.colorBySpeedValue=(new pc.Vec3).copy(t.colorBySpeedValue):this.colorBySpeedValue=null,t.sizeOverLifetimeValue?this.sizeOverLifetimeValue=(new pc.Vec3).copy(t.sizeOverLifetimeValue):this.sizeOverLifetimeValue=null,t.inheritVelocityValue?this.inheritVelocityValue=(new pc.Vec3).copy(t.inheritVelocityValue):this.inheritVelocityValue=null,t.forceOverLifetimeValue?this.forceOverLifetimeValue=(new pc.Vec3).copy(t.forceOverLifetimeValue):this.forceOverLifetimeValue=null},e.prototype.GetCurrentSize3D=function(t){return this.tmpScale.copy(this.initialScale),null!=t.sizeOverLifetime&&t.sizeOverLifetime.enabled&&t.sizeOverLifetime.processInplace(this),null!=t.sizeBySpeed&&t.sizeBySpeed.enabled&&t.sizeBySpeed.processInplace(this),this.tmpScale},e.prototype.GetCurrentColor=function(t){return this.color.copy(this.startColor),null!=t.colorOverLifetime&&t.colorOverLifetime.enabled&&t.colorOverLifetime.processInplace(this),null!=t.colorBySpeed&&t.colorBySpeed.enabled&&t.colorBySpeed.processInplace(this),this.color},pc.Particle=e}(),function(){function t(t){this._particles=[],this.aliveCount=0,this._maxParticles=t||0}Object.defineProperty(t.prototype,"maxParticles",{get:function(){return this._maxParticles},set:function(t){this._maxParticles=t}}),Object.defineProperty(t.prototype,"aliveCount",{get:function(){return this._aliveCount},set:function(t){this._aliveCount=t}}),t.prototype.resize=function(t){if(t=Math.min(Math.max(t,1),this.maxParticles),this._particles.length<t){const e=new Array(t);let i=0;for(i=0;i<this._particles.length;++i)e[i]=this._particles[i];for(;i<t;++i)e[i]=new pc.Particle;this._particles=e}},t.prototype.get=function(t){return this._particles.length<=t&&this._particles.length<this.maxParticles&&this.resize(2*this._particles.length),this._particles[t]},t.prototype.acquire=function(){if(this.aliveCount<this.maxParticles){this.aliveCount>=this._particles.length&&this.resize(2*this._particles.length);const t=this._particles[this.aliveCount];return t._cacheIndex=this.aliveCount,this.aliveCount++,t}return null},t.prototype.release=function(t){const e=t._cacheIndex,i=this.aliveCount-1,n=this._particles[e];this._particles[e]=this._particles[i],this._particles[e]._cacheIndex=e,this._particles[i]=n,--this.aliveCount},t.prototype.clear=function(){this.aliveCount=0},t.prototype.dispose=function(){this._particles=null,this.aliveCount=0,this.maxParticles=0},pc.ParticleCache=t}(),function(){const t={translation:new pc.Vec3,rotation:new pc.Quat,startRotationAxis:new pc.Vec3,scale:new pc.Vec3,direction:new pc.Vec3,speed:new pc.Vec3,lifetime:0,color:new pc.Color},e=new pc.Quat,i=new pc.Vec3,n=new pc.Vec3,s=new pc.Mat4,r=new pc.Vec3,o=new pc.Vec3,a=new pc.Quat;function u(){this._entity=null,this._random=new pc.Random,this._cache=new pc.ParticleCache,this._shouldEmit=!1,this._paused=!1,this._lifetime=0,this._playTime=0,this.delayTimer=0,this._emittedCount=0,this._previousPosition=new pc.Vec3,this._currentVelocity=new pc.Vec3,this._scaleFactor=new pc.Vec3,pc.events.attach(this),this.colorBySpeed=new pc.ParticleSystemColorBySpeed(this),this.colorOverLifetime=new pc.ParticleSystemColorOverLifetime(this),this.emission=new pc.ParticleSystemEmitter(this),this.main=new pc.ParticleSystemMain(this),this.rotationBySpeed=new pc.ParticleSystemRotationBySpeed(this),this.rotationOverLifetime=new pc.ParticleSystemRotationOverLifetime(this),this.shape=new pc.ParticleSystemShape(this),this.sizeBySpeed=new pc.ParticleSystemSizeBySpeed(this),this.sizeOverLifetime=new pc.ParticleSystemSizeOverLifetime(this),this.textureSheetAnimation=new pc.ParticleSystemTextureSheetAnimation(this),this.velocityOverLifetime=new pc.ParticleSystemVelocityOverLifetime(this),this.noise=new pc.ParticleSystemNoise(this),this.inheritVelocity=new pc.ParticleSystemInheritVelocity(this),this.forceOverLifetime=new pc.ParticleSystemForceOverLifetime(this),this.limitVelocityOverLifetime=new pc.ParticleSystemLimitVelocityOverLifetime(this)}Object.defineProperty(u.prototype,"isActive",{get:function(){return this._shouldEmit||this._cache.aliveCount>0}}),Object.defineProperty(u.prototype,"entity",{get:function(){return this._entity}}),Object.defineProperty(u.prototype,"lifePart",{get:function(){return this._lifetime/this.main.duration}}),Object.defineProperty(u.prototype,"lifetime",{get:function(){return this._lifetime},set:function(t){return this._lifetime=t,t}}),Object.defineProperty(u.prototype,"particleCount",{get:function(){return this._cache.aliveCount}}),Object.defineProperty(u.prototype,"emittedParticlesCount",{get:function(){return this._emittedCount}}),Object.defineProperty(u.prototype,"main",{get:function(){return this._mainModule},set:function(t){return this._mainModule=t,t}}),Object.defineProperty(u.prototype,"emission",{get:function(){return this._emission},set:function(t){return this._emission=t,t}}),Object.defineProperty(u.prototype,"shape",{get:function(){return this._shapeModule},set:function(t){return this._shapeModule=t,t}}),Object.defineProperty(u.prototype,"velocityOverLifetime",{get:function(){return this._velocityOverLifetimeModule},set:function(t){return this._velocityOverLifetimeModule=t,t}}),Object.defineProperty(u.prototype,"colorOverLifetime",{get:function(){return this._colorOverLifetimeModule},set:function(t){return this._colorOverLifetimeModule=t,t}}),Object.defineProperty(u.prototype,"colorBySpeed",{get:function(){return this._colorBySpeedModule},set:function(t){return this._colorBySpeedModule=t,t}}),Object.defineProperty(u.prototype,"sizeOverLifetime",{get:function(){return this._sizeOverLifetimeModule},set:function(t){return this._sizeOverLifetimeModule=t,t}}),Object.defineProperty(u.prototype,"sizeBySpeed",{get:function(){return this._sizeBySpeedModule},set:function(t){return this._sizeBySpeedModule=t,t}}),Object.defineProperty(u.prototype,"rotationOverLifetime",{get:function(){return this._rotationOverLifetimeModule},set:function(t){return this._rotationOverLifetimeModule=t,t}}),Object.defineProperty(u.prototype,"rotationBySpeed",{get:function(){return this._rotationBySpeedModule},set:function(t){return this._rotationBySpeedModule=t,t}}),Object.defineProperty(u.prototype,"textureSheetAnimation",{get:function(){return this._textureSheetAnimationModule},set:function(t){return this._textureSheetAnimationModule=t,t}}),Object.defineProperty(u.prototype,"time",{get:function(){return this._playTime}}),Object.defineProperty(u.prototype,"currentVelocity",{get:function(){return this._currentVelocity}}),Object.defineProperty(u.prototype,"isPaused",{get:function(){return this._paused}}),Object.defineProperty(u.prototype,"isPlaying",{get:function(){return this.isActive&&!this._paused}}),Object.defineProperty(u.prototype,"isStopped",{get:function(){return!this._shouldEmit}}),Object.defineProperty(u.prototype,"isEmitting",{get:function(){return this._shouldEmit}}),u.prototype.isAlive=function(t){const e={res:this.isActive};return this.doOnChildren(t,(function(t,e){e.res=e.res&&t.isAlive}),e),e.res},u.prototype.clear=function(){this._cache.clear()},u.prototype.stop=function(t,e){switch(t=void 0===t||t,e=void 0===e?UnityEngine.ParticleSystemStopBehavior.StopEmitting:e){case UnityEngine.ParticleSystemStopBehavior.StopEmittingAndClear:this._shouldEmit=!1,this.clear();break;case UnityEngine.ParticleSystemStopBehavior.StopEmitting:default:this._shouldEmit=!1}this.doOnChildren(t,(function(t){t.stop(!1)}))},u.prototype.pause=function(t){this._paused=!0},u.prototype.play=function(t){if(this._paused)return void(this._paused=!1);this._shouldEmit=!0,this._paused=!1,this._lifetime=0,this.delayTimer=0,this._playTime=0,this.emission.lastSpawnTime_rate=0,this.emission.reinitBurstData(),t=void 0===t||t;this.doOnChildren(t,(function(t){t.play(!1)})),this._mainModule.prewarm&&this.prewarm()},u.prototype.prewarm=function(){const t=this._mainModule.startLifetime.evaluate(this.lifePart);this.runSimulation(t,!0)},u.prototype.simulate=function(t,e,i,n){i&&this.stop(e,UnityEngine.ParticleSystemStopBehavior.StopEmittingAndClear),this._paused=!1,this.isActive||this.play(!1),this.runSimulation(t,n),this.pause();const s={time:t,withChildren:e,restart:i,fixedTimeStep:n};this.doOnChildren(e,(function(t,e){t.simulate(e.time,e.withChildren,e.restart,e.fixedTimeStep)}),s)},u.prototype.runSimulation=function(t,e){const i=e?UnityEngine.Time.fixedDeltaTime:.0333,n=this._entity.getWorldTransform();let s=0,r=0;for(;s<t;)r=Math.min(t-s,i),this.update(r,n),s+=r},u.prototype.updateCurrentVelocity=function(t){const e=this._entity._unityComponents.rigidbody[0];this.main.emitterVelocityMode===UnityEngine.ParticleSystemEmitterVelocityMode.Rigidbody&&e?this._currentVelocity.copy(e.velocity):(r.copy(this._entity.getPosition()),this._currentVelocity.copy(r).sub(this._previousPosition).scale(1/t),this._previousPosition.copy(r))},u.prototype.createParticle=function(i,n){t.translation.copy(pc.Vec3.ZERO),t.rotation.copy(pc.Quat.IDENTITY),t.scale.x=t.scale.y=t.scale.z=1,t.direction.copy(pc.Vec3.BACK);const s=this._cache.acquire();++this._emittedCount;const r=this.lifePart;null!=this.shape&&this.shape.enabled&&this.shape.applyNextTransform(t.translation,t.rotation,t.direction),this._mainModule.simulationSpace===UnityEngine.ParticleSystemSimulationSpace.World&&(i.transformPoint(t.translation,t.translation),i.transformVector(t.direction,t.direction),t.direction.normalize());const o=this._entity._unityComponents.particleSystemRenderer[0]._particleSystemRenderer._renderMode;o!==UnityEngine.ParticleSystemRenderMode.Stretch&&(this.main.startRotation3D?e.setFromEulerAngles(this.main.startRotationX.evaluate(r)*pc.math.RAD_TO_DEG,this.main.startRotationY.evaluate(r)*pc.math.RAD_TO_DEG,this.main.startRotationZ.evaluate(r)*pc.math.RAD_TO_DEG):(o===UnityEngine.ParticleSystemRenderMode.Billboard?t.startRotationAxis.copy(t.rotation.transformVector(pc.Vec3.FORWARD)).normalize():(t.startRotationAxis.x=this._random.nextFloat()-.5,t.startRotationAxis.y=this._random.nextFloat()-.5,t.startRotationAxis.z=this._random.nextFloat()-.5,t.startRotationAxis.normalize()),e.setFromAxisAngle(t.startRotationAxis,this.main.startRotation.evaluate(r)*pc.math.RAD_TO_DEG))),t.rotation.mul(e),this.main.startSize3D?(t.scale.x=this.main.startSizeX.evaluate(r),t.scale.y=this.main.startSizeY.evaluate(r),t.scale.z=this.main.startSizeZ.evaluate(r)):t.scale.copy(pc.Vec3.ONE).scale(this.main.startSize.evaluate(r));const a=Math.abs(this.main.startSpeed.evaluate(r));return t.speed.copy(t.direction).scale(a),this.main.startColor.evaluateInplace(r,t.color),t.lifetime=this.main.startLifetime.evaluate(r),t.birthTimeOffset=n,s.initialize(t),s},u.prototype._updateParticles=function(t,e){this.main.simulationSpace===UnityEngine.ParticleSystemSimulationSpace.Local&&(s.copy(e).invert(),s.transformVector(n,n)),this._updateScaleFactor();for(let e=0;e<this._cache.aliveCount;++e){const i=this._cache.get(e);this._processParticle(i,t,this._scaleFactor,this._cache,s)}},u.prototype._processParticle=function(t,e,s,r,u){t.tmpScale.copy(t.initialScale),t.color.copy(t.startColor),(this.rotationOverLifetime.enabled||this.rotationBySpeed.enabled)&&t.angularVelocity.set(0,0,0),0!==t.birthTimeOffset&&(e=t.birthTimeOffset,t.birthTimeOffset=0);const c=this.main.gravityModifier.evaluate(this.lifePart);n.copy(UnityEngine.Physics.gravity),n.scale(c).scale(e),u.transformVector(n,n),t.ownSpeed.add(n),t.totalSpeed.copy(t.ownSpeed),this.inheritVelocity.enabled&&this.inheritVelocity.processInplace(t,e),this.forceOverLifetime.enabled&&this.forceOverLifetime.processInplace(t,e),this.velocityOverLifetime.enabled&&this.velocityOverLifetime.processInplace(t,e),this.colorOverLifetime.enabled&&this.colorOverLifetime.processInplace(t,e),this.colorBySpeed.enabled&&this.colorBySpeed.processInplace(t,e),this.rotationOverLifetime.enabled&&this.rotationOverLifetime.processInplace(t,e),this.rotationBySpeed.enabled&&this.rotationBySpeed.processInplace(t,e),this.sizeOverLifetime.enabled&&this.sizeOverLifetime.processInplace(t,e),this.sizeBySpeed.enabled&&this.sizeBySpeed.processInplace(t,e),this.textureSheetAnimation.enabled&&this.textureSheetAnimation.processInplace(t,e),this.noise.enabled&&this.noise.processInplace(t,e),this.limitVelocityOverLifetime.enabled&&this.limitVelocityOverLifetime.processInplace(t,e),o.copy(t.angularVelocity),o.scale(e),a.setFromEulerAngles(o.x,o.y,o.z),t.totalSpeed.mul2(t.totalSpeed,s),t.t.add(i.copy(t.totalSpeed).scale(e)),t.r.mul(a),t.s.copy(t.tmpScale),t.elapsedTime+=e},u.prototype._updateScaleFactor=function(){this._scaleFactor.copy(pc.Vec3.ONE),this.main.scalingMode===UnityEngine.ParticleSystemScalingMode.Hierarchy?this._scaleFactor.copy(this._entity.getLossyScale()):this.main.scalingMode===UnityEngine.ParticleSystemScalingMode.Local&&this._scaleFactor.copy(this._entity.getLocalScale())},u.prototype.emit=function(t){const e=pc.math.clamp(t,0,this._mainModule.maxParticles-this._cache.aliveCount);if(e>0){const t=this._entity.getWorldTransform();for(let i=0;i<e;++i)this.createParticle(t,0)}},u.prototype.update=function(t,e){if(!this.isActive||this._paused)return;let i=t;i*=this.main.simulationSpeed,this.main.useUnscaledTime||(i*=UnityEngine.Time.timeScale),this.delayTimer<this.main.startDelay.evaluate(0)?this.delayTimer+=i:(this._lifetime+=i,this._playTime+=i,this._lifetime>this.main.duration&&this.main.loop&&(this._lifetime-=this.main.duration,this.fire("ParticleSystemNewLoop")),this.lifetime>this.main.duration&&!this.main.loop&&(this._shouldEmit=!1),this.updateCurrentVelocity(t),this.cleanupOldParticles(),this._shouldEmit&&null!=this.emission&&this.emission.enabled&&this.emission.update(i,e),this._updateParticles(i,e))},u.prototype.cleanupOldParticles=function(){for(let t=this._cache.aliveCount-1;t>=0;--t){const e=this._cache.get(t);e.elapsedTime>e.lifetime&&this._cache.release(e)}},u.prototype.doOnChildren=function(t,e,i){if(t&&this._entity){const t=this._entity.allChildren();for(let n=0;n<t.length;n++){const s=t[n]._unityComponents.particlesystem[0];s&&e(s._particleSystem,i)}}},u.prototype.getParticles=function(t){if(!t)return null;const e=Math.min(this._cache.aliveCount,t.length);for(let i=0;i<e;i++)t[i].Handle.copy(this._cache.get(i));return e},u.prototype.setParticles=function(t,e){if(!t)return;const i=Math.min(this.main.maxParticles,e,t.length);for(let e=0;e<i;e++){this._cache.get(e).copy(t[e].Handle)}this.main.simulationSpace===UnityEngine.ParticleSystemSimulationSpace.Local&&this._entity.transformVectorInverse(n,n);for(let t=0;t<this._cache.aliveCount;++t){const e=this._cache.get(t);this._processParticle(e,0,this._scaleFactor,this._cache,s)}},pc.ParticleSystem=u}(),function(){let t=null,e=null;const i=new pc.Vec3;let n=new pc.Vec3;const s=new pc.Vec3,r=new pc.Vec3,o=new Float32Array([-.5,-.5,0,1,1,1,1,0,0,-.5,.5,0,1,1,1,1,0,1,.5,.5,0,1,1,1,1,1,1,.5,-.5,0,1,1,1,1,1,0]),a=new Float32Array([-.5,-1,0,1,1,1,1,0,0,-.5,0,0,1,1,1,1,0,1,.5,0,0,1,1,1,1,1,1,.5,-1,0,1,1,1,1,1,0]),u=new Uint16Array([0,1,2,2,3,0]),c=[{semantic:pc.SEMANTIC_POSITION,components:3,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_COLOR,components:4,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_TEXCOORD0,components:2,type:pc.ELEMENTTYPE_FLOAT32}],h=[{semantic:pc.SEMANTIC_TEXCOORD5,components:3,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_TEXCOORD6,components:4,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_TEXCOORD7,components:3,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_ATTR0,components:4,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_ATTR1,components:4,type:pc.ELEMENTTYPE_FLOAT32}];function l(){this.model=new pc.Model,this.configuration=new pc.Vec4,this._modelVersion=0,this._lastModelVersion=1,this.worldRotationTransform=new pc.Mat4,this.worldTranslationTransform=new pc.Mat4}Object.defineProperty(l.prototype,"sharedMaterials",{get:function(){return this._materials},set:function(t){this._materials=t,this._lastModelVersion++}}),Object.defineProperty(l.prototype,"mesh",{get:function(){return this._mesh},set:function(t){this._mesh=t,this._lastModelVersion++}}),Object.defineProperty(l.prototype,"alignment",{get:function(){return this._alignment},set:function(t){this._alignment=t}}),Object.defineProperty(l.prototype,"renderMode",{get:function(){return this._renderMode},set:function(t){this._renderMode=t,this._lastModelVersion++}}),Object.defineProperty(l.prototype,"lengthScale",{get:function(){return this._lengthScale},set:function(t){this._lengthScale=t}}),Object.defineProperty(l.prototype,"velocityScale",{get:function(){return this._velocityScale},set:function(t){this._velocityScale=t}}),Object.defineProperty(l.prototype,"cameraVelocityScale",{get:function(){return this._cameraVelocityScale},set:function(t){this._cameraVelocityScale=t}}),Object.defineProperty(l.prototype,"normalDirection",{get:function(){return this._normalDirection},set:function(t){this._normalDirection=t}}),Object.defineProperty(l.prototype,"sortingOrder",{get:function(){return this.model.sortingOrder},set:function(t){this.model.sortingOrder=t}}),Object.defineProperty(l.prototype,"sortingLayerIndex",{get:function(){return this.model.sortingLayerIndex},set:function(t){this.model.sortingLayerIndex=t}}),Object.defineProperty(l.prototype,"sortingLayerName",{get:function(){return UnityEngine.SortingLayer.GetLayerNameFromValue(this.model.sortingLayerIndex)},set:function(t){this.model.sortingLayerIndex=UnityEngine.SortingLayer.GetLayerValueFromName(t)}}),Object.defineProperty(l.prototype,"sortingFudge",{get:function(){return this._sortingFudge},set:function(t){this._sortingFudge=t}}),Object.defineProperty(l.prototype,"minParticleSize",{get:function(){return this._minParticleSize},set:function(t){this._minParticleSize=t}}),Object.defineProperty(l.prototype,"maxParticleSize",{get:function(){return this._maxParticleSize},set:function(t){this._maxParticleSize=t}}),Object.defineProperty(l.prototype,"pivot",{get:function(){return this._pivot},set:function(t){this._pivot=t}}),Object.defineProperty(l.prototype,"trailMaterial",{get:function(){return this._trailMaterial},set:function(t){this._trailMaterial=t}}),Object.defineProperty(l.prototype,"sortMode",{get:function(){return this._sortMode},set:function(t){this._sortMode=t}}),Object.defineProperty(l.prototype,"activeVertexStreamsCount",{get:function(){return this._activeVertexStreamsCount},set:function(t){this._activeVertexStreamsCount=t}}),Object.assign(l.prototype,{_configureModel:function(){switch(this._modelVersion=this._lastModelVersion,this.renderMode){case UnityEngine.ParticleSystemRenderMode.Billboard:case UnityEngine.ParticleSystemRenderMode.Stretch:case UnityEngine.ParticleSystemRenderMode.HorizontalBillboard:case UnityEngine.ParticleSystemRenderMode.VerticalBillboard:this.model.mesh=this._prepareBillboardMesh();break;case UnityEngine.ParticleSystemRenderMode.Mesh:this.model.mesh=this._mesh?this._mesh.handle:null;break;case UnityEngine.ParticleSystemRenderMode.None:this.model.mesh=null}if(this._materials&&this._materials.length>0){const t=[];for(let e=0;e<this._materials.length;e++)1!==e&&t.push(this._materials[e].handle);this.model.materials=t}else this.model.materials=[];this.model.update();const t=this.model.meshInstances;for(let e=0;e<t.length;e++){const i=t[e];i.instancingData=this._prepareInstancingData(),i.constAttributes.COLOR=[1,1,1,1],i._shaderDefs|=pc.SHADERDEF_PARTICLES_INSTANCING}},_prepareInstancingData:function(){if(!this._instancingData){const t=pc.Application.getApplication();this._instancingVertexFormat=new pc.VertexFormat(t.graphicsDevice,h),this._instancingData={_buffer:new pc.VertexBuffer(t.graphicsDevice,this._instancingVertexFormat,0,pc.BUFFER_DYNAMIC,new Float32Array(0)),count:0,offset:0}}return this._instancingData},_prepareQuad:function(t){const e=pc.Application.getApplication(),i=new pc.Mesh,n=new pc.VertexFormat(e.graphicsDevice,c),s=t;return i.vertexBuffer=new pc.VertexBuffer(e.graphicsDevice,n,4,pc.BUFFER_STATIC,s),i.indexBuffer[0]=new pc.IndexBuffer(e.graphicsDevice,pc.INDEXFORMAT_UINT16,6,pc.BUFFER_STATIC,u),i.primitive[0].type=pc.PRIMITIVE_TRIANGLES,i.primitive[0].base=0,i.primitive[0].count=6,i.primitive[0].indexed=!0,i.subMeshes=[i],i},_prepareBillboardMesh:function(){return null===t&&(t=this._prepareQuad(o)),null===e&&(e=this._prepareQuad(a)),this.renderMode===UnityEngine.ParticleSystemRenderMode.Stretch?e:t},_resizeInstancingBuffer:function(t){this._instancingData&&(t>this._instancingData._buffer.numVertices&&this._instancingData._buffer.resize(t),this._instancingData.count=t)},_updateInstancingData:function(t,e){const i=this.model.meshInstances;if(0===i.length)return;const n=this._instancingData._buffer,o=new Float32Array(n.lock());s.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),r.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let i=0;i<e.aliveCount;i++){const n=this._instancingVertexFormat.size/4*i,a=e.get(i),u=a.t;s.x=Math.min(s.x,u.x),s.y=Math.min(s.y,u.y),s.z=Math.min(s.z,u.z),r.x=Math.max(r.x,u.x),r.y=Math.max(r.y,u.y),r.z=Math.max(r.z,u.z),o[n+0]=a.t.x,o[n+1]=a.t.y,o[n+2]=a.t.z,o[n+3]=a.r.x,o[n+4]=a.r.y,o[n+5]=a.r.z,o[n+6]=a.r.w,this.renderMode===UnityEngine.ParticleSystemRenderMode.Stretch?(o[n+7]=a.s.x,o[n+8]=a.totalSpeed.length()*this.velocityScale+this.lengthScale*a.s.y,o[n+9]=a.s.z):(o[n+7]=a.s.x,o[n+8]=a.s.y,o[n+9]=a.s.z),o[n+10]=a.color.r,o[n+11]=a.color.g,o[n+12]=a.color.b,o[n+13]=a.color.a,null!=t.textureSheetAnimation&&t.textureSheetAnimation.enabled?(o[n+14]=1/t.textureSheetAnimation.numTilesX,o[n+15]=1/t.textureSheetAnimation.numTilesY,o[n+16]=a.texSheetColumn,o[n+17]=t.textureSheetAnimation.numTilesY-a.texSheetRow-1):(o[n+14]=1,o[n+15]=1,o[n+16]=0,o[n+17]=0)}for(let e=0;e<i.length;e++){const n=i[e];let o=null;switch(t.main.scalingMode){case UnityEngine.ParticleSystemScalingMode.Hierarchy:o=n.node.getLossyScale();break;case UnityEngine.ParticleSystemScalingMode.Local:o=n.node.getLocalScale();break;case UnityEngine.ParticleSystemScalingMode.Shape:o=pc.Vec3.ONE}this.worldRotationTransform.setTRS(pc.Vec3.ZERO,n.node.getRotation(),pc.Vec3.ONE),this.worldTranslationTransform.setTRS(n.node.getPosition(),pc.Quat.IDENTITY,pc.Vec3.ONE),n.setParameter("matrix_modelRotation",this.worldRotationTransform.data),n.setParameter("matrix_modelTranslation",this.worldTranslationTransform.data),n.setParameter("system_scale",[o.x,o.y,o.z]),n.setParameter("localToWorldMatrix",pc.Mat4.IDENTITY.data),this.renderMode===UnityEngine.ParticleSystemRenderMode.Stretch?n.setParameter("renderer_alignment",UnityEngine.ParticleSystemRenderSpace.View):t._shapeModule.alignToDirection?n.setParameter("renderer_alignment",UnityEngine.ParticleSystemRenderSpace.Local):n.setParameter("renderer_alignment",this.alignment),n.setParameter("worldSimulationSpace",t.main.simulationSpace===UnityEngine.ParticleSystemSimulationSpace.World?1:0),n.parameters._TintColor||!n.material||n.material.parameters._TintColor||n.setParameter("_TintColor",[1,1,1,1]),n.worldAabbOverride||(n.worldAabbOverride=new pc.BoundingBox);const a=n.worldAabbOverride;a.setMinMax(s,r),t.main.simulationSpace!==UnityEngine.ParticleSystemSimulationSpace.World&&(this.worldTranslationTransform.setTRS(n.node.getPosition(),n.node.getRotation(),pc.Vec3.ONE),a.setFromTransformedAabb(a,this.worldTranslationTransform))}n.unlock()},_sortParticles:function(t,e){const i=this.sortMode;switch(n=this.model.entity.getPosition(),i){case UnityEngine.ParticleSystemSortMode.Distance:t.sort(this.sortByDistance);break;case UnityEngine.ParticleSystemSortMode.OldestInFront:t.sort(this.sortOldestInFront);break;case UnityEngine.ParticleSystemSortMode.YoungestInFront:t.sort(this.sortYoungestInFront);break;case UnityEngine.ParticleSystemSortMode.None:}for(let i=0;i<e;i++)t[i]._cacheIndex=i},sortByDistance:function(t,e){if(!t.isAlive)return 1;if(!e.isAlive)return-1;const s=pc.Application.getApplication().getMainCamera().node.position;i.copy(t.t).sub(s).add(n);const r=i.lengthSq();return i.copy(e.t).sub(s).add(n),r-i.lengthSq()},sortOldestInFront:function(t,e){return t.isAlive?e.isAlive?t.elapsedTime-e.elapsedTime:-1:1},sortYoungestInFront:function(t,e){return t.isAlive?e.isAlive?e.elapsedTime-t.elapsedTime:-1:1},update:function(t,e){return this._modelVersion!==this._lastModelVersion&&(this._configureModel(),!0)},render:function(t,e){const i=t._cache;i.aliveCount>0&&this._sortParticles(i._particles,i.aliveCount),this._resizeInstancingBuffer(i.aliveCount),this._updateInstancingData(t,i)}}),pc.ParticleSystemRenderer=l}(),function(){function t(t){this.m_ParticleSystem=t,this.duration=5,this.loop=!0,this.prewarm=!0,this.startDelay=new pc.MinMaxCurve,this.startDelay._random=t._random,this.startDelayMultiplier=1,this.startLifetime=new pc.MinMaxCurve(5),this.startLifetime._random=t._random,this.startLifetimeMultiplier=1,this.startSpeed=new pc.MinMaxCurve(5),this.startSpeed._random=t._random,this.startSpeedMultiplier=1,this.startSize=new pc.MinMaxCurve,this.startSize._random=t._random,this.startSizeMultiplier=1,this.startSizeX=new pc.MinMaxCurve,this.startSizeX._random=t._random,this.startSizeXMultiplier=1,this.startSizeY=new pc.MinMaxCurve,this.startSizeY._random=t._random,this.startSizeYMultiplier=1,this.startSizeZ=new pc.MinMaxCurve,this.startSizeZ._random=t._random,this.startSizeYMultiplier=1,this.startRotation=new pc.MinMaxCurve,this.startRotation._random=t._random,this.startRotationMultiplier=1,this.startRotationX=new pc.MinMaxCurve,this.startRotationX._random=t._random,this.startRotationXMultiplier=1,this.startRotationY=new pc.MinMaxCurve,this.startRotationY._random=t._random,this.startRotationYMultiplier=1,this.startRotationZ=new pc.MinMaxCurve,this.startRotationZ._random=t._random,this.startRotationZMultiplier=1,this.flipRotation=!1,this.startColor=new pc.MinMaxGradient,this.startColor._random=t._random,this.gravityModifier=new pc.MinMaxCurve,this.gravityModifier._random=t._random,this.gravityModifierMultiplier=1,this.simulationSpace=UnityEngine.ParticleSystemSimulationSpace.Local,this.customSimulationSpace=null,this.simulationSpeed=1,this.useUnscaledTime=!0,this.scalingMode=UnityEngine.ParticleSystemScalingMode.Local,this.playOnAwake=!0,this.maxParticles=10,this.emitterVelocityMode=UnityEngine.ParticleSystemEmitterVelocityMode.Transform}Object.defineProperty(t.prototype,"duration",{get:function(){return this._duration},set:function(t){this._duration=t}}),Object.defineProperty(t.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t}}),Object.defineProperty(t.prototype,"prewarm",{get:function(){return this._prewarm},set:function(t){this._prewarm=t}}),Object.defineProperty(t.prototype,"startDelay",{get:function(){return this._startDelay},set:function(t){this._startDelay=t}}),Object.defineProperty(t.prototype,"startDelayMultiplier",{get:function(){return this._startDelayMultiplier},set:function(t){this._startDelayMultiplier=t}}),Object.defineProperty(t.prototype,"startLifetime",{get:function(){return this._startLifetime},set:function(t){this._startLifetime=t}}),Object.defineProperty(t.prototype,"startLifetimeMultiplier",{get:function(){return this._startLifetimeMultiplier},set:function(t){this._startLifetimeMultiplier=t}}),Object.defineProperty(t.prototype,"startSpeed",{get:function(){return this._startSpeed},set:function(t){this._startSpeed=t}}),Object.defineProperty(t.prototype,"startSpeedMultiplier",{get:function(){return this._startSpeedMultiplier},set:function(t){this._startSpeedMultiplier=t}}),Object.defineProperty(t.prototype,"startSize3D",{get:function(){return this._startSize3D},set:function(t){this._startSize3D=t}}),Object.defineProperty(t.prototype,"startSize",{get:function(){return this._startSize},set:function(t){this._startSize=t}}),Object.defineProperty(t.prototype,"startSizeX",{get:function(){return this._startSizeX},set:function(t){this._startSizeX=t}}),Object.defineProperty(t.prototype,"startSizeY",{get:function(){return this._startSizeY},set:function(t){this._startSizeY=t}}),Object.defineProperty(t.prototype,"startSizeZ",{get:function(){return this._startSizeZ},set:function(t){this._startSizeZ=t}}),Object.defineProperty(t.prototype,"startSizeMultiplier",{get:function(){return this._startSizeMultiplier},set:function(t){this._startSizeMultiplier=t}}),Object.defineProperty(t.prototype,"startSizeXMultiplier",{get:function(){return this._startSizeXMultiplier},set:function(t){this._startSizeXMultiplier=t}}),Object.defineProperty(t.prototype,"startSizeYMultiplier",{get:function(){return this._startSizeYMultiplier},set:function(t){this._startSizeYMultiplier=t}}),Object.defineProperty(t.prototype,"startSizeZMultiplier",{get:function(){return this._startSizeZMultiplier},set:function(t){this._startSizeZMultiplier=t}}),Object.defineProperty(t.prototype,"startRotation3D",{get:function(){return this._startRotation3D},set:function(t){this._startRotation3D=t}}),Object.defineProperty(t.prototype,"startRotation",{get:function(){return this._startRotation},set:function(t){this._startRotation=t}}),Object.defineProperty(t.prototype,"startRotationX",{get:function(){return this._startRotationX},set:function(t){this._startRotationX=t}}),Object.defineProperty(t.prototype,"startRotationY",{get:function(){return this._startRotationY},set:function(t){this._startRotationY=t}}),Object.defineProperty(t.prototype,"startRotationZ",{get:function(){return this._startRotationZ},set:function(t){this._startRotationZ=t}}),Object.defineProperty(t.prototype,"startRotationMultiplier",{get:function(){return this._startRotationMultiplier},set:function(t){this._startRotationMultiplier=t}}),Object.defineProperty(t.prototype,"startRotationXMultiplier",{get:function(){return this._startRotationXMultiplier},set:function(t){this._startRotationXMultiplier=t}}),Object.defineProperty(t.prototype,"startRotationYMultiplier",{get:function(){return this._startRotationYMultiplier},set:function(t){this._startRotationYMultiplier=t}}),Object.defineProperty(t.prototype,"startRotationZMultiplier",{get:function(){return this._startRotationZMultiplier},set:function(t){this._startRotationZMultiplier=t}}),Object.defineProperty(t.prototype,"flipRotation",{get:function(){return this._flipRotation},set:function(t){this._flipRotation=t}}),Object.defineProperty(t.prototype,"startColor",{get:function(){return this._startColor},set:function(t){this._startColor=t}}),Object.defineProperty(t.prototype,"gravityModifier",{get:function(){return this._gravityModifier},set:function(t){this._gravityModifier=t}}),Object.defineProperty(t.prototype,"gravityModifierMultiplier",{get:function(){return this._gravityModifierMultiplier},set:function(t){this._gravityModifierMultiplier=t}}),Object.defineProperty(t.prototype,"simulationSpace",{get:function(){return this._simulationSpace},set:function(t){this._simulationSpace=t}}),Object.defineProperty(t.prototype,"customSimulationSpace",{get:function(){return this._customSimulationSpace},set:function(t){this._customSimulationSpace=t}}),Object.defineProperty(t.prototype,"simulationSpeed",{get:function(){return this._simulationSpeed},set:function(t){this._simulationSpeed=t}}),Object.defineProperty(t.prototype,"useUnscaledTime",{get:function(){return this._useUnscaledTime},set:function(t){this._useUnscaledTime=t}}),Object.defineProperty(t.prototype,"scalingMode",{get:function(){return this._scalingMode},set:function(t){this._scalingMode=t}}),Object.defineProperty(t.prototype,"playOnAwake",{get:function(){return this._playOnAwake},set:function(t){this._playOnAwake=t}}),Object.defineProperty(t.prototype,"maxParticles",{get:function(){return this._maxParticles},set:function(t){this._maxParticles=t,this.m_ParticleSystem._cache.maxParticles=this._maxParticles}}),Object.defineProperty(t.prototype,"emitterVelocityMode",{get:function(){return this._emitterVelocityMode},set:function(t){this._emitterVelocityMode=t}}),pc.ParticleSystemMain=t}(),function(){function t(){}function e(t){this.m_ParticleSystem=t,this._accumulator=new pc.IntAccumulator,this.enabled=!0,this.rateOverTime=new pc.MinMaxCurve(10),this.rateOverTime._random=t._random,this.rateOverTimeMultiplier=1,this.rateOverDistance=new pc.MinMaxCurve,this.rateOverDistance._random=t._random,this.rateOverTimeMultiplier=1,this.bursts=[],this.burstCount=0,this.burstsTimeline=[],this.lastSpawnTime_rate=0,this.m_ParticleSystem.on("ParticleSystemNewLoop",this.handleParticleSystemLoop)}Object.defineProperty(t.prototype,"time",{get:function(){return this._time},set:function(t){this._time=t}}),Object.defineProperty(t.prototype,"count",{get:function(){return this._count},set:function(t){this._count=t}}),Object.defineProperty(t.prototype,"maxCount",{get:function(){return this._count.constantMax},set:function(t){this._count.constantMax=t}}),Object.defineProperty(t.prototype,"minCount",{get:function(){return this._count.constantMin},set:function(t){this._count.constantMin=t}}),Object.defineProperty(t.prototype,"cycleCount",{get:function(){return this._cycleCount},set:function(t){this._cycleCount=t}}),Object.defineProperty(t.prototype,"repeatInterval",{get:function(){return this.m_RepeatInterval},set:function(t){this.m_RepeatInterval=t}}),Object.defineProperty(t.prototype,"shouldFire",{get:function(){return this.repeatCount>0}}),t.prototype.recalculateRepeatCount=function(){this.repeatCount=this.cycleCount>0?this.cycleCount:1/0},Object.defineProperty(e.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled=t}}),Object.defineProperty(e.prototype,"rateOverTime",{get:function(){return this._rateOverTime},set:function(t){this._rateOverTime=t}}),Object.defineProperty(e.prototype,"rateOverTimeMultiplier",{get:function(){return this._rateOverTimeMultiplier},set:function(t){this._rateOverTimeMultiplier=t}}),Object.defineProperty(e.prototype,"rateOverDistance",{get:function(){return this._rateOverDistance},set:function(t){this._rateOverDistance=t}}),Object.defineProperty(e.prototype,"rateOverDistanceMultiplier",{get:function(){return this._rateOverDistanceMultiplier},set:function(t){this._rateOverDistanceMultiplier=t}}),Object.defineProperty(e.prototype,"burstCount",{get:function(){return this._burstCount},set:function(t){this._burstCount=t}}),e.prototype.setBursts=function(t){this.bursts=t},e.prototype.getBursts=function(t){for(let e=0;e<this._burstCount;++e)t[e]=this.bursts[e];return this._burstCount},e.prototype.getBurst=function(t){return this.bursts[t]},e.prototype.handleParticleSystemLoop=function(){const t=this.emission;for(let e=0;e<t.bursts.length;++e)t.bursts[e].recalculateRepeatCount()},e.prototype.recalculateBurstData=function(){for(let t=0;t<this.bursts.length;++t){const e=this.bursts[t];null==e.timeToFire&&(e.recalculateRepeatCount(),e.timeToFire=e.time)}},e.prototype.reinitBurstData=function(){for(let t=0;t<this.bursts.length;++t){const e=this.bursts[t];e.recalculateRepeatCount(),e.timeToFire=e.time}},e.prototype.getParticlesFromBursts=function(t){let e=0;for(let i=0;i<this.bursts.length;++i){const n=this.bursts[i];n.timeToFire-=t,n.shouldFire&&n.timeToFire<0&&(e+=n.count.evaluate(this.m_ParticleSystem.lifePart),n.timeToFire=n.repeatInterval,n.repeatCount-=1)}return e},e.prototype.update=function(t,e){this.recalculateBurstData();const i=this.getParticlesFromBursts(t),n=this.m_ParticleSystem._entity.worldTransform.getTranslation();this.previousPosition||(this.previousPosition=n.clone());const s=n.clone().sub(this.previousPosition).length();this.previousPosition=n;const r=i+this.rateOverDistance.evaluate(t)*s;if(this._accumulator.update(r),this.m_ParticleSystem.main.maxParticles<=this.m_ParticleSystem.particleCount)return 0;const o=Math.min(this._accumulator.accumulated,this.m_ParticleSystem.main.maxParticles-this.m_ParticleSystem.particleCount);this._accumulator.take(o);for(let t=0;t<o;++t)this.m_ParticleSystem.createParticle(e,0);const a=1/this.rateOverTime.evaluate(this.m_ParticleSystem.lifePart);for(;this.lastSpawnTime_rate+a<this.m_ParticleSystem._playTime;){if(this.m_ParticleSystem.main.maxParticles<=this.m_ParticleSystem.particleCount)return 0;const t=this.m_ParticleSystem._playTime-this.lastSpawnTime_rate-a;this.m_ParticleSystem.createParticle(e,t),this.lastSpawnTime_rate+=a}return 0},pc.ParticleSystemBurst=t,pc.ParticleSystemEmitter=e}(),function(){function t(t){this.m_ParticleSystem=t,this._TRS=pc.Mat4.IDENTITY,this._TR=pc.Mat4.IDENTITY,this.enabled=!1,this.radiusSpeed=new pc.MinMaxCurve,this.radiusSpeed._random=t._random,this.radiusSpeedMultiplier=1,this.arcSpeed=new pc.MinMaxCurve,this.arcSpeed._random=t._random,this.arcSpeedMultiplier=1,this.circularSpawner=new pc.CircularSpawner(this)}Object.defineProperty(t.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled=t}}),Object.defineProperty(t.prototype,"shapeType",{get:function(){return this._shapeType},set:function(t){switch(this._shapeType=t,t){case UnityEngine.ParticleSystemShapeType.Cone:this.impl=new pc.ConeShape(this,!1);break;case UnityEngine.ParticleSystemShapeType.ConeVolume:this.impl=new pc.ConeShape(this,!0);break;case UnityEngine.ParticleSystemShapeType.Sphere:this.impl=new pc.SphereShape(this);break;case UnityEngine.ParticleSystemShapeType.Hemisphere:this.impl=new pc.SphereShape(this,!0);break;case UnityEngine.ParticleSystemShapeType.Circle:this.impl=new pc.SphereShape(this,!1,!0);break;case UnityEngine.ParticleSystemShapeType.Donut:this.impl=new pc.DonutShape(this);break;case UnityEngine.ParticleSystemShapeType.Box:case UnityEngine.ParticleSystemShapeType.BoxShell:case UnityEngine.ParticleSystemShapeType.BoxEdge:case UnityEngine.ParticleSystemShapeType.Rectangle:case UnityEngine.ParticleSystemShapeType.SingleSidedEdge:default:this.impl=new pc.BoxShape(this)}}}),Object.defineProperty(t.prototype,"randomDirectionAmount",{get:function(){return this._randomDirectionAmount},set:function(t){this._randomDirectionAmount=t}}),Object.defineProperty(t.prototype,"sphericalDirectionAmount",{get:function(){return this._sphericalDirectionAmount},set:function(t){this._sphericalDirectionAmount=t}}),Object.defineProperty(t.prototype,"randomPositionAmount",{get:function(){return this._randomPositionAmount},set:function(t){this._randomPositionAmount=t}}),Object.defineProperty(t.prototype,"alignToDirection",{get:function(){return this._alignToDirection},set:function(t){this._alignToDirection=t}}),Object.defineProperty(t.prototype,"radius",{get:function(){return this._radius},set:function(t){this._radius=t}}),Object.defineProperty(t.prototype,"radiusMode",{get:function(){return this._radiusMode},set:function(t){this._radiusMode=t}}),Object.defineProperty(t.prototype,"radiusSpread",{get:function(){return this._radiusSpread},set:function(t){this._radiusSpread=t}}),Object.defineProperty(t.prototype,"radiusSpeed",{get:function(){return this._radiusSpeed},set:function(t){this._radiusSpeed=t}}),Object.defineProperty(t.prototype,"radiusSpeedMultiplier",{get:function(){return this._radiusSpeedMultiplier},set:function(t){this._radiusSpeedMultiplier=t}}),Object.defineProperty(t.prototype,"radiusThickness",{get:function(){return this._radiusThickness},set:function(t){this._radiusThickness=t}}),Object.defineProperty(t.prototype,"angle",{get:function(){return this._angle},set:function(t){this._angle=t}}),Object.defineProperty(t.prototype,"length",{get:function(){return this._length},set:function(t){this._length=t}}),Object.defineProperty(t.prototype,"boxThickness",{get:function(){return this._boxThickness},set:function(t){this._boxThickness=t}}),Object.defineProperty(t.prototype,"arc",{get:function(){return this._arc},set:function(t){this._arc=t}}),Object.defineProperty(t.prototype,"arcMode",{get:function(){return this._arcMode},set:function(t){this._arcMode=t}}),Object.defineProperty(t.prototype,"arcSpread",{get:function(){return this._arcSpread},set:function(t){this._arcSpread=t}}),Object.defineProperty(t.prototype,"arcSpeed",{get:function(){return this._arcSpeed},set:function(t){this._arcSpeed=t}}),Object.defineProperty(t.prototype,"arcSpeedMultiplier",{get:function(){return this._arcSpeedMultiplier},set:function(t){this._arcSpeedMultiplier=t}}),Object.defineProperty(t.prototype,"donutRadius",{get:function(){return this._donutRadius},set:function(t){this._donutRadius=t}}),Object.defineProperty(t.prototype,"position",{get:function(){return this._position},set:function(t){this.trsDirty=!0,this.trDirty=!0,this._position=t}}),Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this.trsDirty=!0,this.trDirty=!0,this._rotation=t}}),Object.defineProperty(t.prototype,"scale",{get:function(){return this._scale},set:function(t){this.trsDirty=!0,this._scale=t}}),Object.defineProperty(t.prototype,"TRS",{get:function(){if(this.trsDirty){const t=new pc.Quat;t.setFromEulerAngles_Unity(this.rotation.x,this.rotation.y,this.rotation.z),this._TRS=(new pc.Mat4).setTRS(this.position,t,this.scale),this.trsDirty=!1}return this._TRS}}),Object.defineProperty(t.prototype,"TR",{get:function(){if(this.trDirty){const t=new pc.Quat;t.setFromEulerAngles_Unity(this.rotation.x,this.rotation.y,this.rotation.z),this._TR=(new pc.Mat4).setTRS(this.position,t,new pc.Vec3(1,1,1)),this.trDirty=!1}return this._TR}}),Object.defineProperty(t.prototype,"trsDirty",{get:function(){return this._trsDirty},set:function(t){this._trsDirty=t}}),Object.defineProperty(t.prototype,"trDirty",{get:function(){return this._trDirty},set:function(t){this._trDirty=t}}),Object.defineProperty(t.prototype,"impl",{get:function(){return this._impl},set:function(t){this._impl=t}});const e=new pc.Vec3,i=new pc.Vec3,n=new pc.Quat,s=new pc.Quat,r=new pc.Vec3,o=new pc.Vec3;t.prototype.applyNextTransform=function(t,a,u){this.impl.applyTransformations(e,i),this.randomizePosition(e),this._shapeType===UnityEngine.ParticleSystemShapeType.Cone?(this.impl.applyTransformations(r,o,0),this.randomizeDirection(i,o)):this.randomizeDirection(i),this.TRS.transformPoint(e,t),this.TRS.transformVector(i,u),u.normalize(),0===u.x&&0===u.y&&0===u.z&&(u.z=1);const c=Math.sign(this.m_ParticleSystem.main.startSpeed.evaluate(this.m_ParticleSystem.lifePart));this.spherizeDirection(t,u,this.position),u.scale(c),n.copy(this.rotationBetweenVectors(pc.Vec3.FORWARD,u)),s.copy(this.rotationBetweenVectors(pc.Vec3.UP,u)),this.m_ParticleSystem._entity._unityComponents.particleSystemRenderer[0]._particleSystemRenderer._renderMode===UnityEngine.ParticleSystemRenderMode.Stretch?a.copy(s):this.alignToDirection?(a.setFromMat4(this.TR),a.mul(n)):a.copy(pc.Quat.IDENTITY)};const a=new pc.Vec3;t.prototype.randomizePosition=function(t){const e=this.m_ParticleSystem._random;this.randomPositionAmount>0&&(a.x=e.nextFloat()-.5,a.y=e.nextFloat()-.5,a.z=e.nextFloat()-.5,a.scale(this.randomPositionAmount),t.add(a))};const u=new pc.Vec3;t.prototype.randomizeDirection=function(t,e){const i=this.m_ParticleSystem._random;this.randomDirectionAmount>0&&(e?u.copy(e):(u.x=i.nextFloat()-.5,u.y=i.nextFloat()-.5,u.z=i.nextFloat()-.5),u.normalize(),t.lerp(t,u,this.randomDirectionAmount)),t.normalize()};const c=new pc.Vec3;t.prototype.spherizeDirection=function(t,e,i){this.sphericalDirectionAmount>0&&(c.copy(t).sub(i).normalize(),e.lerp(e,c,this.sphericalDirectionAmount)),e.normalize()};const h=new pc.Quat,l=new pc.Vec3;t.prototype.rotationBetweenVectors=function(t,e){return l.cross(t,e),h.x=l.x,h.y=l.y,h.z=l.z,h.w=Math.sqrt(t.lengthSq()*e.lengthSq())+t.dot(e),h.normalize()},t.prototype.getPointInRadius=function(t){const e=this.m_ParticleSystem._random,i=1-this.radiusThickness;return(i+(1-i)*e.nextFloat())*t},pc.ParticleSystemShape=t}(),function(){const t=new pc.Vec3;let e=new pc.Vec3;const i=new pc.Vec3,n=new pc.Vec3;function s(t){this.m_ParticleSystem=t,this.enabled=!1,this.x=new pc.MinMaxCurve,this.x._random=t._random,this.y=new pc.MinMaxCurve,this.y._random=t._random,this.z=new pc.MinMaxCurve,this.z._random=t._random,this.xMultiplier=1,this.yMultiplier=1,this.zMultiplier=1,this.orbitalX=new pc.MinMaxCurve,this.orbitalX._random=t._random,this.orbitalY=new pc.MinMaxCurve,this.orbitalY._random=t._random,this.orbitalZ=new pc.MinMaxCurve,this.orbitalZ._random=t._random,this.orbitalXMultiplier=1,this.orbitalYMultiplier=1,this.orbitalZMultiplier=1,this.orbitalOffsetX=new pc.MinMaxCurve,this.orbitalOffsetX._random=t._random,this.orbitalOffsetY=new pc.MinMaxCurve,this.orbitalOffsetY._random=t._random,this.orbitalOffsetZ=new pc.MinMaxCurve,this.orbitalOffsetZ._random=t._random,this.orbitalOffsetXMultiplier=1,this.orbitalOffsetYMultiplier=1,this.orbitalOffsetZMultiplier=1,this.radial=new pc.MinMaxCurve,this.radial._random=t._random,this.radialMultiplier=1,this.speedModifier=new pc.MinMaxCurve,this.speedModifier._random=t._random,this.speedModifierMultiplier=1}Object.defineProperty(s.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled=t}}),Object.defineProperty(s.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t}}),Object.defineProperty(s.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t}}),Object.defineProperty(s.prototype,"z",{get:function(){return this._z},set:function(t){this._z=t}}),Object.defineProperty(s.prototype,"xMultiplier",{get:function(){return this._xMultiplier},set:function(t){this._xMultiplier=t}}),Object.defineProperty(s.prototype,"yMultiplier",{get:function(){return this._yMultiplier},set:function(t){this._yMultiplier=t}}),Object.defineProperty(s.prototype,"zMultiplier",{get:function(){return this._zMultiplier},set:function(t){this._zMultiplier=t}}),Object.defineProperty(s.prototype,"orbitalX",{get:function(){return this._orbitalX},set:function(t){this._orbitalX=t}}),Object.defineProperty(s.prototype,"orbitalY",{get:function(){return this._orbitalY},set:function(t){this._orbitalY=t}}),Object.defineProperty(s.prototype,"orbitalZ",{get:function(){return this._orbitalZ},set:function(t){this._orbitalZ=t}}),Object.defineProperty(s.prototype,"orbitalXMultiplier",{get:function(){return this._orbitalXMultiplier},set:function(t){this._orbitalXMultiplier=t}}),Object.defineProperty(s.prototype,"orbitalYMultiplier",{get:function(){return this._orbitalYMultiplier},set:function(t){this._orbitalYMultiplier=t}}),Object.defineProperty(s.prototype,"orbitalZMultiplier",{get:function(){return this._orbitalZMultiplier},set:function(t){this._orbitalZMultiplier=t}}),Object.defineProperty(s.prototype,"orbitalOffsetX",{get:function(){return this._orbitalOffsetX},set:function(t){this._orbitalOffsetX=t}}),Object.defineProperty(s.prototype,"orbitalOffsetY",{get:function(){return this._orbitalOffsetY},set:function(t){this._orbitalOffsetY=t}}),Object.defineProperty(s.prototype,"orbitalOffsetZ",{get:function(){return this._orbitalOffsetZ},set:function(t){this._orbitalOffsetZ=t}}),Object.defineProperty(s.prototype,"orbitalOffsetXMultiplier",{get:function(){return this._orbitalOffsetXMultiplier},set:function(t){this._orbitalOffsetXMultiplier=t}}),Object.defineProperty(s.prototype,"orbitalOffsetYMultiplier",{get:function(){return this._orbitalOffsetYMultiplier},set:function(t){this._orbitalOffsetYMultiplier=t}}),Object.defineProperty(s.prototype,"orbitalOffsetZMultiplier",{get:function(){return this._orbitalOffsetZMultiplier},set:function(t){this._orbitalOffsetZMultiplier=t}}),Object.defineProperty(s.prototype,"radial",{get:function(){return this._radial},set:function(t){this._radial=t}}),Object.defineProperty(s.prototype,"radialMultiplier",{get:function(){return this._radialMultiplier},set:function(t){this._radialMultiplier=t}}),Object.defineProperty(s.prototype,"speedModifier",{get:function(){return this._speedModifier},set:function(t){this._speedModifier=t}}),Object.defineProperty(s.prototype,"speedModifierMultiplier",{get:function(){return this._speedModifierMultiplier},set:function(t){this._speedModifierMultiplier=t}}),Object.defineProperty(s.prototype,"space",{get:function(){return this._space},set:function(t){this._space=t}}),s.prototype.processInplace=function(s,r){this.x.mode===pc.MinMaxCurveMode.Curve?e=this.getLinearValue(s,r):s.velocityOverLifetimeValue?e.copy(s.velocityOverLifetimeValue):(e=this.getLinearValue(s,r),s.velocityOverLifetimeValue=new pc.Vec3,s.velocityOverLifetimeValue.copy(e));const o=this.radial.evaluate(s.lifePart);o>0&&(t.x=t.y=t.z=0,null!=this.m_ParticleSystem.shape&&this.m_ParticleSystem.shape.enabled&&t.copy(this.m_ParticleSystem.shape.position),i.copy(s.t),i.sub(t).normalize().scale(o)),n.copy(e),n.add(i),this._space===UnityEngine.ParticleSystemSimulationSpace.World&&this.m_ParticleSystem.entity.worldTransformInverse.transformVector(n,n),s.totalSpeed.add(n).scale(this.speedModifierMultiplier)},s.prototype.getLinearValue=function(t,i){return e.x=this.x.evaluate(t.lifePart),e.y=this.y.evaluate(t.lifePart),e.z=this.z.evaluate(t.lifePart),e},pc.ParticleSystemVelocityOverLifetime=s}(),function(){let t=1;function e(t){this.m_ParticleSystem=t,this.enabled=!1,this.separateAxes=!1,this.strengthX=new pc.MinMaxCurve,this.strengthX._random=t._random,this.strengthY=new pc.MinMaxCurve,this.strengthY._random=t._random,this.strengthZ=new pc.MinMaxCurve,this.strengthZ._random=t._random,this.strengthXMultiplier=1,this.strengthYMultiplier=1,this.strengthZMultiplier=1,this.frequency=1,this.damping=!1,this.octaveCount=1,this.octaveMultiplier=1,this.octaveScale=1,this.quality=UnityEngine.ParticleSystemNoiseQuality.Low,this.scrollSpeed=new pc.MinMaxCurve,this.scrollSpeed._random=t._random,this.scrollSpeedMultiplier=1,this.remapEnabled=!1,this.remapX=new pc.MinMaxCurve,this.remapX._random=t._random,this.remapY=new pc.MinMaxCurve,this.remapY._random=t._random,this.remapZ=new pc.MinMaxCurve,this.remapZ._random=t._random,this.remapXMultiplier=1,this.remapYMultiplier=1,this.remapZMultiplier=1,this.positionAmount=new pc.MinMaxCurve,this.positionAmount._random=t._random,this.rotationAmount=new pc.MinMaxCurve,this.rotationAmount._random=t._random,this.sizeAmount=new pc.MinMaxCurve,this.sizeAmount._random=t._random,this.seed=null,this.scrollValue=0}Object.defineProperty(e.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled=t}}),Object.defineProperty(e.prototype,"separateAxes",{get:function(){return this._separateAxes},set:function(t){this._separateAxes=t}}),Object.defineProperty(e.prototype,"strength",{get:function(){return this._strengthX},set:function(t){this._strengthX=t}}),Object.defineProperty(e.prototype,"strengthX",{get:function(){return this._strengthX},set:function(t){this._strengthX=t}}),Object.defineProperty(e.prototype,"strengthY",{get:function(){return this._strengthY},set:function(t){this._strengthY=t}}),Object.defineProperty(e.prototype,"strengthZ",{get:function(){return this._strengthZ},set:function(t){this._strengthZ=t}}),Object.defineProperty(e.prototype,"strengthMultiplier",{get:function(){return this._strengthXMultiplier},set:function(t){this._strengthXMultiplier=t}}),Object.defineProperty(e.prototype,"strengthXMultiplier",{get:function(){return this._strengthXMultiplier},set:function(t){this._strengthXMultiplier=t}}),Object.defineProperty(e.prototype,"strengthYMultiplier",{get:function(){return this._strengthYMultiplier},set:function(t){this._strengthYMultiplier=t}}),Object.defineProperty(e.prototype,"strengthZMultiplier",{get:function(){return this._strengthZMultiplier},set:function(t){this._strengthZMultiplier=t}}),Object.defineProperty(e.prototype,"frequency",{get:function(){return this._frequency},set:function(t){this._frequency=t}}),Object.defineProperty(e.prototype,"damping",{get:function(){return this._damping},set:function(t){this._damping=t}}),Object.defineProperty(e.prototype,"octaveCount",{get:function(){return this._octaveCount},set:function(t){this._octaveCount=t}}),Object.defineProperty(e.prototype,"octaveMultiplier",{get:function(){return this._octaveMultiplier},set:function(t){this._octaveMultiplier=t}}),Object.defineProperty(e.prototype,"octaveScale",{get:function(){return this._octaveScale},set:function(t){this._octaveScale=t}}),Object.defineProperty(e.prototype,"quality",{get:function(){return this._quality},set:function(t){this._quality=t}}),Object.defineProperty(e.prototype,"scrollSpeed",{get:function(){return this._scrollSpeed},set:function(t){this._scrollSpeed=t}}),Object.defineProperty(e.prototype,"scrollSpeedMultiplier",{get:function(){return this._scrollSpeedMultiplier},set:function(t){this._scrollSpeedMultiplier=t}}),Object.defineProperty(e.prototype,"remapEnabled",{get:function(){return this._remapEnabled},set:function(t){this._remapEnabled=t}}),Object.defineProperty(e.prototype,"remap",{get:function(){return this._remapX},set:function(t){this._remapX=t}}),Object.defineProperty(e.prototype,"remapX",{get:function(){return this._remapX},set:function(t){this._remapX=t}}),Object.defineProperty(e.prototype,"remapY",{get:function(){return this._remapY},set:function(t){this._remapY=t}}),Object.defineProperty(e.prototype,"remapZ",{get:function(){return this._remapZ},set:function(t){this._remapZ=t}}),Object.defineProperty(e.prototype,"remapMultiplier",{get:function(){return this._remapXMultiplier},set:function(t){this._remapXMultiplier=t}}),Object.defineProperty(e.prototype,"remapXMultiplier",{get:function(){return this._remapXMultiplier},set:function(t){this._remapXMultiplier=t}}),Object.defineProperty(e.prototype,"remapYMultiplier",{get:function(){return this._remapYMultiplier},set:function(t){this._remapYMultiplier=t}}),Object.defineProperty(e.prototype,"remapZMultiplier",{get:function(){return this._remapZMultiplier},set:function(t){this._remapZMultiplier=t}}),Object.defineProperty(e.prototype,"positionAmount",{get:function(){return this._positionAmount},set:function(t){this._positionAmount=t}}),Object.defineProperty(e.prototype,"rotationAmount",{get:function(){return this._rotationAmount},set:function(t){this._rotationAmount=t}}),Object.defineProperty(e.prototype,"sizeAmount",{get:function(){return this._sizeAmount},set:function(t){this._sizeAmount=t}}),e.prototype.processInplace=function(e,i){const n=this.m_ParticleSystem._random;null===this.seed&&(this.seed=255*n.nextFloat()),this.scrollValue+=i*this.scrollSpeed.evaluate(this.m_ParticleSystem.lifePart);let s=this.seed+this.m_ParticleSystem._playTime;s=s*this.frequency+e._cacheIndex;const r=pc.noise.perlin2(s+0,this.scrollValue/255),o=pc.noise.perlin2(s+.33,this.scrollValue/255),a=pc.noise.perlin2(s+.66,this.scrollValue/255),u=new pc.Vec3(0,0,0);t=this.positionAmount.evaluate(e.lifePart);if(this.separateAxes)u.x=r*this.strengthXMultiplier*this.strengthX.evaluate(e.lifePart)*t*1,u.y=o*this.strengthYMultiplier*this.strengthY.evaluate(e.lifePart)*t*1,u.z=a*this.strengthZMultiplier*this.strengthZ.evaluate(e.lifePart)*t*1;else{const i=this.strength.evaluate(e.lifePart);u.x=r*i*t*1,u.y=o*i*t*1,u.z=a*i*t*1}this.damping&&u.scale(1/this.frequency),e.totalSpeed.add(u);const c=this.damping?r*this.sizeAmount.evaluate(e.lifePart)/this.frequency:r*this.sizeAmount.evaluate(e.lifePart);e.tmpScale.scale(1+.5*c)},pc.ParticleSystemNoise=e}(),function(){const t=new pc.Color;function e(t){this.m_ParticleSystem=t,this.enabled=!1,this.color=new pc.MinMaxGradient,this.color._random=t._random}Object.defineProperty(e.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled=t}}),Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(t){this._color=t}}),e.prototype.processInplace=function(e,i){this.color.mode===pc.MinMaxGradientMode.Gradient?this.color.evaluateInplace(e.lifePart,t,e.colorGradientState):e.colorOverLifetimeValue?t.copy(e.colorOverLifetimeValue):(this.color.evaluateInplace(e.lifePart,t,e.colorGradientState),e.colorOverLifetimeValue=new pc.Color,e.colorOverLifetimeValue.copy(t)),e.color.mul(t)},pc.ParticleSystemColorOverLifetime=e}(),function(){let t=0,e=0;const i=new pc.Color;function n(t){this.m_ParticleSystem=t,this.enabled=!1,this.color=new pc.MinMaxGradient,this.color._random=t._random}Object.defineProperty(n.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled=t}}),Object.defineProperty(n.prototype,"color",{get:function(){return this._color},set:function(t){this._color=t}}),Object.defineProperty(n.prototype,"range",{get:function(){return this._range},set:function(t){this._range=t}}),n.prototype.processInplace=function(n,s){if(this.color.mode===pc.MinMaxGradientMode.Gradient){if(this.range.x>this.range.y){const t=this.range.x;this.range.x=this.range.y,this.range.y=t}t=n.totalSpeed.length(),e=0,e=t>this.range.y?1:t<this.range.x?0:(t-this.range.x)/(this.range.y-this.range.x),this.color.evaluateInplace(e,i)}else n.colorBySpeedValue?i.copy(n.colorBySpeedValue):(this.color.evaluateInplace(e,i),n.colorBySpeedValue=new pc.Color,n.colorBySpeedValue.copy(i));n.color.mul(i)},pc.ParticleSystemColorBySpeed=n}(),function(){function t(t){this.m_ParticleSystem=t,this.enabled=!1,this.x=new pc.MinMaxCurve,this.x._random=t._random,this.y=new pc.MinMaxCurve,this.y._random=t._random,this.z=new pc.MinMaxCurve,this.z._random=t._random,this.size=new pc.MinMaxCurve,this.size._random=t._random,this.xMultiplier=1,this.yMultiplier=1,this.zMultiplier=1,this.sizeMultiplier=1,this.separateAxes=!1}Object.defineProperty(t.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled=t}}),Object.defineProperty(t.prototype,"size",{get:function(){return this._size},set:function(t){this._size=t}}),Object.defineProperty(t.prototype,"sizeMultiplier",{get:function(){return this._sizeMultiplier},set:function(t){this._sizeMultiplier=t}}),Object.defineProperty(t.prototype,"separateAxes",{get:function(){return this._separateAxes},set:function(t){this._separateAxes=t}}),Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t}}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t}}),Object.defineProperty(t.prototype,"z",{get:function(){return this._z},set:function(t){this._z=t}}),Object.defineProperty(t.prototype,"xMultiplier",{get:function(){return this._xMultiplier},set:function(t){this._xMultiplier=t}}),Object.defineProperty(t.prototype,"yMultiplier",{get:function(){return this._yMultiplier},set:function(t){this._yMultiplier=t}}),Object.defineProperty(t.prototype,"zMultiplier",{get:function(){return this._zMultiplier},set:function(t){this._zMultiplier=t}});let e=new pc.Vec3;t.prototype.processInplace=function(t,i){this.x.mode===pc.MinMaxCurveMode.Curve?e=this.getValue(t,i):t.sizeOverLifetimeValue?e.copy(t.sizeOverLifetimeValue):(e=this.getValue(t,i),t.sizeOverLifetimeValue=new pc.Vec3,t.sizeOverLifetimeValue.copy(e)),t.tmpScale.mul(e)},t.prototype.getValue=function(t,i){if(e.copy(pc.Vec3.ONE),this.separateAxes)e.x*=this.x.evaluate(t.lifePart),e.y*=this.y.evaluate(t.lifePart),e.z*=this.z.evaluate(t.lifePart);else{const i=this.size.evaluate(t.lifePart);e.scale(i)}return e},pc.ParticleSystemSizeOverLifetime=t}(),function(){function t(t){this.m_ParticleSystem=t,this.enabled=!1,this._x=new pc.MinMaxCurve,this._x._random=t._random,this._y=new pc.MinMaxCurve,this._y._random=t._random,this._z=new pc.MinMaxCurve,this._z._random=t._random,this._size=new pc.MinMaxCurve,this._size._random=t._random,this.xMultiplier=1,this.yMultiplier=1,this.zMultiplier=1,this.separateAxes=!1}Object.defineProperty(t.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled=t}}),Object.defineProperty(t.prototype,"size",{get:function(){return this._size},set:function(t){this._size=t}}),Object.defineProperty(t.prototype,"sizeMultiplier",{get:function(){return this._sizeMultiplier},set:function(t){this._sizeMultiplier=t}}),Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t}}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t}}),Object.defineProperty(t.prototype,"z",{get:function(){return this._z},set:function(t){this._z=t}}),Object.defineProperty(t.prototype,"xMultiplier",{get:function(){return this._xMultiplier},set:function(t){this._xMultiplier=t}}),Object.defineProperty(t.prototype,"yMultiplier",{get:function(){return this._yMultiplier},set:function(t){this._yMultiplier=t}}),Object.defineProperty(t.prototype,"zMultiplier",{get:function(){return this._zMultiplier},set:function(t){this._zMultiplier=t}}),Object.defineProperty(t.prototype,"range",{get:function(){return this._range},set:function(t){this._range=t}}),t.prototype.processInplace=function(t,e){if(this.range.x>this.range.y){const t=this.range.x;this.range.x=this.range.y,this.range.y=t}let i=0;const n=t.totalSpeed.length();if(i=n>this.range.y?1:n<this.range.x?0:(n-this.range.x)/(this.range.y-this.range.x),this.separateAxes)t.tmpScale.x*=this.x.evaluate(i),t.tmpScale.y*=this.y.evaluate(i),t.tmpScale.z*=this.z.evaluate(i);else{const e=this.size.evaluate(i);t.tmpScale.x*=e,t.tmpScale.y*=e,t.tmpScale.z*=e}},pc.ParticleSystemSizeBySpeed=t}(),function(){let t=new pc.Vec3;const e=new pc.Quat;function i(t){this.m_ParticleSystem=t,this.enabled=!1,this.x=new pc.MinMaxCurve,this.x._random=t._random,this.y=new pc.MinMaxCurve,this.y._random=t._random,this.z=new pc.MinMaxCurve,this.z._random=t._random,this.xMultiplier=1,this.yMultiplier=1,this.zMultiplier=1,this.separateAxes=!1}Object.defineProperty(i.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled=t}}),Object.defineProperty(i.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t}}),Object.defineProperty(i.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t}}),Object.defineProperty(i.prototype,"z",{get:function(){return this._z},set:function(t){this._z=t}}),Object.defineProperty(i.prototype,"xMultiplier",{get:function(){return this._xMultiplier},set:function(t){this._xMultiplier=t}}),Object.defineProperty(i.prototype,"yMultiplier",{get:function(){return this._yMultiplier},set:function(t){this._yMultiplier=t}}),Object.defineProperty(i.prototype,"zMultiplier",{get:function(){return this._zMultiplier},set:function(t){this._zMultiplier=t}}),i.prototype.processInplace=function(e,i){this.x.mode===pc.MinMaxCurveMode.Curve?t=this.getValue(e):e.rotationOverLifetimeValue?t.copy(e.rotationOverLifetimeValue):(t=this.getValue(e),e.rotationOverLifetimeValue=new pc.Vec3,e.rotationOverLifetimeValue.copy(t)),e.angularVelocity.add(t)},i.prototype.getValue=function(i){return this.separateAxes?t.set(this.x.evaluate(i.lifePart)*pc.math.RAD_TO_DEG,this.y.evaluate(i.lifePart)*pc.math.RAD_TO_DEG,this.z.evaluate(i.lifePart)*pc.math.RAD_TO_DEG):(e.setFromAxisAngle(i.startRotationAxis,this.z.evaluate(i.lifePart)*pc.math.RAD_TO_DEG),e.getEulerAngles(t)),t},pc.ParticleSystemRotationOverLifetime=i}(),function(){let t,e,i;const n=new pc.Quat,s=new pc.Vec3;function r(t){this.m_ParticleSystem=t,this.enabled=!1,this.x=new pc.MinMaxCurve,this.x._random=t._random,this.y=new pc.MinMaxCurve,this.y._random=t._random,this.z=new pc.MinMaxCurve,this.z._random=t._random,this.xMultiplier=1,this.yMultiplier=1,this.zMultiplier=1,this.separateAxes=!1}Object.defineProperty(r.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled=t}}),Object.defineProperty(r.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t}}),Object.defineProperty(r.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t}}),Object.defineProperty(r.prototype,"z",{get:function(){return this._z},set:function(t){this._z=t}}),Object.defineProperty(r.prototype,"xMultiplier",{get:function(){return this._xMultiplier},set:function(t){this._xMultiplier=t}}),Object.defineProperty(r.prototype,"yMultiplier",{get:function(){return this._yMultiplier},set:function(t){this._yMultiplier=t}}),Object.defineProperty(r.prototype,"zMultiplier",{get:function(){return this._zMultiplier},set:function(t){this._zMultiplier=t}}),Object.defineProperty(r.prototype,"separateAxes",{get:function(){return this._separateAxes},set:function(t){this._separateAxes=t}}),Object.defineProperty(r.prototype,"range",{get:function(){return this._range},set:function(t){this._range=t}}),r.prototype._getRotationAmount=function(t,e){if(e.mode===pc.MinMaxCurveMode.Constant||e.mode===pc.MinMaxCurveMode.TwoConstants)return e.evaluate(0);const i=t.ownSpeed.length();let n=0;return i>this.range.y?n=1:i<this.range.x?n=0:i>=this.range.x&&i<=this.range.y&&(n=(i-this.range.x)/(this.range.y-this.range.x)),e.evaluate(n)*pc.math.DEG_TO_RAD},r.prototype.processInplace=function(r,o){t=e=0,i=this._getRotationAmount(r,this.z),this._separateAxes?(t=this._getRotationAmount(r,this.x),e=this._getRotationAmount(r,this.y),n.setFromEulerAngles(t,e,i)):n.setFromAxisAngle(r.startRotationAxis,i),n.getEulerAngles(s),r.angularVelocity.add(s)},pc.ParticleSystemRotationBySpeed=r}(),function(){function t(t,e,i){this._shapeModule=t,this._hemisphereMode=e,this._circleMode=i}t.prototype.applyTransformations=function(t,e){const i=this._shapeModule.m_ParticleSystem._random,n=this._shapeModule.circularSpawner.getNextPosition()*this._shapeModule.arc*pc.math.DEG_TO_RAD,s=180*i.nextFloat()*pc.math.DEG_TO_RAD;t.x=Math.sin(s)*Math.cos(n),t.y=Math.sin(s)*Math.sin(n),t.z=Math.cos(s),this._hemisphereMode&&(t.z=Math.abs(t.z)),this._circleMode&&(t.z=0),t.normalize(),e.copy(t);const r=this._shapeModule.getPointInRadius(this._shapeModule.radius);t.scale(r)},pc.SphereShape=t}(),function(){function t(t){this._shapeModule=t}const e=new Array(3);t.prototype.applyTransformations=function(t,i){const n=this._shapeModule.m_ParticleSystem._random;switch(this._shapeModule.shapeType){case UnityEngine.ParticleSystemShapeType.Box:t.x=n.nextFloat()-.5,t.y=n.nextFloat()-.5,t.z=n.nextFloat()-.5;break;case UnityEngine.ParticleSystemShapeType.BoxShell:{e[0]=n.nextFloat()-.5,e[1]=n.nextFloat()-.5,e[2]=n.nextFloat()-.5;const i=n.nextInteger()%3;e[i]=Math.round(n.nextFloat())-.5,t.x=e[0],t.y=e[1],t.z=e[2];break}case UnityEngine.ParticleSystemShapeType.Rectangle:t.x=n.nextFloat()-.5,t.y=n.nextFloat()-.5,t.z=0;break;case UnityEngine.ParticleSystemShapeType.BoxEdge:{e[0]=n.nextFloat()-.5,e[1]=n.nextFloat()-.5,e[2]=n.nextFloat()-.5;const i=Math.floor(3*n.nextFloat());for(let t=0;t<3;t++)t!==i&&(e[t]=Math.round(n.nextFloat())-.5);t.x=e[0],t.y=e[1],t.z=e[2];break}case UnityEngine.ParticleSystemShapeType.SingleSidedEdge:{const e=this._shapeModule.circularSpawner.getNextPosition()-.5;return t.x=e*this._shapeModule.radius,t.y=0,t.z=0,void i.copy(pc.Vec3.UP)}}i.copy(pc.Vec3.BACK)},pc.BoxShape=t}(),function(){function t(t){this._shapeModule=t,this._curValue=0,this._prevTime=0}Object.defineProperty(t.prototype,"radius",{get:function(){return this._shapeModule._radius}}),Object.defineProperty(t.prototype,"arcMode",{get:function(){return this._shapeModule._arcMode}}),Object.defineProperty(t.prototype,"arcSpread",{get:function(){return this._shapeModule._arcSpread}}),Object.defineProperty(t.prototype,"arcSpeed",{get:function(){return this._shapeModule._arcSpeed}}),Object.defineProperty(t.prototype,"arcSpeedMultiplier",{get:function(){return this._shapeModule._arcSpeedMultiplier}}),Object.defineProperty(t.prototype,"radiusMode",{get:function(){return this._shapeModule._radiusMode}}),Object.defineProperty(t.prototype,"radiusSpread",{get:function(){return this._shapeModule._radiusSpread}}),Object.defineProperty(t.prototype,"radiusSpeed",{get:function(){return this._shapeModule._radiusSpeed}}),t.prototype.roundToSpread=function(t,e){return 0===e?t%1:Math.floor(t/e)*e%1},t.prototype.pingPong=function(t,e){const i=Math.floor(t/e),n=t-e*i;return i%2==0?n:1-n},t.prototype.getNextPosition=function(){const t=this._shapeModule.m_ParticleSystem._random,e=1/this._shapeModule.m_ParticleSystem.emission.rateOverTime.evaluate(this._shapeModule.m_ParticleSystem.lifePart);let i=this._shapeModule.m_ParticleSystem.lifetime;this._prevTime>i&&(i+=this._shapeModule.m_ParticleSystem.main.duration);let n=i-this._prevTime,s=0;n>e&&(s=n-e,n=e),this._prevTime=this._shapeModule.m_ParticleSystem.lifetime-s;const r=this._shapeModule._shapeType===UnityEngine.ParticleSystemShapeType.SingleSidedEdge;let o=0;const a=this._shapeModule.m_ParticleSystem.lifePart,u=r?this.radiusMode:this.arcMode,c=r?1:this.arcSpeed.evaluate(a)*(360/this._shapeModule.arc),h=r?this.radiusSpread:this.arcSpread;switch(u){case UnityEngine.ParticleSystemShapeMultiModeValue.Loop:this._curValue+=n*c,o=this.roundToSpread(this._curValue,h);break;case UnityEngine.ParticleSystemShapeMultiModeValue.PingPong:this._curValue+=n*c,o=this.pingPong(this._curValue,1),o=this.roundToSpread(o,h);break;case UnityEngine.ParticleSystemShapeMultiModeValue.BurstSpread:case UnityEngine.ParticleSystemShapeMultiModeValue.Random:default:o=t.nextFloat(),o=this.roundToSpread(o,h)}return o},t.prototype.reset=function(){this._curValue=0,this._prevTime=0},pc.CircularSpawner=t}(),function(){function t(t,e){this._shapeModule=t,this._useVolume=e||!1}t.prototype.applyTransformations=function(t,e){const i=this._shapeModule.m_ParticleSystem._random,n=this._shapeModule.circularSpawner.getNextPosition()*this._shapeModule.arc*pc.math.DEG_TO_RAD;t.x=Math.cos(n),t.y=Math.sin(n),t.z=0;const s=1-this._shapeModule.radiusThickness,r=s+(1-s)*i.nextFloat(),o=r*this._shapeModule.radius,a=this._shapeModule.angle*r*pc.math.DEG_TO_RAD;if(0===a?(e.x=0,e.y=0,e.z=1):(e.x=t.x,e.y=t.y,e.z=Math.sqrt(t.x*t.x+t.y*t.y)/Math.tan(a),e.normalize()),t.scale(o),this._useVolume){const n=this._shapeModule.length*i.nextFloat();t.add(e.clone().scale(n))}},pc.ConeShape=t}(),function(){const t=new pc.Vec3,e=new pc.Vec3;function i(t){this._shapeModule=t}i.prototype.applyTransformations=function(i,n){const s=this._shapeModule.m_ParticleSystem._random,r=this._shapeModule.circularSpawner.getNextPosition()*this._shapeModule.arc*pc.math.DEG_TO_RAD,o=360*s.nextFloat()*pc.math.DEG_TO_RAD,a=this._shapeModule.radius,u=this._shapeModule.getPointInRadius(this._shapeModule.donutRadius);t.x=a*Math.cos(r),t.y=a*Math.sin(r),t.z=0,e.x=(a+u*Math.cos(o))*Math.cos(r),e.y=(a+u*Math.cos(o))*Math.sin(r),e.z=u*Math.sin(o),n.copy(e).sub(t),i.copy(e)},pc.DonutShape=i}(),function(){function t(t){this.m_ParticleSystem=t,this._TRS=pc.Mat4.IDENTITY,this._TR=pc.Mat4.IDENTITY,this.enabled=!1,this.radiusSpeed=new pc.MinMaxCurve,this.radiusSpeed._random=t._random,this.radiusSpeedMultiplier=1,this.arcSpeed=new pc.MinMaxCurve,this.arcSpeed._random=t._random,this.arcSpeedMultiplier=1,this.circularSpawner=new pc.CircularSpawner(this)}Object.defineProperty(t.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled=t}}),Object.defineProperty(t.prototype,"shapeType",{get:function(){return this._shapeType},set:function(t){switch(this._shapeType=t,t){case UnityEngine.ParticleSystemShapeType.Cone:this.impl=new pc.ConeShape(this,!1);break;case UnityEngine.ParticleSystemShapeType.ConeVolume:this.impl=new pc.ConeShape(this,!0);break;case UnityEngine.ParticleSystemShapeType.Sphere:this.impl=new pc.SphereShape(this);break;case UnityEngine.ParticleSystemShapeType.Hemisphere:this.impl=new pc.SphereShape(this,!0);break;case UnityEngine.ParticleSystemShapeType.Circle:this.impl=new pc.SphereShape(this,!1,!0);break;case UnityEngine.ParticleSystemShapeType.Donut:this.impl=new pc.DonutShape(this);break;case UnityEngine.ParticleSystemShapeType.Box:case UnityEngine.ParticleSystemShapeType.BoxShell:case UnityEngine.ParticleSystemShapeType.BoxEdge:case UnityEngine.ParticleSystemShapeType.Rectangle:case UnityEngine.ParticleSystemShapeType.SingleSidedEdge:default:this.impl=new pc.BoxShape(this)}}}),Object.defineProperty(t.prototype,"randomDirectionAmount",{get:function(){return this._randomDirectionAmount},set:function(t){this._randomDirectionAmount=t}}),Object.defineProperty(t.prototype,"sphericalDirectionAmount",{get:function(){return this._sphericalDirectionAmount},set:function(t){this._sphericalDirectionAmount=t}}),Object.defineProperty(t.prototype,"randomPositionAmount",{get:function(){return this._randomPositionAmount},set:function(t){this._randomPositionAmount=t}}),Object.defineProperty(t.prototype,"alignToDirection",{get:function(){return this._alignToDirection},set:function(t){this._alignToDirection=t}}),Object.defineProperty(t.prototype,"radius",{get:function(){return this._radius},set:function(t){this._radius=t}}),Object.defineProperty(t.prototype,"radiusMode",{get:function(){return this._radiusMode},set:function(t){this._radiusMode=t}}),Object.defineProperty(t.prototype,"radiusSpread",{get:function(){return this._radiusSpread},set:function(t){this._radiusSpread=t}}),Object.defineProperty(t.prototype,"radiusSpeed",{get:function(){return this._radiusSpeed},set:function(t){this._radiusSpeed=t}}),Object.defineProperty(t.prototype,"radiusSpeedMultiplier",{get:function(){return this._radiusSpeedMultiplier},set:function(t){this._radiusSpeedMultiplier=t}}),Object.defineProperty(t.prototype,"radiusThickness",{get:function(){return this._radiusThickness},set:function(t){this._radiusThickness=t}}),Object.defineProperty(t.prototype,"angle",{get:function(){return this._angle},set:function(t){this._angle=t}}),Object.defineProperty(t.prototype,"length",{get:function(){return this._length},set:function(t){this._length=t}}),Object.defineProperty(t.prototype,"boxThickness",{get:function(){return this._boxThickness},set:function(t){this._boxThickness=t}}),Object.defineProperty(t.prototype,"arc",{get:function(){return this._arc},set:function(t){this._arc=t}}),Object.defineProperty(t.prototype,"arcMode",{get:function(){return this._arcMode},set:function(t){this._arcMode=t}}),Object.defineProperty(t.prototype,"arcSpread",{get:function(){return this._arcSpread},set:function(t){this._arcSpread=t}}),Object.defineProperty(t.prototype,"arcSpeed",{get:function(){return this._arcSpeed},set:function(t){this._arcSpeed=t}}),Object.defineProperty(t.prototype,"arcSpeedMultiplier",{get:function(){return this._arcSpeedMultiplier},set:function(t){this._arcSpeedMultiplier=t}}),Object.defineProperty(t.prototype,"donutRadius",{get:function(){return this._donutRadius},set:function(t){this._donutRadius=t}}),Object.defineProperty(t.prototype,"position",{get:function(){return this._position},set:function(t){this.trsDirty=!0,this.trDirty=!0,this._position=t}}),Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this.trsDirty=!0,this.trDirty=!0,this._rotation=t}}),Object.defineProperty(t.prototype,"scale",{get:function(){return this._scale},set:function(t){this.trsDirty=!0,this._scale=t}}),Object.defineProperty(t.prototype,"TRS",{get:function(){if(this.trsDirty){const t=new pc.Quat;t.setFromEulerAngles_Unity(this.rotation.x,this.rotation.y,this.rotation.z),this._TRS=(new pc.Mat4).setTRS(this.position,t,this.scale),this.trsDirty=!1}return this._TRS}}),Object.defineProperty(t.prototype,"TR",{get:function(){if(this.trDirty){const t=new pc.Quat;t.setFromEulerAngles_Unity(this.rotation.x,this.rotation.y,this.rotation.z),this._TR=(new pc.Mat4).setTRS(this.position,t,new pc.Vec3(1,1,1)),this.trDirty=!1}return this._TR}}),Object.defineProperty(t.prototype,"trsDirty",{get:function(){return this._trsDirty},set:function(t){this._trsDirty=t}}),Object.defineProperty(t.prototype,"trDirty",{get:function(){return this._trDirty},set:function(t){this._trDirty=t}}),Object.defineProperty(t.prototype,"impl",{get:function(){return this._impl},set:function(t){this._impl=t}});const e=new pc.Vec3,i=new pc.Vec3,n=new pc.Quat,s=new pc.Quat,r=new pc.Vec3,o=new pc.Vec3;t.prototype.applyNextTransform=function(t,a,u){this.impl.applyTransformations(e,i),this.randomizePosition(e),this._shapeType===UnityEngine.ParticleSystemShapeType.Cone?(this.impl.applyTransformations(r,o,0),this.randomizeDirection(i,o)):this.randomizeDirection(i),this.TRS.transformPoint(e,t),this.TRS.transformVector(i,u),u.normalize(),0===u.x&&0===u.y&&0===u.z&&(u.z=1);const c=Math.sign(this.m_ParticleSystem.main.startSpeed.evaluate(this.m_ParticleSystem.lifePart));this.spherizeDirection(t,u,this.position),u.scale(c),n.copy(this.rotationBetweenVectors(pc.Vec3.FORWARD,u)),s.copy(this.rotationBetweenVectors(pc.Vec3.UP,u)),this.m_ParticleSystem._entity._unityComponents.particleSystemRenderer[0]._particleSystemRenderer._renderMode===UnityEngine.ParticleSystemRenderMode.Stretch?a.copy(s):this.alignToDirection?(a.setFromMat4(this.TR),a.mul(n)):a.copy(pc.Quat.IDENTITY)};const a=new pc.Vec3;t.prototype.randomizePosition=function(t){const e=this.m_ParticleSystem._random;this.randomPositionAmount>0&&(a.x=e.nextFloat()-.5,a.y=e.nextFloat()-.5,a.z=e.nextFloat()-.5,a.scale(this.randomPositionAmount),t.add(a))};const u=new pc.Vec3;t.prototype.randomizeDirection=function(t,e){const i=this.m_ParticleSystem._random;this.randomDirectionAmount>0&&(e?u.copy(e):(u.x=i.nextFloat()-.5,u.y=i.nextFloat()-.5,u.z=i.nextFloat()-.5),u.normalize(),t.lerp(t,u,this.randomDirectionAmount)),t.normalize()};const c=new pc.Vec3;t.prototype.spherizeDirection=function(t,e,i){this.sphericalDirectionAmount>0&&(c.copy(t).sub(i).normalize(),e.lerp(e,c,this.sphericalDirectionAmount)),e.normalize()};const h=new pc.Quat,l=new pc.Vec3;t.prototype.rotationBetweenVectors=function(t,e){return l.cross(t,e),h.x=l.x,h.y=l.y,h.z=l.z,h.w=Math.sqrt(t.lengthSq()*e.lengthSq())+t.dot(e),h.normalize()},t.prototype.getPointInRadius=function(t){const e=this.m_ParticleSystem._random,i=1-this.radiusThickness;return(i+(1-i)*e.nextFloat())*t},pc.ParticleSystemShape=t}(),function(){function t(t){this.m_ParticleSystem=t,this.enabled=!1,this.frameOverTime=new pc.MinMaxCurve,this.frameOverTime._random=t._random,this.frameOverTimeMultiplier=1,this.startFrame=new pc.MinMaxCurve,this.startFrame._random=t._random,this.startFrameMultiplier=1}Object.defineProperty(t.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled=t}}),Object.defineProperty(t.prototype,"animation",{get:function(){return this._animation},set:function(t){this._animation=t}}),Object.defineProperty(t.prototype,"cycleCount",{get:function(){return this._cycleCount},set:function(t){this._cycleCount=t}}),Object.defineProperty(t.prototype,"flipU",{get:function(){return this._flipU},set:function(t){this._flipU=t}}),Object.defineProperty(t.prototype,"flipV",{get:function(){return this._flipV},set:function(t){this._flipV=t}}),Object.defineProperty(t.prototype,"frameOverTime",{get:function(){return this._frameOverTime},set:function(t){this._frameOverTime=t}}),Object.defineProperty(t.prototype,"frameOverTimeMultiplier",{get:function(){return this._frameOverTimeMultiplier},set:function(t){this._frameOverTimeMultiplier=t}}),Object.defineProperty(t.prototype,"mode",{get:function(){return this.m_Mode},set:function(t){this.m_Mode=t}}),Object.defineProperty(t.prototype,"numTilesX",{get:function(){return this._numTilesX},set:function(t){this._numTilesX=t}}),Object.defineProperty(t.prototype,"numTilesY",{get:function(){return this._numTilesY},set:function(t){this._numTilesY=t}}),Object.defineProperty(t.prototype,"rowIndex",{get:function(){return this._rowIndex},set:function(t){this._rowIndex=t}}),Object.defineProperty(t.prototype,"spriteCount",{get:function(){return this._spriteCount}}),Object.defineProperty(t.prototype,"startFrame",{get:function(){return this._startFrame},set:function(t){this._startFrame=t}}),Object.defineProperty(t.prototype,"startFrameMultiplier",{get:function(){return this._startFrameMultiplier},set:function(t){this._startFrameMultiplier=t}}),Object.defineProperty(t.prototype,"useRandomRow",{get:function(){return this._useRandomRow},set:function(t){this._useRandomRow=t}}),t.prototype._processGridMode=function(t,e){const i=this.m_ParticleSystem._random,n=this.animation===UnityEngine.ParticleSystemAnimationType.WholeSheet?this._numTilesX*this._numTilesY:this._numTilesX;null===t.startFrame&&(t.startFrame=Math.floor(this.startFrame.evaluate(this.m_ParticleSystem.lifePart)*n));let s=Math.floor(this.frameOverTime.evaluate(t.lifePart)*n*this.cycleCount)+t.startFrame;this.animation===UnityEngine.ParticleSystemAnimationType.SingleRow?(t.texSheetAnimationInitialized||(t.texSheetRow=this.useRandomRow?i.nextInteger()%this.numTilesY:this.rowIndex,t.texSheetAnimationInitialized=!0),t.texSheetColumn=s%this.numTilesX):this.animation===UnityEngine.ParticleSystemAnimationType.WholeSheet&&(s%=this.numTilesX*this.numTilesY,t.texSheetRow=Math.floor(s/this.numTilesX),t.texSheetColumn=s%this.numTilesX)},t.prototype.processInplace=function(t,e){this.mode===UnityEngine.ParticleSystemAnimationMode.Grid?this._processGridMode(t,e):(this.mode,UnityEngine.ParticleSystemAnimationMode.Sprites)},pc.ParticleSystemTextureSheetAnimation=t}(),function(){const t=new pc.Vec3;function e(t){this.particleSystem=t,this.enabled=!1,this._curve=new pc.MinMaxCurve,this._curve._random=t._random,this._curveMultiplier=1}Object.defineProperty(e.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled=t}}),Object.defineProperty(e.prototype,"mode",{get:function(){return this._mode},set:function(t){this._mode=t}}),Object.defineProperty(e.prototype,"curve",{get:function(){return this._curve},set:function(t){this._curve=t}}),Object.defineProperty(e.prototype,"curveMultiplier",{get:function(){return this._curveMultiplier},set:function(t){this._curveMultiplier=t}}),e.prototype.processInplace=function(e,i){if(this.particleSystem.main.simulationSpace===UnityEngine.ParticleSystemSimulationSpace.World){switch(t.copy(pc.Vec3.ONE),this._mode){case UnityEngine.ParticleSystemInheritVelocityMode.Initial:e.inheritVelocityValue||(e.inheritVelocityValue=new pc.Vec3,e.inheritVelocityValue.copy(this.particleSystem.currentVelocity)),t.copy(e.inheritVelocityValue);break;case UnityEngine.ParticleSystemInheritVelocityMode.Current:t.copy(this.particleSystem.currentVelocity)}t.scale(this._curve.evaluate(this.particleSystem.lifePart)),e.totalSpeed.add(t)}},pc.ParticleSystemInheritVelocity=e}(),function(){let t=new pc.Vec3;function e(t){this.m_ParticleSystem=t,this._enabled=!1,this._x=new pc.MinMaxCurve,this._x._random=t._random,this._y=new pc.MinMaxCurve,this._y._random=t._random,this._z=new pc.MinMaxCurve,this._z._random=t._random,this._xMultiplier=0,this._yMultiplier=0,this._zMultiplier=0,this._space=0,this._randomized=!1}Object.defineProperty(e.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled=t}}),Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t}}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t}}),Object.defineProperty(e.prototype,"z",{get:function(){return this._z},set:function(t){this._z=t}}),Object.defineProperty(e.prototype,"xMultiplier",{get:function(){return this._xMultiplier},set:function(t){this._xMultiplier=t}}),Object.defineProperty(e.prototype,"yMultiplier",{get:function(){return this._yMultiplier},set:function(t){this._yMultiplier=t}}),Object.defineProperty(e.prototype,"zMultiplier",{get:function(){return this._zMultiplier},set:function(t){this._zMultiplier=t}}),Object.defineProperty(e.prototype,"space",{get:function(){return this._space},set:function(t){this._space=t}}),Object.defineProperty(e.prototype,"randomized",{get:function(){return this._randomized},set:function(t){this._randomized=t}}),e.prototype.processInplace=function(e,i){this._x.mode===pc.MinMaxCurveMode.Curve||this._randomized?t=this.getForceValue(e):e.forceOverLifetimeValue?t.copy(e.forceOverLifetimeValue):(t=this.getForceValue(e,i),e.forceOverLifetimeValue=new pc.Vec3,e.forceOverLifetimeValue.copy(t)),this._space===UnityEngine.ParticleSystemSimulationSpace.World&&this.m_ParticleSystem.entity.worldTransformInverse.transformVector(t,t),t.scale(i),e.ownSpeed.add(t),e.totalSpeed.add(t)},e.prototype.getForceValue=function(e){return t.x=this._x.evaluate(e.lifePart),t.y=this._y.evaluate(e.lifePart),t.z=this._z.evaluate(e.lifePart),t},pc.ParticleSystemForceOverLifetime=e}(),function(){let t=0;const e=new pc.Vec3;function i(t){this.m_ParticleSystem=t,this._enabled=!0,this._limit=new pc.MinMaxCurve,this._limit._random=t._random,this._limitMultiplier=1,this._separateAxes=!1,this._limitX=new pc.MinMaxCurve,this._limitX._random=t._random,this._limitY=new pc.MinMaxCurve,this._limitY._random=t._random,this._limitZ=new pc.MinMaxCurve,this._limitZ._random=t._random,this._limitXMultiplier=1,this._limitYMultiplier=1,this._limitZMultiplier=1,this._space=0,this._dampen=0,this._drag=new pc.MinMaxCurve,this._drag._random=t._random,this._dragMultiplier=1,this._multiplyDragByParticleSize=!1,this._multiplyDragByParticleVelocity=!1}Object.defineProperty(i.prototype,"enabled",{get:function(){return this._enabled},set:function(t){this._enabled=t}}),Object.defineProperty(i.prototype,"limit",{get:function(){return this._limit},set:function(t){this._limit=t}}),Object.defineProperty(i.prototype,"limitMultiplier",{get:function(){return this._limitMultiplier},set:function(t){this._limitMultiplier=t}}),Object.defineProperty(i.prototype,"separateAxes",{get:function(){return this._separateAxes},set:function(t){this._separateAxes=t}}),Object.defineProperty(i.prototype,"limitX",{get:function(){return this._limitX},set:function(t){this._limitX=t}}),Object.defineProperty(i.prototype,"limitY",{get:function(){return this._limitY},set:function(t){this._limitY=t}}),Object.defineProperty(i.prototype,"limitZ",{get:function(){return this._limitZ},set:function(t){this.limitY=t}}),Object.defineProperty(i.prototype,"limitXMultiplier",{get:function(){return this._limitXMultiplier},set:function(t){this._limitXMultiplier=t}}),Object.defineProperty(i.prototype,"limitYMultiplier",{get:function(){return this._limitYMultiplier},set:function(t){this._limitYMultiplier=t}}),Object.defineProperty(i.prototype,"limitZMultiplier",{get:function(){return this._limitZMultiplier},set:function(t){this._limitZMultiplier=t}}),Object.defineProperty(i.prototype,"space",{get:function(){return this._space},set:function(t){this._space=t}}),Object.defineProperty(i.prototype,"dampen",{get:function(){return this._dampen},set:function(t){this._dampen=t}}),Object.defineProperty(i.prototype,"drag",{get:function(){return this._drag},set:function(t){this._drag=t}}),Object.defineProperty(i.prototype,"dragMultiplier",{get:function(){return this._dragMultiplier},set:function(t){this._dragMultiplier=t}}),Object.defineProperty(i.prototype,"multiplyDragByParticleSize",{get:function(){return this._multiplyDragByParticleSize},set:function(t){this._multiplyDragByParticleSize=t}}),Object.defineProperty(i.prototype,"multiplyDragByParticleVelocity",{get:function(){return this._multiplyDragByParticleVelocity},set:function(t){this._multiplyDragByParticleVelocity=t}}),i.prototype.applyDamp=function(t,e,i){const n=Math.abs(t),s=n-e;return Math.sign(t)*Math.min(s*this._dampen*i*(s/n)*30.61,n)},i.prototype.applyDragInplace=function(t,e,i){let n=1,s=1;this._multiplyDragByParticleSize&&this.multiplyDragByParticleVelocity?(s=t.totalSpeed.length(),n=this.getScaleModifier(t),t.ownSpeed.scale(1-e*n*s*i)):this._multiplyDragByParticleSize?(n=this.getScaleModifier(t),t.ownSpeed.x=Math.sign(t.ownSpeed.x)*Math.max(Math.abs(t.ownSpeed.x)-e*n*i,0),t.ownSpeed.y=Math.sign(t.ownSpeed.y)*Math.max(Math.abs(t.ownSpeed.y)-e*n*i,0),t.ownSpeed.z=Math.sign(t.ownSpeed.z)*Math.max(Math.abs(t.ownSpeed.z)-e*n*i,0)):this._multiplyDragByParticleVelocity?(s=t.totalSpeed.length(),t.ownSpeed.scale(1-e*s*i)):(t.ownSpeed.x=Math.sign(t.ownSpeed.x)*Math.max(Math.abs(t.ownSpeed.x)-e*i,0),t.ownSpeed.y=Math.sign(t.ownSpeed.y)*Math.max(Math.abs(t.ownSpeed.y)-e*i,0),t.ownSpeed.z=Math.sign(t.ownSpeed.z)*Math.max(Math.abs(t.ownSpeed.z)-e*i,0))},i.prototype.getScaleModifier=function(t){const e=Math.max(t.tmpScale.x,t.tmpScale.y,t.tmpScale.z);return Math.PI*e*e/4},i.prototype.processInplace=function(i,n){if(this.applyDragInplace(i,this.drag.evaluate(i.lifePart),n),e.x=this._separateAxes)e.x=this._limitX.evaluate(i.lifePart),e.y=this._limitY.evaluate(i.lifePart),e.z=this._limitZ.evaluate(i.lifePart);else{const t=this._limit.evaluate(i.lifePart);e.x=t,e.y=t,e.z=t}this._space===UnityEngine.ParticleSystemSimulationSpace.World&&this.m_ParticleSystem.entity.worldTransformInverse.transformVector(e,e),Math.abs(i.totalSpeed.x)>e.x&&(t=-this.applyDamp(i.totalSpeed.x,e.x,n),i.ownSpeed.x+=t,i.totalSpeed.x+=t),Math.abs(i.totalSpeed.y)>e.y&&(t=-this.applyDamp(i.totalSpeed.y,e.y,n),i.ownSpeed.y+=t,i.totalSpeed.y+=t),Math.abs(i.totalSpeed.z)>e.z&&(t=-this.applyDamp(i.totalSpeed.z,e.z,n),i.ownSpeed.z+=t,i.totalSpeed.z+=t)},pc.ParticleSystemLimitVelocityOverLifetime=i}(),Object.assign(pc,function(){const t=function(t,e){const i=t.internalExecutionOrder-e.internalExecutionOrder;return 0!==i?i:t._scriptsExecutionOrder-e._scriptsExecutionOrder},e=function(){this._components=[],this._needsSort=!1};return Object.defineProperty(e.prototype,"length",{get:function(){return this._components.length}}),e.prototype.push=function(t){t._scriptsExecutionOrder=4294967296*(t.scriptsExecutionOrder+32768)+(t.sortingOrderInQueue+2147483648),0!==this._components.length&&t._scriptsExecutionOrder<this._components[this._components.length-1]._scriptsExecutionOrder&&(this._needsSort=!0),this._components.push(t)},e.prototype.getComponents=function(){return this._needsSort&&(this._needsSort=!1,this._components.sort(t)),this._components.slice()},e.prototype.delete=function(t){for(let e=0;e<this._components.length;e++)if(t===this._components[e]._id)return void this._components.splice(e,1)},e.prototype.clear=function(){this._components.length=0},{ComponentQueue:e}}()),Object.assign(pc,function(){const t=function(t,e){this.object=t,this.time=e,this.updatedAt=UnityEngine.Time.time,this.instant=!e||e<=0,this.secondPassProcess=!1,this.enabled=!0,this.instant&&this.prepare()};(t.prototype=Object.create(Object.prototype)).constructor=t,Object.assign(t.prototype,{prepare:function(){this.isValid&&(this.object.enabled=!1)},update:function(){if(!this.isValid||this.instant||this.time<=0)return;const t=UnityEngine.Time.time,e=t-this.updatedAt;this.updatedAt=t,this.time-=e,this.time<=0&&(this.prepare(),this.secondPassProcess=!0)},execute:function(){this.isValid&&(this.object.onDestroy&&this.object.onDestroy(),this.object.destroy(),this.object=null)}}),Object.defineProperty(t.prototype,"isValid",{get:function(){return null!==this.object&&!this.object._destroyed}}),Object.defineProperty(t.prototype,"isReady",{get:function(){return this.enabled&&(this.instant||this.time<=0)||!this.isValid}});const e=function(e,i){t.prototype.constructor.call(this,e,i)};(e.prototype=Object.create(t.prototype)).constructor=e,Object.assign(e.prototype,{prepare:function(){if(!this.isValid)return;const t=this.object.collectAllUnityComponents();for(let e=0;e<t.length;e++){t[e].enabled=!1}},execute:function(){if(!this.isValid)return;this.object._beingDestroyed=!0,this.object.enabled=!1;const t=this.object.collectAllUnityComponents();for(let e=0;e<t.length;e++){const i=t[e];i.onDestroy&&i.onDestroy()}this.object.destroy(),this.object=null}}),Object.defineProperty(e.prototype,"isValid",{get:function(){return null!==this.object&&!this.object._destroyed&&!this.object._beingDestroyed}});const i=function(e,i){t.prototype.constructor.call(this,e,i)};return(i.prototype=Object.create(t.prototype)).constructor=i,Object.assign(i.prototype,{prepare:function(){},execute:function(){this.isValid&&(this.object.CallOnDisable(),this.object.CallOnDestroy(),this.object._destroyed=!0)}}),Object.defineProperty(i.prototype,"isValid",{get:function(){return!this.object._destroyed}}),{DestroyTask:t,DestroyEntityTask:e,DestroyScriptableObjectTask:i}}()),Object.assign(pc,function(){const t=function(t){pc.ComponentSystem.call(this,t),this.id="unitymanager",this.description="Supports Unity-like components.",this.callbacksDisabled=!1,this.fixedTimeStep=.02,this.maximumAllowedTimeStep=.1,this.timeScale=1,this.maximumParticleTimestep=.15,this._fixedAccumulator=0,this.schema=[],this.app.on("update",this.onUpdate,this),this.app.on("frameend",this.onFrameEnd,this),this.app.on("focus",this.onApplicationFocus,this),this.app.on("blur",this.onApplicationBlur,this),this.systems=[],this.destroyQueue=new Array(64),this.destroyQueueTmp=new Array(64),this.destroyQueueLength=0,this.destroyQueueProcessing=!1};return(t.prototype=Object.create(pc.ComponentSystem.prototype)).constructor=t,Object.assign(t.prototype,{registerSystem:function(t){this.systems.push(t)},onUpdate:function(t){if(this._invokeQueueOnSystems("onStart"),this._invokeQueueOnSystems("onBeforeUpdates",t),Math.abs(UnityEngine.Time.timeScale)>Number.EPSILON)for(this._fixedAccumulator=Math.min(this.maximumAllowedTimeStep,this._fixedAccumulator+t*UnityEngine.Time.timeScale);this._fixedAccumulator>=this.fixedTimeStep;)this._invokeQueueOnSystems("onFixedUpdate",this.fixedTimeStep),this._fixedAccumulator-=this.fixedTimeStep;this._invokeDestroyQueue(!1),this._invokeQueueOnSystems("onUpdate",t),this._invokeDestroyQueue(!0),this._invokeQueueOnSystems("onPostUpdate",t),this._invokeDestroyQueue(!1),this._invokeQueueOnSystems("onBeforeRender",t)},onFrameEnd:function(){this._invokeQueueOnSystems("onAfterRender",null)},onApplicationFocus:function(){this._invokeQueueOnSystems("onApplicationFocus",!0)},onApplicationBlur:function(){this._invokeQueueOnSystems("onApplicationFocus",!1)},_invokeQueueOnSystems:function(t,e){for(let i=0;i<this.systems.length;i++){const n=this.systems[i];this._triggerPerformanceSample(n,!0),n[t].call(n,e),this._triggerPerformanceSample(n,!1)}},_triggerPerformanceSample:function(t,e){const i=t.performanceSamplerSection;i&&(e?this.app.counters.startSection(i):this.app.counters.endSection(i))},disableCallbacks:function(){this.callbacksDisabled=!0},enableCallbacks:function(){this.callbacksDisabled=!1},invokeCallbacks:function(t){if(t.isPrefab&&null==t.parent)return;this.callbacksDisabled=!1;const e=new pc.ComponentQueue;this._collectComponents(t,e),this._invokeQueue(e)},_collectComponents:function(t,e){const i=t.collectAllUnityComponents();for(let t=0;t<i.length;t++){const n=i[t];(n.onAwake||n.onEnable||n.onDisable)&&e.push(n)}},_invokeQueue:function(t,e){if(0===t.length)return;const i=t.getComponents(!0);for(let t=0;t<i.length;t++){const n=i[t];n.entity._enabledInHierarchy&&(n.onInit&&n.onInit.call(n,e),n.onEnable&&n.enabled&&n.onEnable.call(n,e),n.onDisable&&!n.enabled&&n.onDisable.call(n,e))}},enqueueDestroy:function(t){t.isValid&&(this.destroyQueueProcessing&&(t.enabled=!1),this.destroyQueue[this.destroyQueueLength]=t,this.destroyQueueLength++)},_invokeDestroyQueue:function(t){if(0===this.destroyQueueLength)return;let e=0;if(this.destroyQueueProcessing=!0,t)for(let t=0;t<this.destroyQueueLength;t++)this.destroyQueue[t].update();for(let t=0;t<this.destroyQueueLength;t++){const i=this.destroyQueue[t];i.isReady?i.secondPassProcess||i.execute():(this.destroyQueueTmp[e]=i,e++)}for(let t=0;t<this.destroyQueueLength;t++){const e=this.destroyQueue[t];e.isReady&&e.secondPassProcess&&e.execute()}for(let t=0;t<this.destroyQueueLength;t++)this.destroyQueue[t].enabled=!0;const i=this.destroyQueue;this.destroyQueue=this.destroyQueueTmp,this.destroyQueueTmp=i,this.destroyQueueLength=e,this.destroyQueueProcessing=!1}}),{UnityComponentSystemManagerSystem:t}}()),Object.assign(pc,function(){const t=["rigidbody","collider","joint","rigidbody2D","collider2D","joint2D","uiBehaviour","monoBehaviour","animator","animation","particlesystem","particleSystemRenderer","reflectionprobe","videoPlayer","canvasRenderer","audiosourceunity","renderer","meshFilter","effector2D"],e=function(e){pc.ComponentSystem.call(this,e),this.id="unity",this.description="Supports Unity-like components.",this.systemIds=t,this.creatingPrefabs=!1,this.schema=[],this._components={},this.app.systems.unitymanager.registerSystem(this),this.queues={onStart:new pc.ComponentQueue,onBeforeUpdates:new pc.ComponentQueue,onFixedUpdate:new pc.ComponentQueue,onUpdate:new pc.ComponentQueue,onPostUpdate:new pc.ComponentQueue,onBeforeRender:new pc.ComponentQueue,onAfterRender:new pc.ComponentQueue,onApplicationFocus:new pc.ComponentQueue}};return(e.prototype=Object.create(pc.ComponentSystem.prototype)).constructor=e,Object.assign(e.prototype,{addComponent:function(t,e){if(e._id)throw new Error("Component already belongs somewhere!");e._id=pc.guid.create(),e._entity=t,e.system=this,e.scriptsExecutionOrder=0,t._unityComponents[this.id].push(e),this._components[e._id]=e,e.onAttached(),t.enabled&&e.enabled&&e._onEntityStateChanged(!0)},removeComponent:function(t,e){this._onComponentDisabled(e);const i=t._unityComponents[e._system.id],n=i.indexOf(e);n<0||(i[n]=i[i.length-1],i.length-=1)},onStart:function(t){this._invokeQueue("onStart",t,!0)},onBeforeUpdates:function(t){this._invokeQueue("onBeforeUpdates",t)},onFixedUpdate:function(t){this._invokeQueue("onFixedUpdate",t)},onUpdate:function(t){this._invokeQueue("onUpdate",t)},onPostUpdate:function(t){this._invokeQueue("onPostUpdate",t)},onBeforeRender:function(t){this._invokeQueue("onBeforeRender",t)},onAfterRender:function(t){this._invokeQueue("onAfterRender",t)},onApplicationFocus:function(t){this._invokeQueue("onApplicationFocus",t)},_invokeQueue:function(t,e,i){let n=this.queues[t];if(0===n.length)return;const s=this.queues[t].processing;n=this.queues[t].getComponents(),s||(this.queues[t].processing=!0),i&&this.queues[t].clear();for(let i=0;i<n.length;i++){const s=n[i];s.entity._enabledInHierarchy&&!s.callbackActivated(t)&&(s.rememberCallback(t),s[t].call(s,e))}i&&this.queues[t].length>0&&this._invokeQueue(t,e,i),s||(this.queues[t].processing=!1)},_onComponentEnabled:function(t){const e=t._queuesToSubscribe();for(let i=0;i<e.length;i++)this.queues[e[i]].push(t)},_componentShouldStart:function(t){this.queues.onStart.push(t)},_onComponentDisabled:function(t){const e=t._queuesToSubscribe();for(let i=0;i<e.length;i++)this.queues[e[i]].delete(t._id);this.queues.onStart.delete(t._id)},_onEntityHierarchyStateChanged:function(e,i){const n=e._unityComponents;for(let e=0;e<t.length;e++){const s=n[t[e]];for(let t=0;t<s.length;t++)s[t]._onEntityStateChanged(i)}}}),{UNITY_SYSTEM_IDS:t,UnityComponentSystem:e}}()),Object.assign(pc,function(){let t=0;const e={},i=function(){this._enabled=!0,this._destroyed=!1,this.$id=0,this.internalExecutionOrder=0,this._sortingOrderInQueue=t++,this._activatedCallbacks={onAwake:!1,onEnable:!1,onStart:!1,onDisable:!0,onDestroy:!1}};return(i.prototype={}).constructor=i,i.prototype.toUnityObject=pc.Component.prototype.toUnityObject,i.addRequiredComponents=function(t,n,s){if(!n)return;const r=Bridge.getTypeName(n),o=Deserializers.typeNameToIdMap[r];if(void 0===o)return;let a;e.hasOwnProperty(o)?a=e[o]:(a=[],a.push(o),i.getAllRequiredComponents(o,a),e[o]=a);const u=UnityEngine.Object.FromHandle(UnityEngine.GameObject,t);for(let t=1;t<a.length;t++){const e=a[t],i=Bridge._getTypeByName(Deserializers.types[e]);if(!u.GetComponent(i)){const t=u.AddComponent(i);s.push(t.handle)}}},i.getAllRequiredComponents=function(t,e){const i=Deserializers.requiredComponents[t];if(i&&0!==i.length)for(let t=0;t<i.length;t++){const n=i[t];e.indexOf(n)>=0||(e.push(n),pc.UnityComponent.getAllRequiredComponents(n,e))}},Object.assign(i.prototype,{onInit:function(t){return!this._destroyed&&!this._activatedCallbacks.onAwake&&(this._activatedCallbacks.onAwake=!0,this._activatedCallbacks.onDestroy=!1,this.onAwake&&this.onAwake.call(this,t),!0)},onAttached:function(){},onEnable:function(){return!this._destroyed&&!this._activatedCallbacks.onEnable&&(this._activatedCallbacks.onEnable=!0,this._activatedCallbacks.onDisable=!1,this._system._onComponentEnabled(this),this.onStart&&!this._activatedCallbacks.onStart&&this._system._componentShouldStart(this),!0)},onDisable:function(){return!this._destroyed&&!this._activatedCallbacks.onDisable&&(this._activatedCallbacks.onDisable=!0,this._activatedCallbacks.onEnable=!1,this._system._onComponentDisabled(this),!0)},onDestroy:function(){return!this._destroyed&&!this._activatedCallbacks.onDestroy&&(this._activatedCallbacks.onDestroy=!0,!0)},rememberCallback:function(t){t in this._activatedCallbacks&&(this._activatedCallbacks[t]=!0)},callbackActivated:function(t){return this._activatedCallbacks[t]},_onEntityStateChanged:function(t){LunaUnity.Application.Instance.app.systems.unitymanager.callbacksDisabled||(t?this.onEnable():this.onDisable())},_queuesToSubscribe:function(){return[]},destroy:function(){this._system&&this._entity&&this._system.removeComponent(this._entity,this),this._destroyed=!0}}),Object.defineProperty(i.prototype,"sortingOrderInQueue",{get:function(){return parseInt(this.$id,10)},configurable:!0}),Object.defineProperty(i.prototype,"enabled",{get:function(){return this._enabled},set:function(t){const e=this._enabled&&this._entity&&this._entity.enabled,i=t&&this._entity&&this._entity.enabled;this._enabled=t,e===i||LunaUnity.Application.Instance.app.systems.unitymanager.callbacksDisabled||(i?this.onEnable():this.onDisable())}}),Object.defineProperty(i.prototype,"entity",{get:function(){return this._entity}}),Object.defineProperty(i.prototype,"system",{get:function(){return this._system},set:function(t){this._system=t}}),{UnityComponent:i}}()),Object.assign(pc,function(){const t=["OnMouseDown","OnMouseDrag","OnMouseEnter","OnMouseExit","OnMouseOver","OnMouseUp","OnMouseUpAsButton","OnTriggerEnter","OnTriggerStay","OnTriggerExit","OnCollisionEnter","OnCollisionStay","OnCollisionExit","OnTriggerEnter2D","OnTriggerStay2D","OnTriggerExit2D","OnCollisionEnter2D","OnCollisionStay2D","OnCollisionExit2D","UnityEngine$UI$IMaterialModifier$GetModifiedMaterial","UnityEngine$UI$IMeshModifier$ModifyMesh","UnityEngine$UI$IMeshModifier$ModifyMesh$1","OnPopulateMesh","UnityEngine$ICanvasRaycastFilter$IsRaycastLocationValid"],e=new Map;const i=function(i,n,s){pc.UnityComponent.prototype.constructor.call(this);const r=Bridge._getTypeByName(n);this.code=new r(this),this.scriptsExecutionOrder=0,this.internalExecutionOrder=100,this["__"+n]=this.code,this.code.handle=this,this.unityClass=r,this._enabled=void 0===s||!!s,this._events=[],this._canReceiveUpdates=!1,function(i){const n=i.code.constructor;if(e.has(n))return;const s=[];for(let e=0;e<t.length;e++)n.prototype[t[e]]!==UnityEngine.UI.Graphic.prototype.OnPopulateMesh&&n.prototype[t[e]]&&s.push(t[e]);e.set(n,s)}(this),this._addEventListeners()};return i.create=function(t){const e=Bridge._getTypeByName(t.type);return Bridge.isFunction(e)?new i(t.entity,t.type,t.enabled):null},(i.prototype=Object.create(pc.UnityComponent.prototype)).constructor=i,Object.assign(i.prototype,{storeMagicMethods:function(t){if(t.isPrefab)return;const i=Bridge.as(this.code,UnityEngine.EventSystems.IEventSystemHandler);t._eventHanders||(t._eventHanders=[]),i&&t._eventHanders.push(i);const n=e.get(this.code.constructor);if(0!==n.length){null===t._magicMethods&&(t._magicMethods={});for(let e=0;e<n.length;e++){const i=t._magicMethods[n[e]]||[];i.push(this),t._magicMethods[n[e]]=i}}},removeMagicMethods:function(t){const i=e.get(this.code.constructor);if(0!==i.length&&null!==t._magicMethods)for(let e=0;e<i.length;e++){const n=t._magicMethods[i[e]];if(n){const t=n.indexOf(this);t>=0&&(n[t]=n[n.length-1],n.length-=1)}}},configureForEntity:function(t){this.code.ConfigureForEntity&&this.code.ConfigureForEntity(t)},onEnable:function(){return!!pc.UnityComponent.prototype.onEnable.call(this)&&(this._invokeOverload("OnEnable"),pc.Application.getApplication()._noticeScriptComponent(this,!0),!0)},onDisable:function(){return!!pc.UnityComponent.prototype.onDisable.call(this)&&(this._invokeOverload("OnDisable"),pc.Application.getApplication()._noticeScriptComponent(this,!1),!0)},onDestroy:function(){return!!pc.UnityComponent.prototype.onDestroy.call(this)&&(this.stopAllCoroutines(),this._invokeOverload("DestroyInternal"),this._invokeOverload("OnDestroy"),!0)},onAwake:function(){this._invokeOverload("Awake")},onStart:function(){this._invokeOverload("Start"),this.hasCamera&&this.code.OnRenderImage&&this._entity.camera.postEffects.addEffect(this.code),this._canReceiveUpdates=!0},onUpdate:function(){this._invokeOverload("Update")},onFixedUpdate:function(){this._invokeOverload("FixedUpdate")},onPostUpdate:function(){this.code.LateUpdate()},onBeforeRender:function(){this.code.OnPreRender()},onAfterRender:function(){this.code.OnPostRender()},onApplicationFocus:function(t){this.code.OnApplicationFocus(t)},onPointerEnter:function(t){(this.code.OnPointerEnter||this.code.UnityEngine$EventSystems$IPointerEnterHandler$OnPointerEnter).call(this.code,t)},onPointerExit:function(t){(this.code.OnPointerExit||this.code.UnityEngine$EventSystems$IPointerExitHandler$OnPointerExit).call(this.code,t)},onPointerDown:function(t){(this.code.OnPointerDown||this.code.UnityEngine$EventSystems$IPointerDownHandler$OnPointerDown).call(this.code,t)},onPointerUp:function(t){(this.code.OnPointerUp||this.code.UnityEngine$EventSystems$IPointerUpHandler$OnPointerUp).call(this.code,t)},onPointerClick:function(t){(this.code.OnPointerClick||this.code.UnityEngine$EventSystems$IPointerClickHandler$OnPointerClick).call(this.code,t)},onBeginDrag:function(t){(this.code.onBeginDrag||this.code.UnityEngine$EventSystems$IBeginDragHandler$OnBeginDrag).call(this.code,t)},onDrag:function(t){(this.code.OnDrag||this.code.UnityEngine$EventSystems$IDragHandler$OnDrag).call(this.code,t)},onEndDrag:function(t){(this.code.OnEndDrag||this.code.UnityEngine$EventSystems$IEndDragHandler$OnEndDrag).call(this.code,t)},addCoroutine:function(t){this._system.addCoroutine(t,this)},addFixedUpdateCoroutine:function(t){this._system.addFixedUpdateCoroutine(t,this)},addEndOfFrameCoroutine:function(t){this._system.addEndOfFrameCoroutine(t,this)},stopAllCoroutines:function(){this._system.stopAllCoroutines(this)},stopCoroutine:function(t){this._system.stopCoroutine(t,this)},checkCamera:function(){!this.hasCamera&&this._entity&&this._entity.camera instanceof pc.CameraComponent&&(this.hasCamera=!0,this.code.OnPreRender&&this._events.push("onBeforeRender"),this.code.OnPostRender&&this._events.push("onAfterRender"),this.code.OnRenderImage&&this._addRenderImageListener())},_addRenderImageListener:function(){this.code.render=function(t,e,i){const n=new UnityEngine.RenderTexture(t),s=null==e?null:new UnityEngine.RenderTexture(e);this.onRenderImage(n,s)}},_addEventListeners:function(){this.code.Update&&this._events.push("onUpdate"),this.code.FixedUpdate&&this._events.push("onFixedUpdate"),this.code.LateUpdate&&this._events.push("onPostUpdate"),this.code.OnPostRender&&this._events.push("onAfterRender"),this.code.OnApplicationFocus&&this._events.push("onApplicationFocus")},_queuesToSubscribe:function(){return this._events},_invokeOverload:function(t){try{const e=this.code.overloads[t+"()"]||t,i=this.code[e];if(void 0!==i){const t=i.call(this.code);t&&"Bridge.GeneratorEnumerator"===t.$$fullname&&new UnityEngine.Coroutine(t,this)}}catch(t){t=t.hasOwnProperty("errorStack")?t.errorStack:t,console.error(t),"undefined"!=typeof Sentry&&Sentry.captureException(t)}},onCanvasGroupChanged:function(){this._invokeOverload("OnCanvasGroupChanged")},onBeforeTransformParentChanged:function(){this._invokeOverload("OnBeforeTransformParentChanged")},onTransformParentChanged:function(){this._invokeOverload("OnTransformParentChanged")},onTransformChildrenChanged:function(){this._invokeOverload("OnTransformChildrenChanged")}}),{MonoBehaviourComponent:i}}()),Object.assign(pc,function(){const t=function(t){pc.UnityComponentSystem.call(this,t),this.id="monoBehaviour",this.performanceSamplerSection=pc.Counters.SCRIPTS,this.scriptsExecutionOrder=[],this._coroutines={onUpdate:{},onFixedUpdate:{},onAfterRender:{}}};return(t.prototype=Object.create(pc.UnityComponentSystem.prototype)).constructor=t,Object.assign(t.prototype,{addComponent:function(t,e){pc.UnityComponentSystem.prototype.addComponent.call(this,t,e),e.scriptsExecutionOrder=this.scriptsExecutionOrder[e.code.$$fullname]||0,e.storeMagicMethods(t)},removeComponent:function(t,e){pc.UnityComponentSystem.prototype.removeComponent.call(this,t,e),e.removeMagicMethods(t)},onBeforeUpdates:function(){UnityEngine.Input.OnMouseUpdate()},onUpdate:function(t){pc.UnityComponentSystem.prototype.onUpdate.call(this,t);const e=this._coroutines.onUpdate;for(const i in e){const n=e[i],s=n.length>0?n[0][1]:null;if(!s||!s._entity._activeSelf){delete e[i];continue}let r=0,o=-1;for(let e=n.length-1;e>=0;--e){const i=n[e][0];i.Update(t),i.isDone?(r++,o<0&&(o=e)):o>=0&&(n[o--]=n[e])}r===n.length?delete e[i]:r>0&&n.splice(0,r)}},onFixedUpdate:function(t){pc.UnityComponentSystem.prototype.onFixedUpdate.call(this,t),this._updateCoroutines(this._coroutines.onFixedUpdate,this._handleFixedUpdate)},onAfterRender:function(t){pc.UnityComponentSystem.prototype.onAfterRender.call(this,t),this._updateCoroutines(this._coroutines.onAfterRender,this._handleEndOfFrame)},_updateCoroutines:function(t,e){for(const i in t){const n=t[i],s=n.length>0?n[0][1]:null;if(!s||!s._entity._activeSelf){delete t[i];continue}const r=n.length;for(let t=r-1;t>=0;--t)e(n[t][0]);n.length===r?delete t[i]:n.splice(0,r)}},_handleFixedUpdate:function(t){t.HandleFixedUpdate()},_handleEndOfFrame:function(t){t.HandleEndOfFrame()},stopAllCoroutines:function(t){const e=this._coroutines.onUpdate[t._id];if(e)for(let t=0;t<e.length;++t){e[t][0].Cancel()}},stopCoroutine:function(t,e){const i=this._coroutines.onUpdate[e._id];if(i)for(let e=0;e<i.length;++e){const n=i[e][0];n.enumerator===t&&n.Cancel()}},addCoroutine:function(t,e){this._addCoroutineToQueue(t,e,this._coroutines.onUpdate)},addFixedUpdateCoroutine:function(t,e){this._addCoroutineToQueue(t,e,this._coroutines.onFixedUpdate)},addEndOfFrameCoroutine:function(t,e){this._addCoroutineToQueue(t,e,this._coroutines.onAfterRender)},_addCoroutineToQueue:function(t,e,i){i[e._id]||(i[e._id]=[]),i[e._id].push([t,e])}}),{MonoBehaviourSystem:t}}()),Object.assign(pc,function(){const t=function(t,e,i){pc.MonoBehaviourComponent.prototype.constructor.call(this,t,e,i)};return t.create=function(e){const i=Bridge._getTypeByName(e.type);return Bridge.isFunction(i)?new t(e.entity,e.type,e.enabled):null},(t.prototype=Object.create(pc.MonoBehaviourComponent.prototype)).constructor=t,Object.defineProperty(t.prototype,"sortingOrderInQueue",{get:function(){return this._sortingOrderInQueue},configurable:!0}),{UIBehaviourComponent:t}}()),Object.assign(pc,function(){const t=function(t){pc.MonoBehaviourSystem.call(this,t),this.id="uiBehaviour"};return(t.prototype=Object.create(pc.MonoBehaviourSystem.prototype)).constructor=t,{UIBehaviourSystem:t}}()),Object.assign(pc,function(){let t=0;const e=function(){pc.UnityComponent.prototype.constructor.call(this),this.id=t++,this.model=new pc.Model,this._color=new pc.Color(1,1,1,1),this._groupAlpha=1,this.code=new UnityEngine.CanvasRenderer(this),this._parentCanvas=null,this._colorParameter={const:[1,1,1,1]},this._showMaskGraphics=!0,this._absoluteDepth=0,this._hasPopInstruction=!1,this._popMaterialCount=0,this._popMaterials=[],this.mesh=null,this.isCanvas=!1,this._cullTransparentMesh=!1,this.cull=!1};return(e.prototype=Object.create(pc.UnityComponent.prototype)).constructor=e,Object.defineProperty(e.prototype,"cullTransparentMesh",{get:function(){return this._cullTransparentMesh},set:function(t){this._cullTransparentMesh=t}}),Object.assign(e.prototype,{onEnable:function(){const t=this.findParentCanvas();this.reparentCanvas(t),pc.UnityComponent.prototype.onEnable.call(this)},onDisable:function(){this.reparentCanvas(null),pc.UnityComponent.prototype.onDisable.call(this)},onScreenChanged:function(t){this.reparentCanvas(t)},onCanvasGroupChanged:function(){this.setGroupAlpha(UnityEngine.CanvasGroup.ExtractAlpha(this.entity.element._canvasGroups))},onAttached:function(){const t=this._entity;t.element||t.addComponent("element",{type:pc.ELEMENTTYPE_GROUP,pivot:new pc.Vec2(.5,.5),anchor:new pc.Vec4(0,0,1,1),sizeDelta:new pc.Vec2(0,0),anchoredPosition:new pc.Vec2(0,0)});const e=t.element;e.on("set:stencillayer",this._onStencilLayerChange,this),e.on("set:draworder",this._onDrawOrderChange,this),this.model.element=e,this.model.entity=t},_onStencilLayerChange:function(t){if(this._ignoreMask)this.model.stencil=null;else{const t=this.entity.element;this.model.stencil=t._getStencilParameters(),this.model.masksChildren&&this.model.setParameter("UNITY_UI_ALPHACLIP",1)}},_onDrawOrderChange:function(t){const e=this._entity.element,i=e._nearestScreen;this.model.nearestScreen=i,this.model.element=e,this.model.drawOrder=t,i&&(this.model.sortingLayerIndex=i.sortingLayerIndex,this.model.sortingOrder=i.sortingOrder)},setTexture:function(t){t?this.model.setParameter("_MainTex",t):this.model.deleteParameter("_MainTex")},getTexture:function(){return this.model.getParameter("_MainTex")},setColor:function(t){this._color.equals(t)||(this._color.copy(t),this.applyColor())},getColor:function(){return this._color},setMaterial:function(t,e){const i=this.model.materials;i[e]=t,this.model.materials=i},getMaterial:function(t){return this.model.materials?this.model.materials[t]:null},setMaterialCount:function(t){const e=this.model.materials||[];e.length=t,this.model.materials=e},getMaterialCount:function(){return this.model.materials?this.model.materials.length:0},setMesh:function(t){this.model.mesh=t,this.cacheColors(t),this.applyColor()},cacheColors:function(t){if(t&&t.vertexBuffer.format.hasColor){const t=UnityEngine.Object.FromHandle(UnityEngine.Mesh,this.model._mesh);this.vertexColors=t.colors}},getMesh:function(){return this.model.mesh},findParentCanvas:function(){return pc.UIUtils.findParentScreen(this._entity)},addToParentCanvas:function(){this._parentCanvas&&!this._entity.isPrefab&&this._parentCanvas.canvasMeshInstance.addRenderer(this)},removeFromParentCanvas:function(){this._parentCanvas&&this._parentCanvas.canvasMeshInstance.removeRenderer(this)},reparentCanvas:function(t){if(!this.entity.enabled)return this.removeFromParentCanvas(),void(this._parentCanvas=null);if(t!==this._parentCanvas){this.removeFromParentCanvas();const e=this._parentCanvas?this._parentCanvas["__UnityEngine.Canvas"]:null;this._parentCanvas=t;const i=t?t["__UnityEngine.Canvas"]:null;this.enabled&&this.addToParentCanvas();const n=this.entity.element?this.entity.element["UnityEngine.UI.Graphic"]:null;this.entity.element._nearestScreen=t,n&&(n.m_canvas=i,n.OnCanvasChanged(e,i))}},setGroupAlpha:function(t){this._groupAlpha=t,this.applyColor()},applyColor:function(){const t=this.model.mesh;if(null!=t&&t.vertexBuffer.format.hasColor){this.model.deleteConstant("COLOR");const t=UnityEngine.Object.FromHandle(UnityEngine.Mesh,this.model._mesh),e=t.colors;if(0===e.length)return;let i=!0;for(let t=0;t<this.vertexColors.length;t++)e[t].r=this.vertexColors[t].r*this._color.r,e[t].g=this.vertexColors[t].g*this._color.g,e[t].b=this.vertexColors[t].b*this._color.b,e[t].a=this.vertexColors[t].a*this._color.a*this._groupAlpha,e[t].a>=Number.EPSILON&&(i=!1);t.colors=e,this.cullTransparentMesh&&(this.cull=i)}else{const t=new pc.Color;t.copy(this._color),t.a*=this._groupAlpha,this._colorParameter=t.data,this.model.setConstant("COLOR",this._colorParameter)}},setPopMaterial:function(t,e){this._popMaterials[e]||this._popMaterialCount++,this._popMaterials[e]=t}}),Object.defineProperty(e.prototype,"showMaskGraphics",{get:function(){return this._showMaskGraphics},set:function(t){this._showMaskGraphics=t,this.model.setParameter("_ColorMask",t?15:0)}}),Object.defineProperty(e.prototype,"absoluteDepth",{get:function(){return this._absoluteDepth},set:function(t){this._absoluteDepth=t}}),Object.defineProperty(e.prototype,"hasPopInstruction",{get:function(){return this._hasPopInstruction},set:function(t){this._hasPopInstruction=t}}),Object.defineProperty(e.prototype,"popMaterialCount",{get:function(){return this._popMaterialCount},set:function(t){this._popMaterialCount=t}}),{CanvasRendererComponent:e}}()),Object.assign(pc,function(){const t=function(t){pc.UnityComponentSystem.call(this,t),this.id="canvasRenderer"};return(t.prototype=Object.create(pc.UnityComponentSystem.prototype)).constructor=t,{CanvasRendererSystem:t}}()),Object.assign(pc,function(){const t=function(t){pc.UnityComponentSystem.call(this,t),this.id="particlesystem"};return(t.prototype=Object.create(pc.UnityComponentSystem.prototype)).constructor=t,{ParticleSystemSystem:t}}()),Object.assign(pc,function(){const t=function(t){pc.UnityComponent.prototype.constructor.call(this),this._particleSystem=t.particleSystem,this._renderer=null};return(t.prototype=Object.create(pc.UnityComponent.prototype)).constructor=t,Object.assign(t.prototype,{_fetchRenderer:function(){const t=this._entity._unityComponents.particleSystemRenderer[0];return null==t?null:(this._particleSystem.renderer=t._particleSystemRenderer,t)},_queuesToSubscribe:function(){return["onUpdate"]},onAttached:function(){this._particleSystem._entity=this._entity,this._renderer||(this._renderer=this._fetchRenderer())},onAwake:function(){this._particleSystem._entity=this._entity,this._renderer||(this._renderer=this._fetchRenderer())},onEnable:function(){return!!pc.UnityComponent.prototype.onEnable.call(this)&&(this._particleSystem.main.playOnAwake&&this._particleSystem.play(),this._renderer.enabled=!0,!0)},onDestroy:function(){return this._particleSystem._cache.dispose(),!!pc.UnityComponent.prototype.onDestroy.call(this)&&(this._renderer&&!this._renderer._destroyed&&(this._renderer.enabled&&(this._renderer.enabled=!1),this._renderer.destroy(),this._renderer=null),!0)},onUpdate:function(t){this._renderer||(this._renderer=this._fetchRenderer()),this._particleSystem.update(t,this._entity.getWorldTransform()),this._renderer.enabled&&this._renderer.update(this._particleSystem,t)},onDisable:function(){return!!pc.UnityComponent.prototype.onDisable.call(this)&&(this._renderer&&(this._renderer.enabled=!1),this._particleSystem.stop(!0,UnityEngine.ParticleSystemStopBehavior.StopEmittingAndClear),!0)}}),{ParticleSystemComponent:t}}()),Object.assign(pc,function(){const t=function(t){pc.UnityComponentSystem.call(this,t),this.id="particleSystemRenderer"};return(t.prototype=Object.create(pc.UnityComponentSystem.prototype)).constructor=t,{ParticleSystemRendererSystem:t}}()),Object.assign(pc,function(){const t=function(t){pc.UnityComponent.prototype.constructor.call(this),this._particleSystemRenderer=t.particleSystemRenderer};return(t.prototype=Object.create(pc.UnityComponent.prototype)).constructor=t,Object.assign(t.prototype,{onAttached:function(){pc.UnityComponent.prototype.onAttached.call(this),this._particleSystemRenderer.model&&(this._particleSystemRenderer.model.entity=this.entity)},update:function(t,e){this._particleSystemRenderer.update(t,e),this._particleSystemRenderer.render(t,e)},onEnable:function(){return!!pc.UnityComponent.prototype.onEnable.call(this)&&(pc.Application.getApplication().scene.addRenderer(this),!0)},onDisable:function(){return!!pc.UnityComponent.prototype.onDisable.call(this)&&(pc.Application.getApplication().scene.removeRenderer(this),!0)},getMeshInstancesForRender:function(){return this.model.meshInstances}}),Object.defineProperty(t.prototype,"model",{get:function(){return this._particleSystemRenderer?this._particleSystemRenderer.model:null}}),{ParticleSystemRendererComponent:t}}()),Object.assign(pc,function(){const t=function(t){pc.UnityComponentSystem.call(this,t),this.id="reflectionprobe"};return(t.prototype=Object.create(pc.UnityComponentSystem.prototype)).constructor=t,Object.assign(t.prototype,{scheduleProbeUpdate:function(){this.needsProbeUpdate=!0},onBeforeRender:function(t){this.needsProbeUpdate&&this.refreshReflectionProbes(),this.needsProbeUpdate=!1,pc.UnityComponentSystem.prototype.onBeforeRender.call(this,t)},refreshReflectionProbes:function(){const t=this.app.systems.renderer._components;for(const e in t){if(!t.hasOwnProperty(e))continue;const i=t[e];i.enabled&&(i.code&&i.code.UpdateReflectionProbes())}}}),{ReflectionProbeSystem:t}}()),Object.assign(pc,function(){const t=function(){pc.UnityComponent.call(this)};return(t.prototype=Object.create(pc.UnityComponent.prototype)).constructor=t,Object.assign(t.prototype,{onEnable:function(){return!!pc.UnityComponent.prototype.onEnable.call(this)&&(this.code.OnEnable(),!0)},onDisable:function(){return!!pc.UnityComponent.prototype.onDisable.call(this)&&(this.code.OnDisable(),!0)},onTransformChanged:function(){this.code.OnReflectionProbeChanged()},onBeforeRender:function(t){this.code.OnBeforeRender()},_queuesToSubscribe:function(){return["onBeforeRender"]},refreshReflectionProbes:function(){this.system.scheduleProbeUpdate()}}),{ReflectionProbeComponent:t}}()),function(){const t=new pc.Vec3;pc.extend(pc.BoundingBox,{ctor:pc.BoundingBox,$kind:"struct",equals:function(t,e){return null===t&&null===e||t&&e&&t.equals(e)}}),pc.extend(pc.BoundingBox.prototype,{expand:function(e){this.halfExtents.add(t.copy(e).scale(.5))},closestPoint:function(t){const e=t.clone();return e.sub(this.center),e.x=pc.math.clamp(e.x,-this.halfExtents.x,this.halfExtents.x),e.y=pc.math.clamp(e.y,-this.halfExtents.y,this.halfExtents.y),e.z=pc.math.clamp(e.z,-this.halfExtents.z,this.halfExtents.z),e.add(this.center),e},strictEquals:function(t){return t instanceof pc.BoundingBox&&this.equals(t)},equals:function(t){return this.center.equals(t.center)&&this.halfExtents.equals(t.halfExtents)},intersectRayDistance:function(t,e){const i=new pc.Vec3;return!!this._intersectsRay(t,i)&&(e.v=pc.Vec3.distance(t.origin,i),!0)},getHashCode:function(){return this.center.getHashCode()^this.halfExtents.getHashCode()<<2}}),Object.defineProperty(pc.BoundingBox.prototype,"min",{get:function(){return this.getMin()},set:function(t){this.setMinMax(t,this.getMax())}}),Object.defineProperty(pc.BoundingBox.prototype,"max",{get:function(){return this.getMax()},set:function(t){this.setMinMax(this.getMin(),t)}})}();